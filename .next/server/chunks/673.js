exports.id=673,exports.ids=[673],exports.modules={89:(e,t,n)=>{"use strict";n.d(t,{J:()=>i});let i="production"},1802:(e,t,n)=>{"use strict";n.d(t,{X:()=>i});let i=!1},9537:(e,t,n)=>{"use strict";n.d(t,{RP:()=>function e(t,n,i,s=0){return new g.cW((g,a)=>{let c=t[s];if(null===n||"function"!=typeof c)g(n);else{let I=c({...n},i);l.X&&c.id&&null===I&&o.kg.log(`Event processor "${c.id}" dropped event`),(0,r.J8)(I)?I.then(n=>e(t,n,i,s+1).then(g)).then(null,a):e(t,I,i,s+1).then(g).then(null,a)}})},cc:()=>a,fH:()=>s});var i=n(2936),g=n(6199),o=n(8488),r=n(6797),l=n(1802);function s(){return(0,i.Y)("globalEventProcessors",()=>[])}function a(e){s().push(e)}},155:(e,t,n)=>{"use strict";n.d(t,{$e:()=>b,TM:()=>W,Tb:()=>u,Yr:()=>m,nZ:()=>A,n_:()=>C,s3:()=>B,sV:()=>h,wi:()=>p,yj:()=>y,yl:()=>G});var i=n(8488),g=n(7894),o=n(9463),r=n(6797),l=n(2936),s=n(89),a=n(1802),c=n(922),I=n(9321),d=n(4214);function u(e,t){return(0,c.Gd)().captureException(e,(0,d.U0)(t))}function C(e,t){(0,c.Gd)().addBreadcrumb(e,t)}function b(...e){let t=(0,c.Gd)();if(2===e.length){let[n,i]=e;return n?t.withScope(()=>(t.getStackTop().scope=n,i(n))):t.withScope(i)}return t.withScope(e[0])}function p(e){return(0,c.Ok)(()=>e((0,c.aF)()))}function m(e,t){return(0,c.Gd)().startTransaction({...e},t)}function Z(e,t){let n=A(),o=B();if(o){if(o.captureCheckIn)return o.captureCheckIn(e,t,n);a.X&&i.kg.warn("Cannot capture check-in. Client does not support sending check-ins.")}else a.X&&i.kg.warn("Cannot capture check-in. No client defined.");return(0,g.DM)()}function h(e,t,n){let i;let g=Z({monitorSlug:e,status:"in_progress"},n),l=(0,o.ph)();function s(t){Z({monitorSlug:e,status:t,checkInId:g,duration:(0,o.ph)()-l})}try{i=t()}catch(e){throw s("error"),e}return(0,r.J8)(i)?Promise.resolve(i).then(()=>{s("ok")},()=>{s("error")}):s("ok"),i}async function G(e){let t=B();return t?t.flush(e):(a.X&&i.kg.warn("Cannot flush events. No client defined."),Promise.resolve(!1))}function B(){return(0,c.Gd)().getClient()}function A(){return(0,c.Gd)().getScope()}function y(e){let t=B(),n=(0,c.aF)(),i=A(),{release:g,environment:o=s.J}=t&&t.getOptions()||{},{userAgent:r}=l.GLOBAL_OBJ.navigator||{},a=(0,I.Hv)({release:g,environment:o,user:i.getUser()||n.getUser(),...r&&{userAgent:r},...e}),d=n.getSession();return d&&"ok"===d.status&&(0,I.CT)(d,{status:"exited"}),W(),n.setSession(a),i.setSession(a),a}function W(){let e=(0,c.aF)(),t=A(),n=t.getSession()||e.getSession();n&&(0,I.RJ)(n),function(){let e=(0,c.aF)(),t=A(),n=B(),i=t.getSession()||e.getSession();i&&n&&n.captureSession&&n.captureSession(i)}(),e.setSession(),t.setSession()}},922:(e,t,n)=>{"use strict";n.d(t,{$b:()=>G,Gd:()=>p,Ok:()=>B,aF:()=>m,cu:()=>C,j0:()=>W,uZ:()=>h,vi:()=>y});var i=n(6797),g=n(7894),o=n(9463),r=n(8488),l=n(2936),s=n(89),a=n(1802),c=n(3564),I=n(9321);let d=parseFloat(n(16).J);class u{constructor(e,t,n,i=d){let g,o;this._version=i,t?g=t:(g=new c.sX).setClient(e),n?o=n:(o=new c.sX).setClient(e),this._stack=[{scope:g}],e&&this.bindClient(e),this._isolationScope=o}isOlderThan(e){return this._version<e}bindClient(e){let t=this.getStackTop();t.client=e,t.scope.setClient(e),e&&e.setupIntegrations&&e.setupIntegrations()}pushScope(){let e=this.getScope().clone();return this.getStack().push({client:this.getClient(),scope:e}),e}popScope(){return!(this.getStack().length<=1)&&!!this.getStack().pop()}withScope(e){let t;let n=this.pushScope();try{t=e(n)}catch(e){throw this.popScope(),e}return(0,i.J8)(t)?t.then(e=>(this.popScope(),e),e=>{throw this.popScope(),e}):(this.popScope(),t)}getClient(){return this.getStackTop().client}getScope(){return this.getStackTop().scope}getIsolationScope(){return this._isolationScope}getStack(){return this._stack}getStackTop(){return this._stack[this._stack.length-1]}captureException(e,t){let n=this._lastEventId=t&&t.event_id?t.event_id:(0,g.DM)(),i=Error("Sentry syntheticException");return this.getScope().captureException(e,{originalException:e,syntheticException:i,...t,event_id:n}),n}captureMessage(e,t,n){let i=this._lastEventId=n&&n.event_id?n.event_id:(0,g.DM)(),o=Error(e);return this.getScope().captureMessage(e,t,{originalException:e,syntheticException:o,...n,event_id:i}),i}captureEvent(e,t){let n=t&&t.event_id?t.event_id:(0,g.DM)();return e.type||(this._lastEventId=n),this.getScope().captureEvent(e,{...t,event_id:n}),n}lastEventId(){return this._lastEventId}addBreadcrumb(e,t){let{scope:n,client:i}=this.getStackTop();if(!i)return;let{beforeBreadcrumb:g=null,maxBreadcrumbs:l=100}=i.getOptions&&i.getOptions()||{};if(l<=0)return;let s={timestamp:(0,o.yW)(),...e},a=g?(0,r.Cf)(()=>g(s,t)):s;null!==a&&(i.emit&&i.emit("beforeAddBreadcrumb",a,t),n.addBreadcrumb(a,l))}setUser(e){this.getScope().setUser(e),this.getIsolationScope().setUser(e)}setTags(e){this.getScope().setTags(e),this.getIsolationScope().setTags(e)}setExtras(e){this.getScope().setExtras(e),this.getIsolationScope().setExtras(e)}setTag(e,t){this.getScope().setTag(e,t),this.getIsolationScope().setTag(e,t)}setExtra(e,t){this.getScope().setExtra(e,t),this.getIsolationScope().setExtra(e,t)}setContext(e,t){this.getScope().setContext(e,t),this.getIsolationScope().setContext(e,t)}configureScope(e){let{scope:t,client:n}=this.getStackTop();n&&e(t)}run(e){let t=b(this);try{e(this)}finally{b(t)}}getIntegration(e){let t=this.getClient();if(!t)return null;try{return t.getIntegration(e)}catch(t){return a.X&&r.kg.warn(`Cannot retrieve integration ${e.id} from the current Hub`),null}}startTransaction(e,t){let n=this._callExtensionMethod("startTransaction",e,t);return a.X&&!n&&(this.getClient()?r.kg.warn(`Tracing extension 'startTransaction' has not been added. Call 'addTracingExtensions' before calling 'init':
Sentry.addTracingExtensions();
Sentry.init({...});
`):r.kg.warn("Tracing extension 'startTransaction' is missing. You should 'init' the SDK before calling 'startTransaction'")),n}traceHeaders(){return this._callExtensionMethod("traceHeaders")}captureSession(e=!1){if(e)return this.endSession();this._sendSessionUpdate()}endSession(){let e=this.getStackTop().scope,t=e.getSession();t&&(0,I.RJ)(t),this._sendSessionUpdate(),e.setSession()}startSession(e){let{scope:t,client:n}=this.getStackTop(),{release:i,environment:g=s.J}=n&&n.getOptions()||{},{userAgent:o}=l.GLOBAL_OBJ.navigator||{},r=(0,I.Hv)({release:i,environment:g,user:t.getUser(),...o&&{userAgent:o},...e}),a=t.getSession&&t.getSession();return a&&"ok"===a.status&&(0,I.CT)(a,{status:"exited"}),this.endSession(),t.setSession(r),r}shouldSendDefaultPii(){let e=this.getClient(),t=e&&e.getOptions();return!!(t&&t.sendDefaultPii)}_sendSessionUpdate(){let{scope:e,client:t}=this.getStackTop(),n=e.getSession();n&&t&&t.captureSession&&t.captureSession(n)}_callExtensionMethod(e,...t){let n=C().__SENTRY__;if(n&&n.extensions&&"function"==typeof n.extensions[e])return n.extensions[e].apply(this,t);a.X&&r.kg.warn(`Extension method ${e} couldn't be found, doing nothing.`)}}function C(){return l.GLOBAL_OBJ.__SENTRY__=l.GLOBAL_OBJ.__SENTRY__||{extensions:{},hub:void 0},l.GLOBAL_OBJ}function b(e){let t=C(),n=y(t);return W(t,e),n}function p(){let e=C();if(e.__SENTRY__&&e.__SENTRY__.acs){let t=e.__SENTRY__.acs.getCurrentHub();if(t)return t}return Z(e)}function m(){return p().getIsolationScope()}function Z(e=C()){return(!A(e)||y(e).isOlderThan(d))&&W(e,new u),y(e)}function h(e,t=Z()){if(!A(e)||y(e).isOlderThan(d)){let n=t.getClient(),i=t.getScope(),g=t.getIsolationScope();W(e,new u(n,i.clone(),g.clone()))}}function G(e){let t=C();t.__SENTRY__=t.__SENTRY__||{},t.__SENTRY__.acs=e}function B(e,t={}){let n=C();return n.__SENTRY__&&n.__SENTRY__.acs?n.__SENTRY__.acs.runWithAsyncContext(e,t):e()}function A(e){return!!(e&&e.__SENTRY__&&e.__SENTRY__.hub)}function y(e){return(0,l.Y)("hub",()=>new u,e)}function W(e,t){return!!e&&((e.__SENTRY__=e.__SENTRY__||{}).hub=t,!0)}},6295:(e,t,n)=>{"use strict";n.d(t,{RN:()=>u,_I:()=>C,m7:()=>d,m8:()=>a,q4:()=>c,uf:()=>I});var i=n(7894),g=n(8488),o=n(1802),r=n(9537),l=n(922);let s=[];function a(e){let t=e.defaultIntegrations||[],n=e.integrations;t.forEach(e=>{e.isDefaultInstance=!0});let g=function(e){let t={};return e.forEach(e=>{let{name:n}=e,i=t[n];i&&!i.isDefaultInstance&&e.isDefaultInstance||(t[n]=e)}),Object.keys(t).map(e=>t[e])}(Array.isArray(n)?[...t,...n]:"function"==typeof n?(0,i.lE)(n(t)):t),o=function(e,t){for(let n=0;n<e.length;n++)if(!0===t(e[n]))return n;return -1}(g,e=>"Debug"===e.name);if(-1!==o){let[e]=g.splice(o,1);g.push(e)}return g}function c(e,t){let n={};return t.forEach(t=>{t&&d(e,t,n)}),n}function I(e,t){for(let n of t)n&&n.afterAllSetup&&n.afterAllSetup(e)}function d(e,t,n){if(n[t.name]){o.X&&g.kg.log(`Integration skipped because it was already installed: ${t.name}`);return}if(n[t.name]=t,-1===s.indexOf(t.name)&&(t.setupOnce(r.cc,l.Gd),s.push(t.name)),t.setup&&"function"==typeof t.setup&&t.setup(e),e.on&&"function"==typeof t.preprocessEvent){let n=t.preprocessEvent.bind(t);e.on("preprocessEvent",(t,i)=>n(t,i,e))}if(e.addEventProcessor&&"function"==typeof t.processEvent){let n=t.processEvent.bind(t),i=Object.assign((t,i)=>n(t,i,e),{id:t.name});e.addEventProcessor(i)}o.X&&g.kg.log(`Integration installed: ${t.name}`)}function u(e,t){return Object.assign(function(...e){return t(...e)},{id:e})}function C(e){return e}},5045:(e,t,n)=>{"use strict";let i;n.d(t,{v:()=>s,y:()=>l});var g=n(4254),o=n(634);function r(e){return i?i.get(e):void 0}function l(e){let t=r(e);if(!t)return;let n={};for(let[,[e,i]]of t)n[e]||(n[e]=[]),n[e].push((0,g.Jr)(i));return n}function s(e,t,n,g,l,s){let a=(0,o.HN)();if(a){let o=r(a)||new Map,c=`${e}:${t}@${g}`,I=o.get(s);if(I){let[,e]=I;o.set(s,[c,{min:Math.min(e.min,n),max:Math.max(e.max,n),count:e.count+=1,sum:e.sum+=n,tags:e.tags}])}else o.set(s,[c,{min:n,max:n,count:1,sum:n,tags:l}]);i||(i=new WeakMap),i.set(a,o)}}},3564:(e,t,n)=>{"use strict";let i;n.d(t,{lW:()=>d,sX:()=>I});var g=n(6797),o=n(9463),r=n(7894),l=n(8488),s=n(9537),a=n(9321),c=n(7942);class I{constructor(){this._notifyingListeners=!1,this._scopeListeners=[],this._eventProcessors=[],this._breadcrumbs=[],this._attachments=[],this._user={},this._tags={},this._extra={},this._contexts={},this._sdkProcessingMetadata={},this._propagationContext=u()}static clone(e){return e?e.clone():new I}clone(){let e=new I;return e._breadcrumbs=[...this._breadcrumbs],e._tags={...this._tags},e._extra={...this._extra},e._contexts={...this._contexts},e._user=this._user,e._level=this._level,e._span=this._span,e._session=this._session,e._transactionName=this._transactionName,e._fingerprint=this._fingerprint,e._eventProcessors=[...this._eventProcessors],e._requestSession=this._requestSession,e._attachments=[...this._attachments],e._sdkProcessingMetadata={...this._sdkProcessingMetadata},e._propagationContext={...this._propagationContext},e._client=this._client,e}setClient(e){this._client=e}getClient(){return this._client}addScopeListener(e){this._scopeListeners.push(e)}addEventProcessor(e){return this._eventProcessors.push(e),this}setUser(e){return this._user=e||{email:void 0,id:void 0,ip_address:void 0,segment:void 0,username:void 0},this._session&&(0,a.CT)(this._session,{user:e}),this._notifyScopeListeners(),this}getUser(){return this._user}getRequestSession(){return this._requestSession}setRequestSession(e){return this._requestSession=e,this}setTags(e){return this._tags={...this._tags,...e},this._notifyScopeListeners(),this}setTag(e,t){return this._tags={...this._tags,[e]:t},this._notifyScopeListeners(),this}setExtras(e){return this._extra={...this._extra,...e},this._notifyScopeListeners(),this}setExtra(e,t){return this._extra={...this._extra,[e]:t},this._notifyScopeListeners(),this}setFingerprint(e){return this._fingerprint=e,this._notifyScopeListeners(),this}setLevel(e){return this._level=e,this._notifyScopeListeners(),this}setTransactionName(e){return this._transactionName=e,this._notifyScopeListeners(),this}setContext(e,t){return null===t?delete this._contexts[e]:this._contexts[e]=t,this._notifyScopeListeners(),this}setSpan(e){return this._span=e,this._notifyScopeListeners(),this}getSpan(){return this._span}getTransaction(){let e=this._span;return e&&e.transaction}setSession(e){return e?this._session=e:delete this._session,this._notifyScopeListeners(),this}getSession(){return this._session}update(e){if(!e)return this;let t="function"==typeof e?e(this):e;if(t instanceof I){let e=t.getScopeData();this._tags={...this._tags,...e.tags},this._extra={...this._extra,...e.extra},this._contexts={...this._contexts,...e.contexts},e.user&&Object.keys(e.user).length&&(this._user=e.user),e.level&&(this._level=e.level),e.fingerprint.length&&(this._fingerprint=e.fingerprint),t.getRequestSession()&&(this._requestSession=t.getRequestSession()),e.propagationContext&&(this._propagationContext=e.propagationContext)}else(0,g.PO)(t)&&(this._tags={...this._tags,...e.tags},this._extra={...this._extra,...e.extra},this._contexts={...this._contexts,...e.contexts},e.user&&(this._user=e.user),e.level&&(this._level=e.level),e.fingerprint&&(this._fingerprint=e.fingerprint),e.requestSession&&(this._requestSession=e.requestSession),e.propagationContext&&(this._propagationContext=e.propagationContext));return this}clear(){return this._breadcrumbs=[],this._tags={},this._extra={},this._user={},this._contexts={},this._level=void 0,this._transactionName=void 0,this._fingerprint=void 0,this._requestSession=void 0,this._span=void 0,this._session=void 0,this._notifyScopeListeners(),this._attachments=[],this._propagationContext=u(),this}addBreadcrumb(e,t){let n="number"==typeof t?t:100;if(n<=0)return this;let i={timestamp:(0,o.yW)(),...e},g=this._breadcrumbs;return g.push(i),this._breadcrumbs=g.length>n?g.slice(-n):g,this._notifyScopeListeners(),this}getLastBreadcrumb(){return this._breadcrumbs[this._breadcrumbs.length-1]}clearBreadcrumbs(){return this._breadcrumbs=[],this._notifyScopeListeners(),this}addAttachment(e){return this._attachments.push(e),this}getAttachments(){return this.getScopeData().attachments}clearAttachments(){return this._attachments=[],this}getScopeData(){let{_breadcrumbs:e,_attachments:t,_contexts:n,_tags:i,_extra:g,_user:o,_level:r,_fingerprint:l,_eventProcessors:s,_propagationContext:a,_sdkProcessingMetadata:c,_transactionName:I,_span:d}=this;return{breadcrumbs:e,attachments:t,contexts:n,tags:i,extra:g,user:o,level:r,fingerprint:l||[],eventProcessors:s,propagationContext:a,sdkProcessingMetadata:c,transactionName:I,span:d}}applyToEvent(e,t={},n=[]){(0,c.gi)(e,this.getScopeData());let i=[...n,...(0,s.fH)(),...this._eventProcessors];return(0,s.RP)(i,e,t)}setSDKProcessingMetadata(e){return this._sdkProcessingMetadata={...this._sdkProcessingMetadata,...e},this}setPropagationContext(e){return this._propagationContext=e,this}getPropagationContext(){return this._propagationContext}captureException(e,t){let n=t&&t.event_id?t.event_id:(0,r.DM)();if(!this._client)return l.kg.warn("No client configured on scope - will not capture exception!"),n;let i=Error("Sentry syntheticException");return this._client.captureException(e,{originalException:e,syntheticException:i,...t,event_id:n},this),n}captureMessage(e,t,n){let i=n&&n.event_id?n.event_id:(0,r.DM)();if(!this._client)return l.kg.warn("No client configured on scope - will not capture message!"),i;let g=Error(e);return this._client.captureMessage(e,t,{originalException:e,syntheticException:g,...n,event_id:i},this),i}captureEvent(e,t){let n=t&&t.event_id?t.event_id:(0,r.DM)();return this._client?this._client.captureEvent(e,{...t,event_id:n},this):l.kg.warn("No client configured on scope - will not capture event!"),n}_notifyScopeListeners(){this._notifyingListeners||(this._notifyingListeners=!0,this._scopeListeners.forEach(e=>{e(this)}),this._notifyingListeners=!1)}}function d(){return i||(i=new I),i}function u(){return{traceId:(0,r.DM)(),spanId:(0,r.DM)().substring(16)}}},5200:(e,t,n)=>{"use strict";n.d(t,{$J:()=>o,S3:()=>r,TE:()=>g,Zj:()=>i,p6:()=>l});let i="sentry.source",g="sentry.sample_rate",o="sentry.op",r="sentry.origin",l="profile_id"},9321:(e,t,n)=>{"use strict";n.d(t,{CT:()=>l,Hv:()=>r,RJ:()=>s});var i=n(9463),g=n(7894),o=n(4254);function r(e){let t=(0,i.ph)(),n={sid:(0,g.DM)(),init:!0,timestamp:t,started:t,duration:0,status:"ok",errors:0,ignoreDuration:!1,toJSON:()=>(0,o.Jr)({sid:`${n.sid}`,init:n.init,started:new Date(1e3*n.started).toISOString(),timestamp:new Date(1e3*n.timestamp).toISOString(),status:n.status,errors:n.errors,did:"number"==typeof n.did||"string"==typeof n.did?`${n.did}`:void 0,duration:n.duration,abnormal_mechanism:n.abnormal_mechanism,attrs:{release:n.release,environment:n.environment,ip_address:n.ipAddress,user_agent:n.userAgent}})};return e&&l(n,e),n}function l(e,t={}){if(!t.user||(!e.ipAddress&&t.user.ip_address&&(e.ipAddress=t.user.ip_address),e.did||t.did||(e.did=t.user.id||t.user.email||t.user.username)),e.timestamp=t.timestamp||(0,i.ph)(),t.abnormal_mechanism&&(e.abnormal_mechanism=t.abnormal_mechanism),t.ignoreDuration&&(e.ignoreDuration=t.ignoreDuration),t.sid&&(e.sid=32===t.sid.length?t.sid:(0,g.DM)()),void 0!==t.init&&(e.init=t.init),!e.did&&t.did&&(e.did=`${t.did}`),"number"==typeof t.started&&(e.started=t.started),e.ignoreDuration)e.duration=void 0;else if("number"==typeof t.duration)e.duration=t.duration;else{let t=e.timestamp-e.started;e.duration=t>=0?t:0}t.release&&(e.release=t.release),t.environment&&(e.environment=t.environment),!e.ipAddress&&t.ipAddress&&(e.ipAddress=t.ipAddress),!e.userAgent&&t.userAgent&&(e.userAgent=t.userAgent),"number"==typeof t.errors&&(e.errors=t.errors),t.status&&(e.status=t.status)}function s(e,t){let n={};t?n={status:t}:"ok"===e.status&&(n={status:"exited"}),l(e,n)}},7536:(e,t,n)=>{"use strict";n.d(t,{_:()=>s,j:()=>a});var i=n(4254),g=n(89),o=n(155),r=n(9972),l=n(8579);function s(e,t,n){let o=t.getOptions(),{publicKey:r}=t.getDsn()||{},{segment:l}=n&&n.getUser()||{},s=(0,i.Jr)({environment:o.environment||g.J,release:o.release,user_segment:l,public_key:r,trace_id:e});return t.emit&&t.emit("createDsc",s),s}function a(e){let t=(0,o.s3)();if(!t)return{};let n=s((0,l.XU)(e).trace_id||"",t,(0,o.nZ)()),i=(0,r.G)(e);if(!i)return n;let g=i&&i._frozenDynamicSamplingContext;if(g)return g;let{sampleRate:a,source:c}=i.metadata;null!=a&&(n.sample_rate=`${a}`);let I=(0,l.XU)(i);return c&&"url"!==c&&(n.transaction=I.description),n.sampled=String((0,l.Tt)(i)),t.emit&&t.emit("createDsc",n),n}},8176:(e,t,n)=>{"use strict";n.d(t,{T:()=>f});var i=n(8488),g=n(1802),o=n(922),r=n(8579),l=n(2936),s=n(2649);let a=null;function c(){a=l.GLOBAL_OBJ.onerror,l.GLOBAL_OBJ.onerror=function(e,t,n,i,g){return(0,s.rK)("error",{column:i,error:g,line:n,msg:e,url:t}),!!a&&!a.__SENTRY_LOADER__&&a.apply(this,arguments)},l.GLOBAL_OBJ.onerror.__SENTRY_INSTRUMENTED__=!0}let I=null;function d(){I=l.GLOBAL_OBJ.onunhandledrejection,l.GLOBAL_OBJ.onunhandledrejection=function(e){return(0,s.rK)("unhandledrejection",e),!I||!!I.__SENTRY_LOADER__||I.apply(this,arguments)},l.GLOBAL_OBJ.onunhandledrejection.__SENTRY_INSTRUMENTED__=!0}var u=n(7353);let C=!1;function b(){let e=(0,u.x1)();if(e){let t="internal_error";g.X&&i.kg.log(`[Tracing] Transaction: ${t} -> Global error occured`),e.setStatus(t)}}b.tag="sentry_tracingErrorCallback";var p=n(6797),m=n(5200),Z=n(1301),h=n(4254),G=n(5045),B=n(7536),A=n(7894),y=n(9463),W=n(9972),V=n(1540);class v{constructor(e=1e3){this._maxlen=e,this.spans=[]}add(e){this.spans.length>this._maxlen?e.spanRecorder=void 0:this.spans.push(e)}}class R{constructor(e={}){this._traceId=e.traceId||(0,A.DM)(),this._spanId=e.spanId||(0,A.DM)().substring(16),this._startTime=e.startTimestamp||(0,y.ph)(),this.tags=e.tags?{...e.tags}:{},this.data=e.data?{...e.data}:{},this.instrumenter=e.instrumenter||"sentry",this._attributes={},this.setAttributes({[m.S3]:e.origin||"manual",[m.$J]:e.op,...e.attributes}),this._name=e.name||e.description,e.parentSpanId&&(this._parentSpanId=e.parentSpanId),"sampled"in e&&(this._sampled=e.sampled),e.status&&(this._status=e.status),e.endTimestamp&&(this._endTime=e.endTimestamp),e.exclusiveTime&&(this._exclusiveTime=e.exclusiveTime),this._measurements=e.measurements?{...e.measurements}:{}}get name(){return this._name||""}set name(e){this.updateName(e)}get description(){return this._name}set description(e){this._name=e}get traceId(){return this._traceId}set traceId(e){this._traceId=e}get spanId(){return this._spanId}set spanId(e){this._spanId=e}set parentSpanId(e){this._parentSpanId=e}get parentSpanId(){return this._parentSpanId}get sampled(){return this._sampled}set sampled(e){this._sampled=e}get attributes(){return this._attributes}set attributes(e){this._attributes=e}get startTimestamp(){return this._startTime}set startTimestamp(e){this._startTime=e}get endTimestamp(){return this._endTime}set endTimestamp(e){this._endTime=e}get status(){return this._status}set status(e){this._status=e}get op(){return this._attributes[m.$J]}set op(e){this.setAttribute(m.$J,e)}get origin(){return this._attributes[m.S3]}set origin(e){this.setAttribute(m.S3,e)}spanContext(){let{_spanId:e,_traceId:t,_sampled:n}=this;return{spanId:e,traceId:t,traceFlags:n?r.i0:r.ve}}startChild(e){let t=new R({...e,parentSpanId:this._spanId,sampled:this._sampled,traceId:this._traceId});t.spanRecorder=this.spanRecorder,t.spanRecorder&&t.spanRecorder.add(t);let n=(0,W.G)(this);if(t.transaction=n,g.X&&n){let g=e&&e.op||"< unknown op >",o=(0,r.XU)(t).description||"< unknown name >",l=n.spanContext().spanId,s=`[Tracing] Starting '${g}' span on transaction '${o}' (${l}).`;i.kg.log(s),this._logMessage=s}return t}setTag(e,t){return this.tags={...this.tags,[e]:t},this}setData(e,t){return this.data={...this.data,[e]:t},this}setAttribute(e,t){void 0===t?delete this._attributes[e]:this._attributes[e]=t}setAttributes(e){Object.keys(e).forEach(t=>this.setAttribute(t,e[t]))}setStatus(e){return this._status=e,this}setHttpStatus(e){return(0,V.Q0)(this,e),this}setName(e){this.updateName(e)}updateName(e){return this._name=e,this}isSuccess(){return"ok"===this._status}finish(e){return this.end(e)}end(e){if(this._endTime)return;let t=(0,W.G)(this);if(g.X&&t&&t.spanContext().spanId!==this._spanId){let e=this._logMessage;e&&i.kg.log(e.replace("Starting","Finishing"))}this._endTime=(0,r.$k)(e)}toTraceparent(){return(0,r.Hb)(this)}toContext(){return(0,h.Jr)({data:this._getData(),description:this._name,endTimestamp:this._endTime,op:this.op,parentSpanId:this._parentSpanId,sampled:this._sampled,spanId:this._spanId,startTimestamp:this._startTime,status:this._status,tags:this.tags,traceId:this._traceId})}updateWithContext(e){return this.data=e.data||{},this._name=e.name||e.description,this._endTime=e.endTimestamp,this.op=e.op,this._parentSpanId=e.parentSpanId,this._sampled=e.sampled,this._spanId=e.spanId||this._spanId,this._startTime=e.startTimestamp||this._startTime,this._status=e.status,this.tags=e.tags||{},this._traceId=e.traceId||this._traceId,this}getTraceContext(){return(0,r.wy)(this)}getSpanJSON(){return(0,h.Jr)({data:this._getData(),description:this._name,op:this._attributes[m.$J],parent_span_id:this._parentSpanId,span_id:this._spanId,start_timestamp:this._startTime,status:this._status,tags:Object.keys(this.tags).length>0?this.tags:void 0,timestamp:this._endTime,trace_id:this._traceId,origin:this._attributes[m.S3],_metrics_summary:(0,G.y)(this),profile_id:this._attributes[m.p6],exclusive_time:this._exclusiveTime,measurements:Object.keys(this._measurements).length>0?this._measurements:void 0})}isRecording(){return!this._endTime&&!!this._sampled}toJSON(){return this.getSpanJSON()}_getData(){let{data:e,_attributes:t}=this,n=Object.keys(e).length>0,i=Object.keys(t).length>0;return n||i?n&&i?{...e,...t}:n?e:t:void 0}}var S=n(634);class H extends R{constructor(e,t){super(e),this._contexts={},this._hub=t||(0,o.Gd)(),this._name=e.name||"",this._metadata={...e.metadata},this._trimEnd=e.trimEnd,this.transaction=this;let n=this._metadata.dynamicSamplingContext;n&&(this._frozenDynamicSamplingContext={...n})}get name(){return this._name}set name(e){this.setName(e)}get metadata(){return{source:"custom",spanMetadata:{},...this._metadata,...this._attributes[m.Zj]&&{source:this._attributes[m.Zj]},...this._attributes[m.TE]&&{sampleRate:this._attributes[m.TE]}}}set metadata(e){this._metadata=e}setName(e,t="custom"){this._name=e,this.setAttribute(m.Zj,t)}updateName(e){return this._name=e,this}initSpanRecorder(e=1e3){this.spanRecorder||(this.spanRecorder=new v(e)),this.spanRecorder.add(this)}setContext(e,t){null===t?delete this._contexts[e]:this._contexts[e]=t}setMeasurement(e,t,n=""){this._measurements[e]={value:t,unit:n}}setMetadata(e){this._metadata={...this._metadata,...e}}end(e){let t=(0,r.$k)(e),n=this._finishTransaction(t);if(n)return this._hub.captureEvent(n)}toContext(){let e=super.toContext();return(0,h.Jr)({...e,name:this._name,trimEnd:this._trimEnd})}updateWithContext(e){return super.updateWithContext(e),this._name=e.name||"",this._trimEnd=e.trimEnd,this}getDynamicSamplingContext(){return(0,B.j)(this)}setHub(e){this._hub=e}getProfileId(){if(void 0!==this._contexts&&void 0!==this._contexts.profile)return this._contexts.profile.profile_id}_finishTransaction(e){if(void 0!==this._endTime)return;this._name||(g.X&&i.kg.warn("Transaction has no name, falling back to `<unlabeled transaction>`."),this._name="<unlabeled transaction>"),super.end(e);let t=this._hub.getClient();if(t&&t.emit&&t.emit("finishTransaction",this),!0!==this._sampled){g.X&&i.kg.log("[Tracing] Discarding transaction because its trace was not chosen to be sampled."),t&&t.recordDroppedEvent("sample_rate","transaction");return}let n=this.spanRecorder?this.spanRecorder.spans.filter(e=>e!==this&&(0,r.XU)(e).timestamp):[];if(this._trimEnd&&n.length>0){let e=n.map(e=>(0,r.XU)(e).timestamp).filter(Boolean);this._endTime=e.reduce((e,t)=>e>t?e:t)}let{scope:o,isolationScope:l}=(0,S.I1)(this),{metadata:s}=this,{source:a}=s,c={contexts:{...this._contexts,trace:(0,r.wy)(this)},spans:n,start_timestamp:this._startTime,tags:this.tags,timestamp:this._endTime,transaction:this._name,type:"transaction",sdkProcessingMetadata:{...s,capturedSpanScope:o,capturedSpanIsolationScope:l,...(0,h.Jr)({dynamicSamplingContext:(0,B.j)(this)})},_metrics_summary:(0,G.y)(this),...a&&{transaction_info:{source:a}}};return Object.keys(this._measurements).length>0&&(g.X&&i.kg.log("[Measurements] Adding measurements to transaction",JSON.stringify(this._measurements,void 0,2)),c.measurements=this._measurements),g.X&&i.kg.log(`[Tracing] Finishing ${this.op} transaction: ${this._name}.`),c}}function X(){let e=this.getScope().getSpan();return e?{"sentry-trace":(0,r.Hb)(e)}:{}}function Y(e,t){var n,o,l;let s;let a=this.getClient(),c=a&&a.getOptions()||{},I=c.instrumenter||"sentry",d=e.instrumenter||"sentry";I!==d&&(g.X&&i.kg.error(`A transaction was started with instrumenter=\`${d}\`, but the SDK is configured with the \`${I}\` instrumenter.
The transaction will not be sampled. Please use the ${I} instrumentation to start transactions.`),e.sampled=!1);let u=new H(e,this);return n=u,o={name:e.name,parentSampled:e.parentSampled,transactionContext:e,attributes:{...e.data,...e.attributes},...t},((0,Z.z)(c)?void 0!==n.sampled?n.setAttribute(m.TE,Number(n.sampled)):("function"==typeof c.tracesSampler?(s=c.tracesSampler(o),n.setAttribute(m.TE,Number(s))):void 0!==o.parentSampled?s=o.parentSampled:void 0!==c.tracesSampleRate?(s=c.tracesSampleRate,n.setAttribute(m.TE,Number(s))):(s=1,n.setAttribute(m.TE,s)),l=s,(0,p.i2)(l)||!("number"==typeof l||"boolean"==typeof l)?(g.X&&i.kg.warn(`[Tracing] Given sample rate is invalid. Sample rate must be a boolean or a number between 0 and 1. Got ${JSON.stringify(l)} of type ${JSON.stringify(typeof l)}.`),1):(l<0||l>1)&&(g.X&&i.kg.warn(`[Tracing] Given sample rate is invalid. Sample rate must be between 0 and 1. Got ${l}.`),1))?(g.X&&i.kg.warn("[Tracing] Discarding transaction because of invalid sample rate."),n.sampled=!1):s?(n.sampled=Math.random()<s,n.sampled)?g.X&&i.kg.log(`[Tracing] starting ${n.op} transaction - ${(0,r.XU)(n).description}`):g.X&&i.kg.log(`[Tracing] Discarding transaction because it's not included in the random sample (sampling rate = ${Number(s)})`):(g.X&&i.kg.log(`[Tracing] Discarding transaction because ${"function"==typeof c.tracesSampler?"tracesSampler returned 0 or false":"a negative sampling decision was inherited or tracesSampleRate is set to 0"}`),n.sampled=!1):n.sampled=!1,u=n).isRecording()&&u.initSpanRecorder(c._experiments&&c._experiments.maxSpans),a&&a.emit&&a.emit("startTransaction",u),u}function f(){let e=(0,o.cu)();e.__SENTRY__&&(e.__SENTRY__.extensions=e.__SENTRY__.extensions||{},e.__SENTRY__.extensions.startTransaction||(e.__SENTRY__.extensions.startTransaction=Y),e.__SENTRY__.extensions.traceHeaders||(e.__SENTRY__.extensions.traceHeaders=X),C||(C=!0,function(e){let t="error";(0,s.Hj)(t,e),(0,s.D2)(t,c)}(b),function(e){let t="unhandledrejection";(0,s.Hj)(t,e),(0,s.D2)(t,d)}(b)))}},1540:(e,t,n)=>{"use strict";var i;function g(e,t){e.setTag("http.status_code",String(t)),e.setData("http.response.status_code",t);let n=function(e){if(e<400&&e>=100)return"ok";if(e>=400&&e<500)switch(e){case 401:return"unauthenticated";case 403:return"permission_denied";case 404:return"not_found";case 409:return"already_exists";case 413:return"failed_precondition";case 429:return"resource_exhausted";default:return"invalid_argument"}if(e>=500&&e<600)switch(e){case 501:return"unimplemented";case 503:return"unavailable";case 504:return"deadline_exceeded";default:return"internal_error"}return"unknown_error"}(t);"unknown_error"!==n&&e.setStatus(n)}n.d(t,{Q0:()=>g}),function(e){e.Ok="ok",e.DeadlineExceeded="deadline_exceeded",e.Unauthenticated="unauthenticated",e.PermissionDenied="permission_denied",e.NotFound="not_found",e.ResourceExhausted="resource_exhausted",e.InvalidArgument="invalid_argument",e.Unimplemented="unimplemented",e.Unavailable="unavailable",e.InternalError="internal_error",e.UnknownError="unknown_error",e.Cancelled="cancelled",e.AlreadyExists="already_exists",e.FailedPrecondition="failed_precondition",e.Aborted="aborted",e.OutOfRange="out_of_range",e.DataLoss="data_loss"}(i||(i={}))},634:(e,t,n)=>{"use strict";n.d(t,{GK:()=>u,HN:()=>b,I1:()=>B,V0:()=>C,yn:()=>p});var i=n(7210),g=n(8488),o=n(4254),r=n(1802),l=n(922),s=n(8579),a=n(7536),c=n(155),I=n(4301),d=n(1301);function u(e,t){let n=Z(e);return(0,l.Ok)(()=>(0,c.$e)(e.scope,i=>{let g=(0,l.Gd)(),o=i.getSpan(),r=e.onlyIfParent&&!o?void 0:m(g,{parentSpan:o,spanContext:n,forceTransaction:e.forceTransaction,scope:i});return(0,I.i)(()=>t(r),()=>{if(r){let{status:e}=(0,s.XU)(r);e&&"ok"!==e||r.setStatus("internal_error")}},()=>r&&r.end())}))}function C(e,t){let n=Z(e);return(0,l.Ok)(()=>(0,c.$e)(e.scope,i=>{let g=(0,l.Gd)(),o=i.getSpan(),r=e.onlyIfParent&&!o?void 0:m(g,{parentSpan:o,spanContext:n,forceTransaction:e.forceTransaction,scope:i});function a(){r&&r.end()}return(0,I.i)(()=>t(r,a),()=>{if(r&&r.isRecording()){let{status:e}=(0,s.XU)(r);e&&"ok"!==e||r.setStatus("internal_error")}})}))}function b(){return(0,c.nZ)().getSpan()}let p=({sentryTrace:e,baggage:t},n)=>{let s=(0,c.nZ)(),{traceparentData:a,dynamicSamplingContext:I,propagationContext:d}=(0,i.KA)(e,t);s.setPropagationContext(d),r.X&&a&&g.kg.log(`[Tracing] Continuing trace ${a.traceId}.`);let u={...a,metadata:(0,o.Jr)({dynamicSamplingContext:I})};return n?(0,l.Ok)(()=>n(u)):u};function m(e,{parentSpan:t,spanContext:n,forceTransaction:i,scope:g}){var r;let c;if(!(0,d.z)())return;let I=(0,l.aF)();if(t&&!i)c=t.startChild(n);else if(t){let i=(0,a.j)(t),{traceId:g,spanId:o}=t.spanContext(),r=(0,s.Tt)(t);c=e.startTransaction({traceId:g,parentSpanId:o,parentSampled:r,...n,metadata:{dynamicSamplingContext:i,...n.metadata}})}else{let{traceId:t,dsc:i,parentSpanId:o,sampled:r}={...I.getPropagationContext(),...g.getPropagationContext()};c=e.startTransaction({traceId:t,parentSpanId:o,parentSampled:r,...n,metadata:{dynamicSamplingContext:i,...n.metadata}})}return g.setSpan(c),(r=c)&&((0,o.xp)(r,G,I),(0,o.xp)(r,h,g)),c}function Z(e){if(e.startTime){let t={...e};return t.startTimestamp=(0,s.$k)(e.startTime),delete t.startTime,t}return e}let h="_sentryScope",G="_sentryIsolationScope";function B(e){return{scope:e[h],isolationScope:e[G]}}},7353:(e,t,n)=>{"use strict";n.d(t,{x1:()=>g});var i=n(922);function g(e){return(e||(0,i.Gd)()).getScope().getTransaction()}},7942:(e,t,n)=>{"use strict";n.d(t,{gi:()=>s,yo:()=>a});var i=n(4254),g=n(7894),o=n(7536),r=n(9972),l=n(8579);function s(e,t){let{fingerprint:n,span:s,breadcrumbs:a,sdkProcessingMetadata:c}=t;(function(e,t){let{extra:n,tags:g,user:o,contexts:r,level:l,transactionName:s}=t,a=(0,i.Jr)(n);a&&Object.keys(a).length&&(e.extra={...a,...e.extra});let c=(0,i.Jr)(g);c&&Object.keys(c).length&&(e.tags={...c,...e.tags});let I=(0,i.Jr)(o);I&&Object.keys(I).length&&(e.user={...I,...e.user});let d=(0,i.Jr)(r);d&&Object.keys(d).length&&(e.contexts={...d,...e.contexts}),l&&(e.level=l),s&&(e.transaction=s)})(e,t),s&&function(e,t){e.contexts={trace:(0,l.wy)(t),...e.contexts};let n=(0,r.G)(t);if(n){e.sdkProcessingMetadata={dynamicSamplingContext:(0,o.j)(t),...e.sdkProcessingMetadata};let i=(0,l.XU)(n).description;i&&(e.tags={transaction:i,...e.tags})}}(e,s),e.fingerprint=e.fingerprint?(0,g.lE)(e.fingerprint):[],n&&(e.fingerprint=e.fingerprint.concat(n)),e.fingerprint&&!e.fingerprint.length&&delete e.fingerprint,function(e,t){let n=[...e.breadcrumbs||[],...t];e.breadcrumbs=n.length?n:void 0}(e,a),e.sdkProcessingMetadata={...e.sdkProcessingMetadata,...c}}function a(e,t){let{extra:n,tags:i,user:g,contexts:o,level:r,sdkProcessingMetadata:l,breadcrumbs:s,fingerprint:a,eventProcessors:I,attachments:d,propagationContext:u,transactionName:C,span:b}=t;c(e,"extra",n),c(e,"tags",i),c(e,"user",g),c(e,"contexts",o),c(e,"sdkProcessingMetadata",l),r&&(e.level=r),C&&(e.transactionName=C),b&&(e.span=b),s.length&&(e.breadcrumbs=[...e.breadcrumbs,...s]),a.length&&(e.fingerprint=[...e.fingerprint,...a]),I.length&&(e.eventProcessors=[...e.eventProcessors,...I]),d.length&&(e.attachments=[...e.attachments,...d]),e.propagationContext={...e.propagationContext,...u}}function c(e,t,n){if(n&&Object.keys(n).length)for(let i in e[t]={...e[t]},n)Object.prototype.hasOwnProperty.call(n,i)&&(e[t][i]=n[i])}},9972:(e,t,n)=>{"use strict";function i(e){return e.transaction}n.d(t,{G:()=>i})},4301:(e,t,n)=>{"use strict";n.d(t,{i:()=>g});var i=n(6797);function g(e,t,n=()=>{}){var g;let o;try{o=e()}catch(e){throw t(e),n(),e}return g=o,(0,i.J8)(g)?g.then(e=>(n(),e),e=>{throw t(e),n(),e}):(n(),g)}},1301:(e,t,n)=>{"use strict";n.d(t,{z:()=>g});var i=n(155);function g(e){if("boolean"==typeof __SENTRY_TRACING__&&!__SENTRY_TRACING__)return!1;let t=(0,i.s3)(),n=e||t&&t.getOptions();return!!n&&(n.enableTracing||"tracesSampleRate"in n||"tracesSampler"in n)}},4214:(e,t,n)=>{"use strict";n.d(t,{R:()=>u,U0:()=>b});var i=n(7894),g=n(9463),o=n(9482),r=n(2936),l=n(4908),s=n(89),a=n(9537),c=n(3564),I=n(7942),d=n(8579);function u(e,t,n,u,b,p){let{normalizeDepth:m=3,normalizeMaxBreadth:Z=1e3}=e,h={...t,event_id:t.event_id||n.event_id||(0,i.DM)(),timestamp:t.timestamp||(0,g.yW)()},G=n.integrations||e.integrations.map(e=>e.name);(function(e,t){let{environment:n,release:i,dist:g,maxValueLength:r=250}=t;"environment"in e||(e.environment="environment"in t?n:s.J),void 0===e.release&&void 0!==i&&(e.release=i),void 0===e.dist&&void 0!==g&&(e.dist=g),e.message&&(e.message=(0,o.$G)(e.message,r));let l=e.exception&&e.exception.values&&e.exception.values[0];l&&l.value&&(l.value=(0,o.$G)(l.value,r));let a=e.request;a&&a.url&&(a.url=(0,o.$G)(a.url,r))})(h,e),G.length>0&&(h.sdk=h.sdk||{},h.sdk.integrations=[...h.sdk.integrations||[],...G]),void 0===t.type&&function(e,t){let n;let i=r.GLOBAL_OBJ._sentryDebugIds;if(!i)return;let g=C.get(t);g?n=g:(n=new Map,C.set(t,n));let o=Object.keys(i).reduce((e,g)=>{let o;let r=n.get(g);r?o=r:(o=t(g),n.set(g,o));for(let t=o.length-1;t>=0;t--){let n=o[t];if(n.filename){e[n.filename]=i[g];break}}return e},{});try{e.exception.values.forEach(e=>{e.stacktrace.frames.forEach(e=>{e.filename&&(e.debug_id=o[e.filename])})})}catch(e){}}(h,e.stackParser);let B=function(e,t){if(!t)return e;let n=e?e.clone():new c.sX;return n.update(t),n}(u,n.captureContext);n.mechanism&&(0,i.EG)(h,n.mechanism);let A=b&&b.getEventProcessors?b.getEventProcessors():[],y=(0,c.lW)().getScopeData();if(p){let e=p.getScopeData();(0,I.yo)(y,e)}if(B){let e=B.getScopeData();(0,I.yo)(y,e)}let W=[...n.attachments||[],...y.attachments];W.length&&(n.attachments=W),(0,I.gi)(h,y);let V=[...A,...(0,a.fH)(),...y.eventProcessors];return(0,a.RP)(V,h,n).then(e=>(e&&function(e){let t={};try{e.exception.values.forEach(e=>{e.stacktrace.frames.forEach(e=>{e.debug_id&&(e.abs_path?t[e.abs_path]=e.debug_id:e.filename&&(t[e.filename]=e.debug_id),delete e.debug_id)})})}catch(e){}if(0===Object.keys(t).length)return;e.debug_meta=e.debug_meta||{},e.debug_meta.images=e.debug_meta.images||[];let n=e.debug_meta.images;Object.keys(t).forEach(e=>{n.push({type:"sourcemap",code_file:e,debug_id:t[e]})})}(e),"number"==typeof m&&m>0)?function(e,t,n){if(!e)return null;let i={...e,...e.breadcrumbs&&{breadcrumbs:e.breadcrumbs.map(e=>({...e,...e.data&&{data:(0,l.Fv)(e.data,t,n)}}))},...e.user&&{user:(0,l.Fv)(e.user,t,n)},...e.contexts&&{contexts:(0,l.Fv)(e.contexts,t,n)},...e.extra&&{extra:(0,l.Fv)(e.extra,t,n)}};return e.contexts&&e.contexts.trace&&i.contexts&&(i.contexts.trace=e.contexts.trace,e.contexts.trace.data&&(i.contexts.trace.data=(0,l.Fv)(e.contexts.trace.data,t,n))),e.spans&&(i.spans=e.spans.map(e=>{let i=(0,d.XU)(e).data;return i&&(e.data=(0,l.Fv)(i,t,n)),e})),i}(e,m,Z):e)}let C=new WeakMap;function b(e){return e?e instanceof c.sX||"function"==typeof e||Object.keys(e).some(e=>p.includes(e))?{captureContext:e}:e:void 0}let p=["user","level","extra","contexts","tags","fingerprint","requestSession","propagationContext"]},8579:(e,t,n)=>{"use strict";n.d(t,{$k:()=>c,Hb:()=>a,Tt:()=>u,XU:()=>d,i0:()=>l,ve:()=>r,wy:()=>s});var i=n(4254),g=n(7210),o=n(9463);let r=0,l=1;function s(e){let{spanId:t,traceId:n}=e.spanContext(),{data:g,op:o,parent_span_id:r,status:l,tags:s,origin:a}=d(e);return(0,i.Jr)({data:g,op:o,parent_span_id:r,span_id:t,status:l,tags:s,trace_id:n,origin:a})}function a(e){let{traceId:t,spanId:n}=e.spanContext(),i=u(e);return(0,g.$p)(t,n,i)}function c(e){return"number"==typeof e?I(e):Array.isArray(e)?e[0]+e[1]/1e9:e instanceof Date?I(e.getTime()):(0,o.ph)()}function I(e){return e>9999999999?e/1e3:e}function d(e){return"function"==typeof e.getSpanJSON?e.getSpanJSON():"function"==typeof e.toJSON?e.toJSON():{}}function u(e){let{traceFlags:t}=e.spanContext();return!!(t&l)}},16:(e,t,n)=>{"use strict";n.d(t,{J:()=>i});let i="7.105.0"},7077:(e,t,n)=>{"use strict";n.d(t,{X:()=>i});let i=!1},8149:(e,t,n)=>{"use strict";n.d(t,{C:()=>o,g:()=>g});var i=n(6797);function g(e){return(0,i.VZ)(e)&&"NEXT_NOT_FOUND"===e.digest}function o(e){return(0,i.VZ)(e)&&"string"==typeof e.digest&&e.digest.startsWith("NEXT_REDIRECT;")}},1436:(e,t,n)=>{"use strict";n.d(t,{DO:()=>r});var i=n(155),g=n(8488),o=n(7077);async function r(){try{o.X&&g.kg.log("Flushing events..."),await (0,i.yl)(2e3),o.X&&g.kg.log("Done flushing events")}catch(e){o.X&&g.kg.log("Error while flushing events:\n",e)}}},8241:(e,t,n)=>{"use strict";let i,g,o;n.d(t,{S1:()=>nx});var r,l={};n.r(l),n.d(l,{FunctionToString:()=>h,InboundFilters:()=>S,LinkedErrors:()=>w});var s={};n.r(s),n.d(s,{Anr:()=>th.q,Console:()=>$,Context:()=>ez,ContextLines:()=>eK,Hapi:()=>tR,Http:()=>eh,LocalVariables:()=>tt,Modules:()=>eY,OnUncaughtException:()=>eW,OnUnhandledRejection:()=>eR,RequestData:()=>e5,Spotlight:()=>tZ,Undici:()=>tg});var a={};n.r(a),n.d(a,{Apollo:()=>tX,Express:()=>tN,GraphQL:()=>t_,Mongo:()=>tx,Mysql:()=>tE,Postgres:()=>tk,Prisma:()=>tU});var c=n(8176),I=n(16);function d(e,t,n=[t],i="npm"){let g=e._metadata||{};g.sdk||(g.sdk={name:`sentry.javascript.${t}`,packages:n.map(e=>({name:`${i}:@sentry/${e}`,version:I.J})),version:I.J}),e._metadata=g}var u=n(155),C=n(4254),b=n(6295);let p="FunctionToString",m=new WeakMap,Z=(0,b._I)(()=>({name:p,setupOnce(){i=Function.prototype.toString;try{Function.prototype.toString=function(...e){let t=(0,C.HK)(this),n=m.has((0,u.s3)())&&void 0!==t?t:this;return i.apply(n,e)}}catch(e){}},setup(e){m.set(e,!0)}})),h=(0,b.RN)(p,Z);var G=n(8488),B=n(7894),A=n(9482),y=n(1802);let W=[/^Script error\.?$/,/^Javascript error: Script error\.? on line 0$/],V=[/^.*\/healthcheck$/,/^.*\/healthy$/,/^.*\/live$/,/^.*\/ready$/,/^.*\/heartbeat$/,/^.*\/health$/,/^.*\/healthz$/],v="InboundFilters",R=(0,b._I)((e={})=>({name:v,setupOnce(){},processEvent:(t,n,i)=>!function(e,t){var n;return t.ignoreInternal&&function(e){try{return"SentryError"===e.exception.values[0].type}catch(e){}return!1}(e)?(y.X&&G.kg.warn(`Event dropped due to being internal Sentry Error.
Event: ${(0,B.jH)(e)}`),!0):(n=t.ignoreErrors,!e.type&&n&&n.length&&(function(e){let t;let n=[];e.message&&n.push(e.message);try{t=e.exception.values[e.exception.values.length-1]}catch(e){}return t&&t.value&&(n.push(t.value),t.type&&n.push(`${t.type}: ${t.value}`)),y.X&&0===n.length&&G.kg.error(`Could not extract message for event ${(0,B.jH)(e)}`),n})(e).some(e=>(0,A.U0)(e,n)))?(y.X&&G.kg.warn(`Event dropped due to being matched by \`ignoreErrors\` option.
Event: ${(0,B.jH)(e)}`),!0):!function(e,t){if("transaction"!==e.type||!t||!t.length)return!1;let n=e.transaction;return!!n&&(0,A.U0)(n,t)}(e,t.ignoreTransactions)?!function(e,t){if(!t||!t.length)return!1;let n=H(e);return!!n&&(0,A.U0)(n,t)}(e,t.denyUrls)?!function(e,t){if(!t||!t.length)return!0;let n=H(e);return!n||(0,A.U0)(n,t)}(e,t.allowUrls)&&(y.X&&G.kg.warn(`Event dropped due to not being matched by \`allowUrls\` option.
Event: ${(0,B.jH)(e)}.
Url: ${H(e)}`),!0):(y.X&&G.kg.warn(`Event dropped due to being matched by \`denyUrls\` option.
Event: ${(0,B.jH)(e)}.
Url: ${H(e)}`),!0):(y.X&&G.kg.warn(`Event dropped due to being matched by \`ignoreTransactions\` option.
Event: ${(0,B.jH)(e)}`),!0)}(t,function(e={},t={}){return{allowUrls:[...e.allowUrls||[],...t.allowUrls||[]],denyUrls:[...e.denyUrls||[],...t.denyUrls||[]],ignoreErrors:[...e.ignoreErrors||[],...t.ignoreErrors||[],...e.disableErrorDefaults?[]:W],ignoreTransactions:[...e.ignoreTransactions||[],...t.ignoreTransactions||[],...e.disableTransactionDefaults?[]:V],ignoreInternal:void 0===e.ignoreInternal||e.ignoreInternal}}(e,i.getOptions()))?t:null})),S=(0,b.RN)(v,R);function H(e){try{let t;try{t=e.exception.values[0].stacktrace.frames}catch(e){}return t?function(e=[]){for(let t=e.length-1;t>=0;t--){let n=e[t];if(n&&"<anonymous>"!==n.filename&&"[native code]"!==n.filename)return n.filename||null}return null}(t):null}catch(t){return y.X&&G.kg.error(`Cannot extract url for event ${(0,B.jH)(e)}`),null}}var X=n(6797);function Y(e,t){e.mechanism=e.mechanism||{type:"generic",handled:!0},e.mechanism={...e.mechanism,..."AggregateError"===e.type&&{is_exception_group:!0},exception_id:t}}function f(e,t,n,i){e.mechanism=e.mechanism||{type:"generic",handled:!0},e.mechanism={...e.mechanism,type:"chained",source:t,exception_id:n,parent_id:i}}var N=n(4908);function F(e,t){return e(t.stack||"",1)}function K(e,t){let n={type:t.name||t.constructor.name,value:t.message},i=F(e,t);return i.length&&(n.stacktrace={frames:i}),n}let _="LinkedErrors",J=(0,b._I)((e={})=>{let t=e.limit||5,n=e.key||"cause";return{name:_,setupOnce(){},preprocessEvent(e,i,g){let o=g.getOptions();!function(e,t,n=250,i,g,o,r){if(!o.exception||!o.exception.values||!r||!(0,X.V9)(r.originalException,Error))return;let l=o.exception.values.length>0?o.exception.values[o.exception.values.length-1]:void 0;l&&(o.exception.values=(function e(t,n,i,g,o,r,l,s){if(r.length>=i+1)return r;let a=[...r];if((0,X.V9)(g[o],Error)){Y(l,s);let r=t(n,g[o]),c=a.length;f(r,o,c,s),a=e(t,n,i,g[o],o,[r,...a],r,c)}return Array.isArray(g.errors)&&g.errors.forEach((g,r)=>{if((0,X.V9)(g,Error)){Y(l,s);let c=t(n,g),I=a.length;f(c,`errors[${r}]`,I,s),a=e(t,n,i,g,o,[c,...a],c,I)}}),a})(e,t,g,r.originalException,i,o.exception.values,l,0).map(e=>(e.value&&(e.value=(0,A.$G)(e.value,n)),e)))}(K,o.stackParser,o.maxValueLength,n,t,e,i)}}}),w=(0,b.RN)(_,J);var x=n(1017);let E=/^(\S+:\\|\/?)([\s\S]*?)((?:\.{1,2}|[^/\\]+?|)(\.[^./\\]*|))(?:[/\\]*)$/;function k(e){let t=e.length>1024?`<truncated>${e.slice(-1024)}`:e,n=E.exec(t);return n?n.slice(1):[]}function U(...e){let t="",n=!1;for(let i=e.length-1;i>=-1&&!n;i--){let g=i>=0?e[i]:"/";g&&(t=`${g}/${t}`,n="/"===g.charAt(0))}return t=(function(e,t){let n=0;for(let t=e.length-1;t>=0;t--){let i=e[t];"."===i?e.splice(t,1):".."===i?(e.splice(t,1),n++):n&&(e.splice(t,1),n--)}if(t)for(;n--;n)e.unshift("..");return e})(t.split("/").filter(e=>!!e),!n).join("/"),(n?"/":"")+t||"."}function T(e){let t=0;for(;t<e.length&&""===e[t];t++);let n=e.length-1;for(;n>=0&&""===e[n];n--);return t>n?[]:e.slice(t,n-t+1)}function z(e){return e.replace(/^[A-Z]:/,"").replace(/\\/g,"/")}function L(e=process.argv[1]?function(e){let t=k(e),n=t[0],i=t[1];return n||i?(i&&(i=i.slice(0,i.length-1)),n+i):"."}(process.argv[1]):process.cwd(),t="\\"===x.sep){let n=t?z(e):e;return e=>{if(!e)return;let i=t?z(e):e,{dir:g,base:o,ext:r}=x.posix.parse(i);(".js"===r||".mjs"===r||".cjs"===r)&&(o=o.slice(0,-1*r.length)),g||(g=".");let l=g.lastIndexOf("/node_modules");if(l>-1)return`${g.slice(l+14).replace(/\//g,".")}:${o}`;if(g.startsWith(n)){let e=g.slice(n.length+1).replace(/\//g,".");return e&&(e+=":"),e+=o}return o}}var Q=n(3837),O=n(2936),M=n(2649);function j(){"console"in O.GLOBAL_OBJ&&G.RU.forEach(function(e){e in O.GLOBAL_OBJ.console&&(0,C.hl)(O.GLOBAL_OBJ.console,e,function(t){return G.LD[e]=t,function(...t){(0,M.rK)("console",{args:t,level:e});let n=G.LD[e];n&&n.apply(O.GLOBAL_OBJ.console,t)}})})}let P=["fatal","error","warning","log","info","debug"],D="Console",q=(0,b._I)(()=>({name:D,setupOnce(){},setup(e){!function(e){let t="console";(0,M.Hj)(t,e),(0,M.D2)(t,j)}(({args:t,level:n})=>{if((0,u.s3)()===e)(0,u.n_)({category:"console",level:"warn"===n?"warning":P.includes(n)?n:"log",message:Q.format.apply(void 0,t)},{input:[...t],level:n})})}})),$=(0,b.RN)(D,q);var ee=n(1907),et=n(922);function en(e,t){let n=t&&void 0!==t.getClient?t.getClient():t,i=n&&n.getDsn(),g=n&&n.getOptions().tunnel;return!!i&&e.includes(i.host)||!!g&&ei(e)===ei(g)}function ei(e){return"/"===e[e.length-1]?e.slice(0,-1):e}var eg=n(634),eo=n(8579),er=n(7536),el=n(1540),es=n(1301);class ea{constructor(e){this._maxSize=e,this._cache=new Map}get size(){return this._cache.size}get(e){let t=this._cache.get(e);if(void 0!==t)return this._cache.delete(e),this._cache.set(e,t),t}set(e,t){this._cache.size>=this._maxSize&&this._cache.delete(this._cache.keys().next().value),this._cache.set(e,t)}remove(e){let t=this._cache.get(e);return t&&this._cache.delete(e),t}clear(){this._cache.clear()}keys(){return Array.from(this._cache.keys())}values(){let e=[];return this._cache.forEach(t=>e.push(t)),e}}var ec=n(7210),eI=n(9981),ed=n(3383),eu=n(7310);function eC(e){let{protocol:t,hostname:n,port:i}=em(e),g=e.pathname||"/",o=e.auth?function(e){let[t,n]=e.split(":");return`${t?"[Filtered]":""}:${n?"[Filtered]":""}@`}(e.auth):"";return`${t}//${o}${n}${i}${g}`}function eb(e,t,n){if(!e)return e;let[i,g]=e.split(" ");return t.host&&!t.protocol&&(t.protocol=(0,ee.x)([n,"optionalAccess",e=>e.agent,"optionalAccess",e=>e.protocol]),g=eC(t)),(0,ee.x)([g,"optionalAccess",e=>e.startsWith,"call",e=>e("///")])&&(g=g.slice(2)),`${i} ${g}`}function ep(e){let t={protocol:e.protocol,hostname:"string"==typeof e.hostname&&e.hostname.startsWith("[")?e.hostname.slice(1,-1):e.hostname,hash:e.hash,search:e.search,pathname:e.pathname,path:`${e.pathname||""}${e.search||""}`,href:e.href};return""!==e.port&&(t.port=Number(e.port)),(e.username||e.password)&&(t.auth=`${e.username}:${e.password}`),t}function em(e){let t=e.protocol||"",n=e.hostname||e.host||"",i=!e.port||80===e.port||443===e.port||/^(.*):(\d+)$/.test(n)?"":`:${e.port}`;return{protocol:t,hostname:n,port:i}}let eZ=(0,b._I)((e={})=>{let{breadcrumbs:t,tracing:n,shouldCreateSpanForRequest:i}=e;return new eh({breadcrumbs:t,tracing:!1!==n&&(0,C.Jr)({enableIfHasTracingEnabled:!0!==n||void 0,shouldCreateSpanForRequest:i})})});class eh{static __initStatic(){this.id="Http"}__init(){this.name=eh.id}constructor(e={}){eh.prototype.__init.call(this),this._breadcrumbs=void 0===e.breadcrumbs||e.breadcrumbs,this._tracing=e.tracing?!0===e.tracing?{}:e.tracing:void 0}setupOnce(e,t){var i,g;let o=(0,ee.x)([t,"call",e=>e(),"access",e=>e.getClient,"call",e=>e(),"optionalAccess",e=>e.getOptions,"call",e=>e()]),r=void 0!==(i=this._tracing)&&(!i.enableIfHasTracingEnabled||(0,es.z)(o));if(!this._breadcrumbs&&!r||o&&"sentry"!==o.instrumenter)return;let l=(g=this._tracing,r?(0,ee.x)([g,"optionalAccess",e=>e.shouldCreateSpanForRequest])||(0,ee.x)([o,"optionalAccess",e=>e.shouldCreateSpanForRequest]):()=>!1),s=(0,ee.x)([o,"optionalAccess",e=>e.tracePropagationTargets])||(0,ee.x)([this,"access",e=>e._tracing,"optionalAccess",e=>e.tracePropagationTargets]),a=n(3685),c=eG(a,this._breadcrumbs,l,s);if((0,C.hl)(a,"get",c),(0,C.hl)(a,"request",c),ed.V.major>8){let e=n(5687),t=eG(e,this._breadcrumbs,l,s);(0,C.hl)(e,"get",t),(0,C.hl)(e,"request",t)}}}function eG(e,t,n,i){let g=new ea(100),o=new ea(100),r=e=>{if(void 0===n)return!0;let t=g.get(e);if(void 0!==t)return t;let i=n(e);return g.set(e,i),i},l=e=>{if(void 0===i)return!0;let t=o.get(e);if(void 0!==t)return t;let n=(0,A.U0)(e,i);return o.set(e,n),n};function s(e,t,n,i){(0,et.Gd)().getIntegration(eh)&&(0,u.n_)({category:"http",data:{status_code:i&&i.statusCode,...t},type:"http"},{event:e,request:n,response:i})}return function(n){return function(...i){let g=function(e,t){let n,i;if("function"==typeof t[t.length-1]&&(n=t.pop()),"string"==typeof t[0])i=ep(new eu.URL(t[0]));else if(t[0]instanceof eu.URL)i=ep(t[0]);else{i=t[0];try{let e=new eu.URL(i.path||"",`${i.protocol||"http:"}//${i.hostname}`);i={pathname:e.pathname,search:e.search,hash:e.hash,...i}}catch(e){}}return(2===t.length&&(i={...i,...t[1]}),void 0===i.protocol&&(ed.V.major>8?i.protocol=(0,ee.x)([(0,ee.x)([e,"optionalAccess",e=>e.globalAgent]),"optionalAccess",e=>e.protocol])||(0,ee.x)([i.agent,"optionalAccess",e=>e.protocol])||(0,ee.x)([i._defaultAgent,"optionalAccess",e=>e.protocol]):i.protocol=(0,ee.x)([i.agent,"optionalAccess",e=>e.protocol])||(0,ee.x)([i._defaultAgent,"optionalAccess",e=>e.protocol])||(0,ee.x)([(0,ee.x)([e,"optionalAccess",e=>e.globalAgent]),"optionalAccess",e=>e.protocol])),n)?[i,n]:[i]}(e,i),o=g[0],a=function(e){let{protocol:t,hostname:n,port:i}=em(e),g=e.path?e.path:"/";return`${t}//${n}${i}${g}`}(o),c=eC(o),I=(0,u.s3)();if(en(c,I))return n.apply(e,g);let d=(0,u.nZ)(),C=(0,et.aF)(),b=(0,eg.HN)(),p=function(e,t){let n={url:e,"http.method":t.method||"GET"};return t.hash&&(n["http.fragment"]=t.hash.substring(1)),t.search&&(n["http.query"]=t.search.substring(1)),n}(c,o),m=r(a)?(0,ee.x)([b,"optionalAccess",e=>e.startChild,"call",e=>e({op:"http.client",origin:"auto.http.node.http",description:`${p["http.method"]} ${p.url}`,data:p})]):void 0;if(I&&l(a)){let{traceId:e,spanId:t,sampled:n,dsc:i}={...C.getPropagationContext(),...d.getPropagationContext()};(function(e,t,n,i){if(!(e.headers||{})["sentry-trace"])e.headers={...e.headers,"sentry-trace":n,...i&&i.length>0&&{baggage:e.headers&&e.headers.baggage?i?Array.isArray(e.headers.baggage)?[...e.headers.baggage,i]:[e.headers.baggage,i]:e.headers.baggage:i}}})(o,0,m?(0,eo.Hb)(m):(0,ec.$p)(e,t,n),(0,eI.IQ)(i||(m?(0,er.j)(m):(0,er._)(e,I,d))))}return n.apply(e,g).once("response",function(e){t&&s("response",p,this,e),m&&(e.statusCode&&(0,el.Q0)(m,e.statusCode),m.updateName(eb((0,eo.XU)(m).description||"",o,this)||""),m.end())}).once("error",function(){t&&s("error",p,this),m&&((0,el.Q0)(m,500),m.updateName(eb((0,eo.XU)(m).description||"",o,this)||""),m.end())})}}}function eB(e){(0,G.Cf)(()=>{console.error(e)});let t=(0,u.s3)();void 0===t&&global.process.exit(1);let n=t.getOptions(),i=n&&n.shutdownTimeout&&n.shutdownTimeout>0&&n.shutdownTimeout||2e3;t.close(i).then(e=>{global.process.exit(1)},e=>{})}eh.__initStatic();let eA="OnUncaughtException",ey=(0,b._I)((e={})=>{let t={exitEvenIfOtherHandlersAreRegistered:!0,...e};return{name:eA,setupOnce(){},setup(e){global.process.on("uncaughtException",function(e,t){let n;let i=!1,g=!1,o=!1,r=e.getOptions();return Object.assign(l=>{let s=eB;t.onFatalError?s=t.onFatalError:r.onFatalError&&(s=r.onFatalError);let a=global.process.listeners("uncaughtException").reduce((e,t)=>"domainUncaughtExceptionClear"===t.name||t.tag&&"sentry_tracingErrorCallback"===t.tag||t._errorHandler?e:e+1,0),c=t.exitEvenIfOtherHandlersAreRegistered||0===a;i?c&&(o?eB(l):g||(g=!0,setTimeout(()=>{o||(o=!0,s(n,l))},2e3))):(n=l,i=!0,(0,u.s3)()===e&&(0,u.Tb)(l,{originalException:l,captureContext:{level:"fatal"},mechanism:{handled:!1,type:"onuncaughtexception"}}),!o&&c&&(o=!0,s(l)))},{_errorHandler:!0})}(e,t))}}}),eW=(0,b.RN)(eA,ey),eV="OnUnhandledRejection",ev=(0,b._I)((e={})=>{let t=e.mode||"warn";return{name:eV,setupOnce(){},setup(e){var n;global.process.on("unhandledRejection",(n={mode:t},function(t,i){(0,u.s3)()===e&&((0,u.Tb)(t,{originalException:i,captureContext:{extra:{unhandledPromiseRejection:!0}},mechanism:{handled:!1,type:"onunhandledrejection"}}),function(e,t){let n="This error originated either by throwing inside of an async function without a catch block, or by rejecting a promise which was not handled with .catch(). The promise rejected with the reason:";"warn"===t.mode?(0,G.Cf)(()=>{console.warn(n),console.error(e&&e.stack?e.stack:e)}):"strict"===t.mode&&((0,G.Cf)(()=>{console.warn(n)}),eB(e))}(t,n))}))}}}),eR=(0,b.RN)(eV,ev);var eS=n(7147);let eH="Modules",eX=(0,b._I)(()=>({name:eH,setupOnce(){},processEvent:e=>(e.modules={...e.modules,...(g||(g=function(){let e=n.c[n.s]&&n.c[n.s].paths||[],t=function(){try{return n.c?Object.keys(n.c):[]}catch(e){return[]}}(),i={},g={};return t.forEach(t=>{let n=t,o=()=>{let t=n;if(!(n=(0,x.dirname)(t))||t===n||g[t])return;if(0>e.indexOf(n))return o();let r=(0,x.join)(t,"package.json");if(g[t]=!0,!(0,eS.existsSync)(r))return o();try{let e=JSON.parse((0,eS.readFileSync)(r,"utf8"));i[e.name]=e.version}catch(e){}};o()}),i}()),g)},e)})),eY=(0,b.RN)(eH,eX),ef=new ea(100),eN="ContextLines",eF=(0,b._I)((e={})=>{let t=void 0!==e.frameContextLines?e.frameContextLines:7;return{name:eN,setupOnce(){},processEvent:e=>e_(e,t)}}),eK=(0,b.RN)(eN,eF);async function e_(e,t){let n={},i=[];if(t>0&&(0,ee.x)([e,"access",e=>e.exception,"optionalAccess",e=>e.values])){for(let t of e.exception.values)if((0,ee.x)([t,"access",e=>e.stacktrace,"optionalAccess",e=>e.frames]))for(let e=t.stacktrace.frames.length-1;e>=0;e--){let g=t.stacktrace.frames[e];!g.filename||n[g.filename]||ef.get(g.filename)||(i.push(eJ(g.filename)),n[g.filename]=1)}}if(i.length>0&&await Promise.all(i),t>0&&(0,ee.x)([e,"access",e=>e.exception,"optionalAccess",e=>e.values]))for(let n of e.exception.values)n.stacktrace&&n.stacktrace.frames&&await function(e,t){for(let n of e)if(n.filename&&void 0===n.context_line){let e=ef.get(n.filename);if(e)try{(0,B.go)(e,n,t)}catch(e){}}}(n.stacktrace.frames,t);return e}async function eJ(e){let t=ef.get(e);if(null===t)return null;if(void 0!==t)return t;let n=null;try{n=(await new Promise((t,n)=>{(0,eS.readFile)(e,"utf8",(e,i)=>{e?n(e):t(i)})})).split("\n")}catch(e){}return ef.set(e,n),n}var ew=n(2081),ex=n(2037);let eE=(0,Q.promisify)(eS.readFile),ek=(0,Q.promisify)(eS.readdir),eU="Context",eT=(0,b._I)((e={})=>{let t;let n={app:!0,os:!0,device:!0,culture:!0,cloudResource:!0,...e};async function i(e){var n;void 0===t&&(t=g());let i=(n=await t,(0,ee.x)([n,"optionalAccess",e=>e.app,"optionalAccess",e=>e.app_memory])&&(n.app.app_memory=process.memoryUsage().rss),(0,ee.x)([n,"optionalAccess",e=>e.device,"optionalAccess",e=>e.free_memory])&&(n.device.free_memory=ex.freemem()),n);return e.contexts={...e.contexts,app:{...i.app,...(0,ee.x)([e,"access",e=>e.contexts,"optionalAccess",e=>e.app])},os:{...i.os,...(0,ee.x)([e,"access",e=>e.contexts,"optionalAccess",e=>e.os])},device:{...i.device,...(0,ee.x)([e,"access",e=>e.contexts,"optionalAccess",e=>e.device])},culture:{...i.culture,...(0,ee.x)([e,"access",e=>e.contexts,"optionalAccess",e=>e.culture])},cloud_resource:{...i.cloud_resource,...(0,ee.x)([e,"access",e=>e.contexts,"optionalAccess",e=>e.cloud_resource])}},e}async function g(){let e={};if(n.os&&(e.os=await eL()),n.app&&(e.app=function(){let e=process.memoryUsage().rss;return{app_start_time:new Date(Date.now()-1e3*process.uptime()).toISOString(),app_memory:e}}()),n.device&&(e.device=function(e){let t;let n={};try{t=ex.uptime&&ex.uptime()}catch(e){}if("number"==typeof t&&(n.boot_time=new Date(Date.now()-1e3*t).toISOString()),n.arch=ex.arch(),(!0===e||e.memory)&&(n.memory_size=ex.totalmem(),n.free_memory=ex.freemem()),!0===e||e.cpu){let e=ex.cpus();if(e&&e.length){let t=e[0];n.processor_count=e.length,n.cpu_description=t.model,n.processor_frequency=t.speed}}return n}(n.device)),n.culture){let t=function(){try{if("string"!=typeof process.versions.icu)return;let e=new Date(9e8),t=new Intl.DateTimeFormat("es",{month:"long"});if("enero"===t.format(e)){let e=Intl.DateTimeFormat().resolvedOptions();return{locale:e.locale,timezone:e.timeZone}}}catch(e){}}();t&&(e.culture=t)}return n.cloudResource&&(e.cloud_resource=function(){if(process.env.VERCEL)return{"cloud.provider":"vercel","cloud.region":process.env.VERCEL_REGION};if(process.env.AWS_REGION)return{"cloud.provider":"aws","cloud.region":process.env.AWS_REGION,"cloud.platform":process.env.AWS_EXECUTION_ENV};if(process.env.GCP_PROJECT)return{"cloud.provider":"gcp"};if(process.env.ALIYUN_REGION_ID)return{"cloud.provider":"alibaba_cloud","cloud.region":process.env.ALIYUN_REGION_ID};if(process.env.WEBSITE_SITE_NAME&&process.env.REGION_NAME)return{"cloud.provider":"azure","cloud.region":process.env.REGION_NAME};if(process.env.IBM_CLOUD_REGION)return{"cloud.provider":"ibm_cloud","cloud.region":process.env.IBM_CLOUD_REGION};if(process.env.TENCENTCLOUD_REGION)return{"cloud.provider":"tencent_cloud","cloud.region":process.env.TENCENTCLOUD_REGION,"cloud.account.id":process.env.TENCENTCLOUD_APPID,"cloud.availability_zone":process.env.TENCENTCLOUD_ZONE};else if(process.env.NETLIFY)return{"cloud.provider":"netlify"};else if(process.env.FLY_REGION)return{"cloud.provider":"fly.io","cloud.region":process.env.FLY_REGION};else if(process.env.DYNO)return{"cloud.provider":"heroku"};else return}()),e}return{name:eU,setupOnce(){},processEvent:e=>i(e)}}),ez=(0,b.RN)(eU,eT);async function eL(){let e=ex.platform();switch(e){case"darwin":return eP();case"linux":return eq();default:return{name:eQ[e]||e,version:ex.release()}}}let eQ={aix:"IBM AIX",freebsd:"FreeBSD",openbsd:"OpenBSD",sunos:"SunOS",win32:"Windows"},eO=[{name:"fedora-release",distros:["Fedora"]},{name:"redhat-release",distros:["Red Hat Linux","Centos"]},{name:"redhat_version",distros:["Red Hat Linux"]},{name:"SuSE-release",distros:["SUSE Linux"]},{name:"lsb-release",distros:["Ubuntu Linux","Arch Linux"]},{name:"debian_version",distros:["Debian"]},{name:"debian_release",distros:["Debian"]},{name:"arch-release",distros:["Arch Linux"]},{name:"gentoo-release",distros:["Gentoo Linux"]},{name:"novell-release",distros:["SUSE Linux"]},{name:"alpine-release",distros:["Alpine Linux"]}],eM={alpine:e=>e,arch:e=>ej(/distrib_release=(.*)/,e),centos:e=>ej(/release ([^ ]+)/,e),debian:e=>e,fedora:e=>ej(/release (..)/,e),mint:e=>ej(/distrib_release=(.*)/,e),red:e=>ej(/release ([^ ]+)/,e),suse:e=>ej(/VERSION = (.*)\n/,e),ubuntu:e=>ej(/distrib_release=(.*)/,e)};function ej(e,t){let n=e.exec(t);return n?n[1]:void 0}async function eP(){let e={kernel_version:ex.release(),name:"Mac OS X",version:`10.${Number(ex.release().split(".")[0])-4}`};try{let t=await new Promise((e,t)=>{(0,ew.execFile)("/usr/bin/sw_vers",(n,i)=>{if(n){t(n);return}e(i)})});e.name=ej(/^ProductName:\s+(.*)$/m,t),e.version=ej(/^ProductVersion:\s+(.*)$/m,t),e.build=ej(/^BuildVersion:\s+(.*)$/m,t)}catch(e){}return e}function eD(e){return e.split(" ")[0].toLowerCase()}async function eq(){let e={kernel_version:ex.release(),name:"Linux"};try{let t=await ek("/etc"),n=eO.find(e=>t.includes(e.name));if(!n)return e;let i=(0,x.join)("/etc",n.name),g=(await eE(i,{encoding:"utf-8"})).toLowerCase(),{distros:o}=n;e.name=o.find(e=>g.indexOf(eD(e))>=0)||o[0];let r=eD(e.name);e.version=eM[r](g)}catch(e){}return e}var e$=n(282);let e0={include:{cookies:!0,data:!0,headers:!0,ip:!1,query_string:!0,url:!0,user:{id:!0,username:!0,email:!0}},transactionNamingScheme:"methodPath"},e2="RequestData",e9=(0,b._I)((e={})=>{let t=e$.S6,n={...e0,...e,include:{method:!0,...e0.include,...e.include,user:e.include&&"boolean"==typeof e.include.user?e.include.user:{...e0.include.user,...(e.include||{}).user}}};return{name:e2,setupOnce(){},processEvent(e,i,g){let{transactionNamingScheme:o}=n,{sdkProcessingMetadata:r={}}=e,l=r.request;if(!l)return e;let s=t(e,l,r.requestDataOptionsFromExpressHandler||r.requestDataOptionsFromGCPWrapper||function(e){let t;let{transactionNamingScheme:n,include:{ip:i,user:g,...o}}=e,r=[];for(let[e,t]of Object.entries(o))t&&r.push(e);if(void 0===g)t=!0;else if("boolean"==typeof g)t=g;else{let e=[];for(let[t,n]of Object.entries(g))n&&e.push(t);t=e}return{include:{ip:i,user:t,request:0!==r.length?r:void 0,transaction:n}}}(n));if("transaction"===e.type||"handler"===o)return s;let a=l._sentryTransaction;if(a){let e=(0,eo.XU)(a).description||"",t="sentry.javascript.nextjs"===function(e){try{return e.getOptions()._metadata.sdk.name}catch(e){return}}(g)?e.startsWith("/api"):"path"!==o,[n]=(0,e$.oA)(l,{path:!0,method:t,customRoute:e});s.transaction=n}return s}}}),e5=(0,b.RN)(e2,e9);function e1(e){return void 0!==e&&(0===e.length||"?"===e||"<anonymous>"===e)}function e3(e){if(void 0!==e)return e.slice(-10).reduce((e,t)=>`${e},${t.function},${t.lineno},${t.colno}`,"")}function e4(e){let t=[],n=!1;function i(i){t=[],n||(n=!0,e(i))}return t.push(i),{add:function(e){t.push(e)},next:function(e){let n=t.pop()||i;try{n(e)}catch(t){i(e)}}}}class e8{constructor(){let{Session:e}=n(1405);this._session=new e}configureAndConnect(e,t){this._session.connect(),this._session.on("Debugger.paused",t=>{e(t,()=>{this._session.post("Debugger.resume")})}),this._session.post("Debugger.enable"),this._session.post("Debugger.setPauseOnExceptions",{state:t?"all":"uncaught"})}setPauseOnExceptions(e){this._session.post("Debugger.setPauseOnExceptions",{state:e?"all":"uncaught"})}getLocalVariables(e,t){this._getProperties(e,e=>{let{add:n,next:i}=e4(t);for(let t of e)if((0,ee.x)([t,"optionalAccess",e=>e.value,"optionalAccess",e=>e.objectId])&&"Array"===(0,ee.x)([t,"optionalAccess",e=>e.value,"access",e=>e.className])){let e=t.value.objectId;n(n=>this._unrollArray(e,t.name,n,i))}else if((0,ee.x)([t,"optionalAccess",e=>e.value,"optionalAccess",e=>e.objectId])&&"Object"===(0,ee.x)([t,"optionalAccess",e=>e.value,"optionalAccess",e=>e.className])){let e=t.value.objectId;n(n=>this._unrollObject(e,t.name,n,i))}else((0,ee.x)([t,"optionalAccess",e=>e.value,"optionalAccess",e=>e.value])||(0,ee.x)([t,"optionalAccess",e=>e.value,"optionalAccess",e=>e.description]))&&n(e=>this._unrollOther(t,e,i));i({})})}_getProperties(e,t){this._session.post("Runtime.getProperties",{objectId:e,ownProperties:!0},(e,n)=>{e?t([]):t(n.result)})}_unrollArray(e,t,n,i){this._getProperties(e,e=>{n[t]=e.filter(e=>"length"!==e.name&&!isNaN(parseInt(e.name,10))).sort((e,t)=>parseInt(e.name,10)-parseInt(t.name,10)).map(e=>(0,ee.x)([e,"optionalAccess",e=>e.value,"optionalAccess",e=>e.value])),i(n)})}_unrollObject(e,t,n,i){this._getProperties(e,e=>{n[t]=e.map(e=>[e.name,(0,ee.x)([e,"optionalAccess",e=>e.value,"optionalAccess",e=>e.value])]).reduce((e,[t,n])=>(e[t]=n,e),{}),i(n)})}_unrollOther(e,t,n){(0,ee.x)([e,"optionalAccess",e=>e.value,"optionalAccess",e=>e.value])?t[e.name]=e.value.value:(0,ee.x)([e,"optionalAccess",e=>e.value,"optionalAccess",e=>e.description])&&"function"!==(0,ee.x)([e,"optionalAccess",e=>e.value,"optionalAccess",e=>e.type])&&(t[e.name]=`<${e.value.description}>`),n(t)}}function e7(){try{return new e8}catch(e){return}}let e6="LocalVariables",te=(0,b._I)((e={},t=e7())=>{let n;let i=new ea(20),g=!1;return{name:e6,setupOnce(){let o=(0,u.s3)(),r=(0,ee.x)([o,"optionalAccess",e=>e.getOptions,"call",e=>e()]);if(t&&(0,ee.x)([r,"optionalAccess",e=>e.includeLocalVariables])){if(ed.V.major<18){G.kg.log("The `LocalVariables` integration is only supported on Node >= v18.");return}let o=!1!==e.captureAllExceptions;if(t.configureAndConnect((e,g)=>(function(e,{params:{reason:g,data:o,callFrames:r}},l){if("exception"!==g&&"promiseRejection"!==g){l();return}(0,ee.x)([n,"optionalCall",e=>e()]);let s=function(e,t){if(void 0!==t)return e3(e(t,1))}(e,(0,ee.x)([o,"optionalAccess",e=>e.description]));if(void 0==s){l();return}let{add:a,next:c}=e4(e=>{i.set(s,e),l()});for(let e=0;e<Math.min(r.length,5);e++){let{scopeChain:n,functionName:i,this:g}=r[e],o=n.find(e=>"local"===e.type),l="global"!==g.className&&g.className?`${g.className}.${i}`:i;if(void 0===(0,ee.x)([o,"optionalAccess",e=>e.object,"access",e=>e.objectId]))a(t=>{t[e]={function:l},c(t)});else{let n=o.object.objectId;a(i=>(0,ee.x)([t,"optionalAccess",e=>e.getLocalVariables,"call",t=>t(n,t=>{i[e]={function:l,vars:t},c(i)})]))}}c([])})(r.stackParser,e,g),o),o){var l,s,a;let i,g,o;l=e.maxExceptionsPerSecond||50,s=()=>{G.kg.log("Local variables rate-limit lifted."),(0,ee.x)([t,"optionalAccess",e=>e.setPauseOnExceptions,"call",e=>e(!0)])},a=e=>{G.kg.log(`Local variables rate-limit exceeded. Disabling capturing of caught exceptions for ${e} seconds.`),(0,ee.x)([t,"optionalAccess",e=>e.setPauseOnExceptions,"call",e=>e(!1)])},i=0,g=5,o=0,setInterval(()=>{0===o?i>l&&(a(g*=2),g>86400&&(g=86400),o=g):0==(o-=1)&&s(),i=0},1e3).unref(),n=()=>{i+=1}}g=!0}},processEvent:e=>g?function(e){for(let t of(0,ee.x)([e,"optionalAccess",e=>e.exception,"optionalAccess",e=>e.values])||[])!function(e){let t=e3((0,ee.x)([e,"optionalAccess",e=>e.stacktrace,"optionalAccess",e=>e.frames]));if(void 0===t)return;let n=i.remove(t);if(void 0===n)return;let g=(0,ee.x)([e,"access",e=>e.stacktrace,"optionalAccess",e=>e.frames,"optionalAccess",e=>e.length])||0;for(let t=0;t<g;t++){var o,r;let i=g-t-1;if(!(0,ee.x)([e,"optionalAccess",e=>e.stacktrace,"optionalAccess",e=>e.frames,"optionalAccess",e=>e[i]])||!n[t])break;void 0!==n[t].vars&&!1!==e.stacktrace.frames[i].in_app&&((o=e.stacktrace.frames[i].function)===(r=n[t].function)||e1(o)&&e1(r))&&(e.stacktrace.frames[i].vars=n[t].vars)}}(t);return e}(e):e,_getCachedFramesCount:()=>i.size,_getFirstCachedFrame:()=>i.values()[0]}}),tt=(0,b.RN)(e6,te);var tn=n(4228);!function(e){e.RequestCreate="undici:request:create",e.RequestEnd="undici:request:headers",e.RequestError="undici:request:error"}(r||(r={}));let ti=(0,b._I)(e=>new tg(e));class tg{static __initStatic(){this.id="Undici"}__init(){this.name=tg.id}__init2(){this._createSpanUrlMap=new ea(100)}__init3(){this._headersUrlMap=new ea(100)}constructor(e={}){tg.prototype.__init.call(this),tg.prototype.__init2.call(this),tg.prototype.__init3.call(this),tg.prototype.__init4.call(this),tg.prototype.__init5.call(this),tg.prototype.__init6.call(this),this._options={breadcrumbs:void 0===e.breadcrumbs||e.breadcrumbs,tracing:e.tracing,shouldCreateSpanForRequest:e.shouldCreateSpanForRequest}}setupOnce(e){let t;if(!(ed.V.major<16)){try{t=n(7643)}catch(e){}t&&t.subscribe&&(t.subscribe(r.RequestCreate,this._onRequestCreate),t.subscribe(r.RequestEnd,this._onRequestEnd),t.subscribe(r.RequestError,this._onRequestError))}}_shouldCreateSpan(e){if(!1===this._options.tracing||void 0===this._options.tracing&&!(0,es.z)())return!1;if(void 0===this._options.shouldCreateSpanForRequest)return!0;let t=this._createSpanUrlMap.get(e);if(void 0!==t)return t;let n=this._options.shouldCreateSpanForRequest(e);return this._createSpanUrlMap.set(e,n),n}__init4(){this._onRequestCreate=e=>{if(!(0,ee.x)([u.s3,"call",e=>e(),"optionalAccess",e=>e.getIntegration,"call",e=>e(tg)]))return;let{request:t}=e,n=t.origin?t.origin.toString()+t.path:t.path,i=(0,u.s3)();if(!i||en(n,i)||void 0!==t.__sentry_span__)return;let g=i.getOptions(),o=(0,u.nZ)(),r=(0,et.aF)(),l=(0,eg.HN)(),s=this._shouldCreateSpan(n)?function(e,t,n){let i=(0,tn.en)(n),g=t.method||"GET",o={"http.method":g};return i.search&&(o["http.query"]=i.search),i.hash&&(o["http.fragment"]=i.hash),(0,ee.x)([e,"optionalAccess",e=>e.startChild,"call",e=>e({op:"http.client",origin:"auto.http.node.undici",description:`${g} ${(0,tn.tF)(i)}`,data:o})])}(l,t,n):void 0;if(s&&(t.__sentry_span__=s),(e=>{if(void 0===g.tracePropagationTargets)return!0;let t=this._headersUrlMap.get(e);if(void 0!==t)return t;let n=(0,A.U0)(e,g.tracePropagationTargets);return this._headersUrlMap.set(e,n),n})(n)){var a;let{traceId:e,spanId:n,sampled:g,dsc:l}={...r.getPropagationContext(),...o.getPropagationContext()},c=s?(0,eo.Hb)(s):(0,ec.$p)(e,n,g);a=(0,eI.IQ)(l||(s?(0,er.j)(s):(0,er._)(e,i,o))),!t.headers.split("\r\n").some(e=>e.startsWith("sentry-trace:"))&&(t.addHeader("sentry-trace",c),a&&t.addHeader("baggage",a))}}}__init5(){this._onRequestEnd=e=>{if(!(0,ee.x)([u.s3,"call",e=>e(),"optionalAccess",e=>e.getIntegration,"call",e=>e(tg)]))return;let{request:t,response:n}=e,i=t.origin?t.origin.toString()+t.path:t.path;if(en(i,(0,u.s3)()))return;let g=t.__sentry_span__;g&&((0,el.Q0)(g,n.statusCode),g.end()),this._options.breadcrumbs&&(0,u.n_)({category:"http",data:{method:t.method,status_code:n.statusCode,url:i},type:"http"},{event:"response",request:t,response:n})}}__init6(){this._onRequestError=e=>{if(!(0,ee.x)([u.s3,"call",e=>e(),"optionalAccess",e=>e.getIntegration,"call",e=>e(tg)]))return;let{request:t}=e,n=t.origin?t.origin.toString()+t.path:t.path;if(en(n,(0,u.s3)()))return;let i=t.__sentry_span__;i&&(i.setStatus("internal_error"),i.end()),this._options.breadcrumbs&&(0,u.n_)({category:"http",data:{method:t.method,url:n},level:"error",type:"http"},{event:"error",request:t})}}}tg.__initStatic();var to=n(3685),tr=n(1165);let tl=/^(?:(\w+):)\/\/(?:(\w+)(?::(\w+)?)?@)([\w.-]+)(?::(\d+))?\/(.+)/;function ts(e,t=!1){let{host:n,path:i,pass:g,port:o,projectId:r,protocol:l,publicKey:s}=e;return`${l}://${s}${t&&g?`:${g}`:""}@${n}${o?`:${o}`:""}/${i?`${i}/`:i}${r}`}function ta(e){return{protocol:e.protocol,publicKey:e.publicKey||"",pass:e.pass||"",host:e.host,port:e.port||"",path:e.path||"",projectId:e.projectId}}function tc(e,t=[]){return[e,t]}function tI(e,t){for(let n of e[1]){let e=n[0].type;if(t(n,e))return!0}return!1}function td(e,t){return(t||new TextEncoder).encode(e)}function tu(e,t){let[n,i]=e,g=JSON.stringify(n);function o(e){"string"==typeof g?g="string"==typeof e?g+e:[td(g,t),e]:g.push("string"==typeof e?td(e,t):e)}for(let e of i){let[t,n]=e;if(o(`
${JSON.stringify(t)}
`),"string"==typeof n||n instanceof Uint8Array)o(n);else{let e;try{e=JSON.stringify(n)}catch(t){e=JSON.stringify((0,N.Fv)(n))}o(e)}}return"string"==typeof g?g:function(e){let t=e.reduce((e,t)=>e+t.length,0),n=new Uint8Array(t),i=0;for(let t of e)n.set(t,i),i+=t.length;return n}(g)}let tC={session:"session",sessions:"session",attachment:"attachment",transaction:"transaction",event:"error",client_report:"internal",user_report:"default",profile:"profile",replay_event:"replay",replay_recording:"replay",check_in:"monitor",feedback:"feedback",span:"span",statsd:"unknown"};function tb(e){if(!e||!e.sdk)return;let{name:t,version:n}=e.sdk;return{name:t,version:n}}let tp="Spotlight",tm=(0,b._I)((e={})=>{let t={sidecarUrl:e.sidecarUrl||"http://localhost:8969/stream"};return{name:tp,setupOnce(){},setup(e){"object"==typeof process&&process.env&&G.kg.warn("[Spotlight] It seems you're not in dev mode. Do you really want to have Spotlight enabled?"),function(e,t){let n=function(e){try{return new eu.URL(`${e}`)}catch(t){G.kg.warn(`[Spotlight] Invalid sidecar URL: ${e}`);return}}(t.sidecarUrl);if(!n)return;let i=0;if("function"!=typeof e.on){G.kg.warn("[Spotlight] Cannot connect to spotlight due to missing method on SDK client (`client.on`)");return}e.on("beforeEnvelope",e=>{if(i>3){G.kg.warn("[Spotlight] Disabled Sentry -> Spotlight integration due to too many failed requests");return}let t=tu(e),g=(function(){let{request:e}=to;return"__sentry_original__"in e?e.__sentry_original__:e})()({method:"POST",path:n.pathname,hostname:n.hostname,port:n.port,headers:{"Content-Type":"application/x-sentry-envelope"}},e=>{e.on("data",()=>{}),e.on("end",()=>{}),e.setEncoding("utf8")});g.on("error",()=>{i++,G.kg.warn("[Spotlight] Failed to send envelope to Spotlight Sidecar")}),g.write(t),g.end()})}(e,t)}}}),tZ=(0,b.RN)(tp,tm);var th=n(948),tG=n(7353);function tB(e){return e&&void 0!==e.statusCode}function tA(e){(0,u.Tb)(e,{mechanism:{type:"hapi",handled:!1,data:{function:"hapiErrorPlugin"}}})}let ty={name:"SentryHapiErrorPlugin",version:I.J,register:async function(e){e.events.on("request",(e,t)=>{var n;let i=(0,tG.x1)();e.response&&(n=e.response)&&void 0!==n.isBoom?tA(e.response):t&&void 0!==t.error&&tA(t.error),i&&(i.setStatus("internal_error"),i.end())})}},tW={name:"SentryHapiTracingPlugin",version:I.J,register:async function(e){e.ext("onPreHandler",(e,t)=>{let n=(0,eg.yn)({sentryTrace:e.headers["sentry-trace"]||void 0,baggage:e.headers.baggage||void 0},t=>(0,u.Yr)({...t,op:"hapi.request",name:e.route.path,description:`${e.route.method} ${e.path}`}));return(0,u.nZ)().setSpan(n),t.continue}),e.ext("onPreResponse",(e,t)=>{let n=(0,tG.x1)();if(e.response&&tB(e.response)&&n){let t=e.response;t.header("sentry-trace",(0,eo.Hb)(n));let i=(0,eI.IQ)((0,er.j)(n));i&&t.header("baggage",i)}return t.continue}),e.ext("onPostHandler",(e,t)=>{let n=(0,tG.x1)();return n&&(e.response&&tB(e.response)&&(0,el.Q0)(n,e.response.statusCode),n.end()),t.continue})}},tV="Hapi",tv=(0,b._I)((e={})=>{let t=e.server;return{name:tV,setupOnce(){t&&(0,C.hl)(t,"start",e=>async function(){return await this.register(tW),await this.register(ty),e.apply(this)})}}}),tR=(0,b.RN)(tV,tv);var tS=n(6614);function tH(e){let t=(0,ee.x)([e,"call",e=>e(),"access",e=>e.getClient,"call",e=>e(),"optionalAccess",e=>e.getOptions,"call",e=>e()]);return"sentry"!==((0,ee.x)([t,"optionalAccess",e=>e.instrumenter])||"sentry")}class tX{static __initStatic(){this.id="Apollo"}constructor(e={useNestjs:!1}){this.name=tX.id,this._useNest=!!e.useNestjs}loadDependency(){return this._useNest?this._module=this._module||(0,tS.$y)("@nestjs/graphql"):this._module=this._module||(0,tS.$y)("apollo-server-core"),this._module}setupOnce(e,t){if(!tH(t)){if(this._useNest){let e=this.loadDependency();e&&(0,C.hl)(e.GraphQLFactory.prototype,"mergeWithSchema",function(e){return function(...n){return(0,C.hl)(this.resolversExplorerService,"explore",function(e){return function(){return tY((0,B.lE)(e.call(this)),t)}}),e.call(this,...n)}})}else{let e=this.loadDependency();if(!e)return;(0,C.hl)(e.ApolloServerBase.prototype,"constructSchema",function(e){return function(){if(!this.config.resolvers)return e.call(this);let n=(0,B.lE)(this.config.resolvers);return this.config.resolvers=tY(n,t),e.call(this)}})}}}}function tY(e,t){return e.map(e=>(Object.keys(e).forEach(n=>{Object.keys(e[n]).forEach(i=>{if("function"==typeof e[n][i])(0,C.hl)(e[n],i,function(e){return function(...g){let o=t().getScope().getSpan(),r=(0,ee.x)([o,"optionalAccess",e=>e.startChild,"call",e=>e({description:`${n}.${i}`,op:"graphql.resolve",origin:"auto.graphql.apollo"})]),l=e.call(this,...g);return(0,X.J8)(l)?l.then(e=>((0,ee.x)([r,"optionalAccess",e=>e.end,"call",e=>e()]),e)):((0,ee.x)([r,"optionalAccess",e=>e.end,"call",e=>e()]),l)}})})}),e))}tX.__initStatic();var tf=n(5200);class tN{static __initStatic(){this.id="Express"}constructor(e={}){this.name=tN.id,this._router=e.router||e.app,this._methods=(Array.isArray(e.methods)?e.methods:[]).concat("use")}setupOnce(e,t){this._router&&(tH(t)||(function(e,t=[]){t.forEach(t=>(function(e,t){let n=e[t];return e[t]=function(...e){return n.call(this,...e.map(e=>"function"==typeof e?tF(e,t):Array.isArray(e)?e.map(e=>"function"==typeof e?tF(e,t):e):e))},e})(e,t))}(this._router,this._methods),function(e){let t="settings"in e;t&&void 0===e._router&&e.lazyrouter&&e.lazyrouter();let n=t?e._router:e;if(!n)return;let i=Object.getPrototypeOf(n),g=i.process_params;i.process_params=function(e,t,n,i,o){n._reconstructedRoute||(n._reconstructedRoute="");let{layerRoutePath:r,isRegex:l,isArray:s,numExtraSegments:a}=function(e){var t;let n=(0,ee.x)([e,"access",e=>e.route,"optionalAccess",e=>e.path]),i=(0,X.Kj)(n),g=Array.isArray(n);if(!n){let[t]=O.GLOBAL_OBJ.process.versions.node.split(".").map(Number);t>=16&&(n=tK(e.path,e.regexp,e.keys))}if(!n)return{isRegex:i,isArray:g,numExtraSegments:0};let o=g?Math.max(n.reduce((e,t)=>e+(0,tn.$A)(t.toString()),0)-(0,tn.$A)(e.path||""),0):0;return{layerRoutePath:(t=n,g?t.map(e=>e.toString()).join(","):t&&t.toString()),isRegex:i,isArray:g,numExtraSegments:o}}(e);(r||l||s)&&(n._hasParameters=!0);let c=(r||function(e,t,n){let i=(0,tn.rt)(e||""),g=(0,ee.x)([i,"optionalAccess",e=>e.split,"call",e=>e("/"),"access",e=>e.filter,"call",e=>e(e=>!!e)]),o=0,r=(0,ee.x)([t,"optionalAccess",e=>e.split,"call",e=>e("/"),"access",e=>e.filter,"call",e=>e(e=>!!e),"access",e=>e.length])||0;return(0,ee.x)([n,"optionalAccess",e=>e.split,"call",e=>e("/"),"access",e=>e.filter,"call",e=>e(e=>(0,ee.x)([g,"optionalAccess",e=>e[r+o]])===e&&(o+=1,!0)),"access",e=>e.join,"call",e=>e("/")])}(n.originalUrl,n._reconstructedRoute,e.path)||"").split("/").filter(e=>e.length>0&&(l||s||!e.includes("*"))).join("/");if(c&&c.length>0&&(n._reconstructedRoute+=`/${c}${l?"/":""}`),(0,tn.$A)((0,tn.rt)(n.originalUrl||""))+a===(0,tn.$A)(n._reconstructedRoute)){n._hasParameters||n._reconstructedRoute===n.originalUrl||(n._reconstructedRoute=n.originalUrl?(0,tn.rt)(n.originalUrl):n.originalUrl);let e=i.__sentry_transaction,t=e&&(0,eo.XU)(e).data||{};if(e&&"custom"!==t[tf.Zj]){let t=n._reconstructedRoute||"/",[i,g]=(0,e$.oA)(n,{path:!0,method:!0,customRoute:t});e.updateName(i),e.setAttribute(tf.Zj,g)}}return g.call(this,e,t,n,i,o)}}(this._router)))}}function tF(e,t){let n=e.length;switch(n){case 2:return function(n,i){let g=i.__sentry_transaction;if(g){let n=g.startChild({description:e.name,op:`middleware.express.${t}`,origin:"auto.middleware.express"});i.once("finish",()=>{n.end()})}return e.call(this,n,i)};case 3:return function(n,i,g){let o=i.__sentry_transaction,r=(0,ee.x)([o,"optionalAccess",e=>e.startChild,"call",n=>n({description:e.name,op:`middleware.express.${t}`,origin:"auto.middleware.express"})]);e.call(this,n,i,function(...e){(0,ee.x)([r,"optionalAccess",e=>e.end,"call",e=>e()]),g.call(this,...e)})};case 4:return function(n,i,g,o){let r=g.__sentry_transaction,l=(0,ee.x)([r,"optionalAccess",e=>e.startChild,"call",n=>n({description:e.name,op:`middleware.express.${t}`,origin:"auto.middleware.express"})]);e.call(this,n,i,g,function(...e){(0,ee.x)([l,"optionalAccess",e=>e.end,"call",e=>e()]),o.call(this,...e)})};default:throw Error(`Express middleware takes 2-4 arguments. Got: ${n}`)}}tN.__initStatic();let tK=(e,t,n)=>{if(!e||!t||!n||0===Object.keys(n).length||!(0,ee.x)([n,"access",e=>e[0],"optionalAccess",e=>e.offset]))return;let i=n.sort((e,t)=>e.offset-t.offset),g=RegExp(t,`${t.flags}d`).exec(e);if(!g||!g.indices)return;let[,...o]=g.indices;if(o.length!==i.length)return;let r=e,l=0;return o.forEach((e,t)=>{if(e){let[n,g]=e,o=r.substring(0,n-l),s=`:${i[t].name}`;r=o+s+r.substring(g-l),l+=g-n-s.length}}),r};class t_{static __initStatic(){this.id="GraphQL"}constructor(){this.name=t_.id}loadDependency(){return this._module=this._module||(0,tS.$y)("graphql/execution/execute.js")}setupOnce(e,t){if(tH(t))return;let n=this.loadDependency();n&&(0,C.hl)(n,"execute",function(e){return function(...n){let i=t().getScope(),g=i.getSpan(),o=(0,ee.x)([g,"optionalAccess",e=>e.startChild,"call",e=>e({description:"execute",op:"graphql.execute",origin:"auto.graphql.graphql"})]);(0,ee.x)([i,"optionalAccess",e=>e.setSpan,"call",e=>e(o)]);let r=e.call(this,...n);return(0,X.J8)(r)?r.then(e=>((0,ee.x)([o,"optionalAccess",e=>e.end,"call",e=>e()]),(0,ee.x)([i,"optionalAccess",e=>e.setSpan,"call",e=>e(g)]),e)):((0,ee.x)([o,"optionalAccess",e=>e.end,"call",e=>e()]),(0,ee.x)([i,"optionalAccess",e=>e.setSpan,"call",e=>e(g)]),r)}})}}t_.__initStatic();let tJ=["aggregate","bulkWrite","countDocuments","createIndex","createIndexes","deleteMany","deleteOne","distinct","drop","dropIndex","dropIndexes","estimatedDocumentCount","find","findOne","findOneAndDelete","findOneAndReplace","findOneAndUpdate","indexes","indexExists","indexInformation","initializeOrderedBulkOp","insertMany","insertOne","isCapped","mapReduce","options","parallelCollectionScan","rename","replaceOne","stats","updateMany","updateOne"],tw={bulkWrite:["operations"],countDocuments:["query"],createIndex:["fieldOrSpec"],createIndexes:["indexSpecs"],deleteMany:["filter"],deleteOne:["filter"],distinct:["key","query"],dropIndex:["indexName"],find:["query"],findOne:["query"],findOneAndDelete:["filter"],findOneAndReplace:["filter","replacement"],findOneAndUpdate:["filter","update"],indexExists:["indexes"],insertMany:["docs"],insertOne:["doc"],mapReduce:["map","reduce"],rename:["newName"],replaceOne:["filter","doc"],updateMany:["filter","update"],updateOne:["filter","update"]};class tx{static __initStatic(){this.id="Mongo"}constructor(e={}){this.name=tx.id,this._operations=Array.isArray(e.operations)?e.operations:tJ,this._describeOperations=!("describeOperations"in e)||e.describeOperations,this._useMongoose=!!e.useMongoose}loadDependency(){let e=this._useMongoose?"mongoose":"mongodb";return this._module=this._module||(0,tS.$y)(e)}setupOnce(e,t){if(tH(t))return;let n=this.loadDependency();if(!n){this._useMongoose;return}this._instrumentOperations(n.Collection,this._operations,t)}_instrumentOperations(e,t,n){t.forEach(t=>this._patchOperation(e,t,n))}_patchOperation(e,t,n){if(!(t in e.prototype))return;let i=this._getSpanContextFromOperationArguments.bind(this);(0,C.hl)(e.prototype,t,function(e){return function(...g){let o=g[g.length-1],r=n(),l=r.getScope(),s=r.getClient(),a=l.getSpan(),c=(0,ee.x)([s,"optionalAccess",e=>e.getOptions,"call",e=>e(),"access",e=>e.sendDefaultPii]);if("function"!=typeof o||"mapReduce"===t&&2===g.length){let n=(0,ee.x)([a,"optionalAccess",e=>e.startChild,"call",e=>e(i(this,t,g,c))]),o=e.call(this,...g);if((0,X.J8)(o))return o.then(e=>((0,ee.x)([n,"optionalAccess",e=>e.end,"call",e=>e()]),e));if(!o||"object"!=typeof o||!o.once||"function"!=typeof o.once)return(0,ee.x)([n,"optionalAccess",e=>e.end,"call",e=>e()]),o;try{o.once("close",()=>{(0,ee.x)([n,"optionalAccess",e=>e.end,"call",e=>e()])})}catch(e){(0,ee.x)([n,"optionalAccess",e=>e.end,"call",e=>e()])}return o}let I=(0,ee.x)([a,"optionalAccess",e=>e.startChild,"call",e=>e(i(this,t,g.slice(0,-1)))]);return e.call(this,...g.slice(0,-1),function(e,t){(0,ee.x)([I,"optionalAccess",e=>e.end,"call",e=>e()]),o(e,t)})}})}_getSpanContextFromOperationArguments(e,t,n,i=!1){let g={"db.system":"mongodb","db.name":e.dbName,"db.operation":t,"db.mongodb.collection":e.collectionName},o={op:"db",origin:"auto.db.mongo",description:t,data:g},r=tw[t],l=Array.isArray(this._describeOperations)?this._describeOperations.includes(t):this._describeOperations;if(!r||!l||!i)return o;try{if("mapReduce"===t){let[e,t]=n;g[r[0]]="string"==typeof e?e:e.name||"<anonymous>",g[r[1]]="string"==typeof t?t:t.name||"<anonymous>"}else for(let e=0;e<r.length;e++)g[`db.mongodb.${r[e]}`]=JSON.stringify(n[e])}catch(e){}return o}}tx.__initStatic();class tE{static __initStatic(){this.id="Mysql"}constructor(){this.name=tE.id}loadDependency(){return this._module=this._module||(0,tS.$y)("mysql/lib/Connection.js")}setupOnce(e,t){let n;if(tH(t))return;let i=this.loadDependency();if(i){try{i.prototype.connect=new Proxy(i.prototype.connect,{apply:(e,t,i)=>(n||(n=t.config),e.apply(t,i))})}catch(e){}(0,C.hl)(i,"createQuery",function(e){return function(n,i,o){let r=t().getScope().getSpan(),l=(0,ee.x)([r,"optionalAccess",e=>e.startChild,"call",e=>e({description:"string"==typeof n?n:n.sql,op:"db",origin:"auto.db.mysql",data:{"db.system":"mysql"}})]);if("function"==typeof o)return e.call(this,n,i,function(e,t,n){g(l),o(e,t,n)});if("function"==typeof i)return e.call(this,n,function(e,t,n){g(l),i(e,t,n)});let s=e.call(this,n,i);return s.on("end",()=>{g(l)}),s}})}function g(e){if(!e)return;let t=n?{"server.address":n.host,"server.port":n.port,"db.user":n.user}:{};Object.keys(t).forEach(n=>{e.setAttribute(n,t[n])}),e.end()}}}tE.__initStatic();class tk{static __initStatic(){this.id="Postgres"}constructor(e={}){this.name=tk.id,this._usePgNative=!!e.usePgNative,this._module=e.module}loadDependency(){return this._module=this._module||(0,tS.$y)("pg")}setupOnce(e,t){if(tH(t))return;let n=this.loadDependency();if(!n)return;let i=this._usePgNative?(0,ee.x)([n,"access",e=>e.native,"optionalAccess",e=>e.Client]):n.Client;i&&(0,C.hl)(i.prototype,"query",function(e){return function(n,i,g){let o=t().getScope().getSpan(),r={"db.system":"postgresql"};try{this.database&&(r["db.name"]=this.database),this.host&&(r["server.address"]=this.host),this.port&&(r["server.port"]=this.port),this.user&&(r["db.user"]=this.user)}catch(e){}let l=(0,ee.x)([o,"optionalAccess",e=>e.startChild,"call",e=>e({description:"string"==typeof n?n:n.text,op:"db",origin:"auto.db.postgres",data:r})]);if("function"==typeof g)return e.call(this,n,i,function(e,t){(0,ee.x)([l,"optionalAccess",e=>e.end,"call",e=>e()]),g(e,t)});if("function"==typeof i)return e.call(this,n,function(e,t){(0,ee.x)([l,"optionalAccess",e=>e.end,"call",e=>e()]),i(e,t)});let s=void 0!==i?e.call(this,n,i):e.call(this,n);return(0,X.J8)(s)?s.then(e=>((0,ee.x)([l,"optionalAccess",e=>e.end,"call",e=>e()]),e)):((0,ee.x)([l,"optionalAccess",e=>e.end,"call",e=>e()]),s)}})}}tk.__initStatic();class tU{static __initStatic(){this.id="Prisma"}constructor(e={}){if(this.name=tU.id,function(e){return!!e&&!!e.$use}(e.client)&&!e.client._sentryInstrumented){(0,C.xp)(e.client,"_sentryInstrumented",!0);let t={};try{let n=e.client._engineConfig;if(n){let{activeProvider:e,clientVersion:i}=n;e&&(t["db.system"]=e),i&&(t["db.prisma.version"]=i)}}catch(e){}e.client.$use((e,n)=>{if(tH(et.Gd))return n(e);let i=e.action,g=e.model;return(0,eg.GK)({name:g?`${g} ${i}`:i,onlyIfParent:!0,op:"db.prisma",attributes:{[tf.S3]:"auto.db.prisma"},data:{...t,"db.operation":i}},()=>n(e))})}}setupOnce(){}}tU.__initStatic();L();let tT={...l,...s,...a};var tz=n(1183),tL=n(3639);function tQ(){let e=tL.active;if(e)return(0,et.uZ)(e),(0,et.vi)(e)}function tO(e,t){let n=tL.active;if(n&&(0,ee.x)([t,"optionalAccess",e=>e.reuseExisting]))return e();let i=tL.create(),g=function(e){let t={};return(0,et.uZ)(t,e),(0,et.vi)(t)}(n?(0,et.vi)(n):void 0);return(0,et.j0)(i,g),i.bind(()=>e())()}var tM=n(852),tj=n(6199);class tP extends Error{constructor(e,t="warn"){super(e),this.message=e,this.name=new.target.prototype.constructor.name,Object.setPrototypeOf(this,new.target.prototype),this.logLevel=t}}let tD=/[^a-zA-Z0-9_/.-]+/g,tq=/[^\w\d\s_:/@.{}[\]$-]+/g;var t$=n(9321),t0=n(4214);let t2="Not capturing exception because it's already been captured.";class t9{constructor(e){if(this._options=e,this._integrations={},this._integrationsInitialized=!1,this._numProcessing=0,this._outcomes={},this._hooks={},this._eventProcessors=[],e.dsn?this._dsn=function(e){let t="string"==typeof e?function(e){let t=tl.exec(e);if(!t){(0,G.Cf)(()=>{console.error(`Invalid Sentry Dsn: ${e}`)});return}let[n,i,g="",o,r="",l]=t.slice(1),s="",a=l,c=a.split("/");if(c.length>1&&(s=c.slice(0,-1).join("/"),a=c.pop()),a){let e=a.match(/^\d+/);e&&(a=e[0])}return ta({host:o,pass:g,path:s,projectId:a,port:r,protocol:n,publicKey:i})}(e):ta(e);if(t&&function(e){if(!tr.X)return!0;let{port:t,projectId:n,protocol:i}=e;return!["protocol","publicKey","host","projectId"].find(t=>!e[t]&&(G.kg.error(`Invalid Sentry Dsn: ${t} missing`),!0))&&(n.match(/^\d+$/)?"http"===i||"https"===i?!(t&&isNaN(parseInt(t,10)))||(G.kg.error(`Invalid Sentry Dsn: Invalid port ${t}`),!1):(G.kg.error(`Invalid Sentry Dsn: Invalid protocol ${i}`),!1):(G.kg.error(`Invalid Sentry Dsn: Invalid projectId ${n}`),!1))}(t))return t}(e.dsn):y.X&&G.kg.warn("No DSN provided, client will not send events."),this._dsn){let t=function(e,t={}){let n="string"==typeof t?t:t.tunnel,i="string"!=typeof t&&t._metadata?t._metadata.sdk:void 0;return n||`${function(e){let t=e.protocol?`${e.protocol}:`:"",n=e.port?`:${e.port}`:"";return`${t}//${e.host}${n}${e.path?`/${e.path}`:""}/api/`}(e)}${e.projectId}/envelope/?${(0,C._j)({sentry_key:e.publicKey,sentry_version:"7",...i&&{sentry_client:`${i.name}/${i.version}`}})}`}(this._dsn,e);this._transport=e.transport({recordDroppedEvent:this.recordDroppedEvent.bind(this),...e.transportOptions,url:t})}}captureException(e,t,n){if((0,B.YO)(e)){y.X&&G.kg.log(t2);return}let i=t&&t.event_id;return this._process(this.eventFromException(e,t).then(e=>this._captureEvent(e,t,n)).then(e=>{i=e})),i}captureMessage(e,t,n,i){let g=n&&n.event_id,o=(0,X.Le)(e)?e:String(e),r=(0,X.pt)(e)?this.eventFromMessage(o,t,n):this.eventFromException(e,n);return this._process(r.then(e=>this._captureEvent(e,n,i)).then(e=>{g=e})),g}captureEvent(e,t,n){if(t&&t.originalException&&(0,B.YO)(t.originalException)){y.X&&G.kg.log(t2);return}let i=t&&t.event_id,g=(e.sdkProcessingMetadata||{}).capturedSpanScope;return this._process(this._captureEvent(e,t,g||n).then(e=>{i=e})),i}captureSession(e){"string"!=typeof e.release?y.X&&G.kg.warn("Discarded session because of missing or non-string release"):(this.sendSession(e),(0,t$.CT)(e,{init:!1}))}getDsn(){return this._dsn}getOptions(){return this._options}getSdkMetadata(){return this._options._metadata}getTransport(){return this._transport}flush(e){let t=this._transport;return t?(this.metricsAggregator&&this.metricsAggregator.flush(),this._isClientDoneProcessing(e).then(n=>t.flush(e).then(e=>n&&e))):(0,tj.WD)(!0)}close(e){return this.flush(e).then(e=>(this.getOptions().enabled=!1,this.metricsAggregator&&this.metricsAggregator.close(),e))}getEventProcessors(){return this._eventProcessors}addEventProcessor(e){this._eventProcessors.push(e)}setupIntegrations(e){(e&&!this._integrationsInitialized||this._isEnabled()&&!this._integrationsInitialized)&&this._setupIntegrations()}init(){this._isEnabled()&&this._setupIntegrations()}getIntegrationById(e){return this.getIntegrationByName(e)}getIntegrationByName(e){return this._integrations[e]}getIntegration(e){try{return this._integrations[e.id]||null}catch(t){return y.X&&G.kg.warn(`Cannot retrieve integration ${e.id} from the current Client`),null}}addIntegration(e){let t=this._integrations[e.name];(0,b.m7)(this,e,this._integrations),t||(0,b.uf)(this,[e])}sendEvent(e,t={}){this.emit("beforeSendEvent",e,t);let n=function(e,t,n,i){var g;let o=tb(n),r=e.type&&"replay_event"!==e.type?e.type:"event";(g=n&&n.sdk)&&(e.sdk=e.sdk||{},e.sdk.name=e.sdk.name||g.name,e.sdk.version=e.sdk.version||g.version,e.sdk.integrations=[...e.sdk.integrations||[],...g.integrations||[]],e.sdk.packages=[...e.sdk.packages||[],...g.packages||[]]);let l=function(e,t,n,i){let g=e.sdkProcessingMetadata&&e.sdkProcessingMetadata.dynamicSamplingContext;return{event_id:e.event_id,sent_at:new Date().toISOString(),...t&&{sdk:t},...!!n&&i&&{dsn:ts(i)},...g&&{trace:(0,C.Jr)({...g})}}}(e,o,i,t);return delete e.sdkProcessingMetadata,tc(l,[[{type:r},e]])}(e,this._dsn,this._options._metadata,this._options.tunnel);for(let e of t.attachments||[])n=function(e,t){let[n,i]=e;return[n,[...i,t]]}(n,function(e,t){let n="string"==typeof e.data?td(e.data,t):e.data;return[(0,C.Jr)({type:"attachment",length:n.length,filename:e.filename,content_type:e.contentType,attachment_type:e.attachmentType}),n]}(e,this._options.transportOptions&&this._options.transportOptions.textEncoder));let i=this._sendEnvelope(n);i&&i.then(t=>this.emit("afterSendEvent",e,t),null)}sendSession(e){let t=function(e,t,n,i){let g=tb(n);return tc({sent_at:new Date().toISOString(),...g&&{sdk:g},...!!i&&t&&{dsn:ts(t)}},["aggregates"in e?[{type:"sessions"},e]:[{type:"session"},e.toJSON()]])}(e,this._dsn,this._options._metadata,this._options.tunnel);this._sendEnvelope(t)}recordDroppedEvent(e,t,n){if(this._options.sendClientReports){let n=`${e}:${t}`;y.X&&G.kg.log(`Adding outcome: "${n}"`),this._outcomes[n]=this._outcomes[n]+1||1}}captureAggregateMetrics(e){y.X&&G.kg.log(`Flushing aggregated metrics, number of metrics: ${e.length}`);let t=function(e,t,n,i){let g={sent_at:new Date().toISOString()};return n&&n.sdk&&(g.sdk={name:n.sdk.name,version:n.sdk.version}),i&&t&&(g.dsn=ts(t)),tc(g,[function(e){let t=function(e){let t="";for(let n of e){let e=Object.entries(n.tags),i=e.length>0?`|#${e.map(([e,t])=>`${e}:${t}`).join(",")}`:"";t+=`${n.name}@${n.unit}:${n.metric}|${n.metricType}${i}|T${n.timestamp}
`}return t}(e);return[{type:"statsd",length:t.length},t]}(e)])}(e,this._dsn,this._options._metadata,this._options.tunnel);this._sendEnvelope(t)}on(e,t){this._hooks[e]||(this._hooks[e]=[]),this._hooks[e].push(t)}emit(e,...t){this._hooks[e]&&this._hooks[e].forEach(e=>e(...t))}_setupIntegrations(){let{integrations:e}=this._options;this._integrations=(0,b.q4)(this,e),(0,b.uf)(this,e),this._integrationsInitialized=!0}_updateSessionFromEvent(e,t){let n=!1,i=!1,g=t.exception&&t.exception.values;if(g)for(let e of(i=!0,g)){let t=e.mechanism;if(t&&!1===t.handled){n=!0;break}}let o="ok"===e.status;(o&&0===e.errors||o&&n)&&((0,t$.CT)(e,{...n&&{status:"crashed"},errors:e.errors||Number(i||n)}),this.captureSession(e))}_isClientDoneProcessing(e){return new tj.cW(t=>{let n=0,i=setInterval(()=>{0==this._numProcessing?(clearInterval(i),t(!0)):(n+=1,e&&n>=e&&(clearInterval(i),t(!1)))},1)})}_isEnabled(){return!1!==this.getOptions().enabled&&void 0!==this._transport}_prepareEvent(e,t,n,i=(0,et.aF)()){let g=this.getOptions(),o=Object.keys(this._integrations);return!t.integrations&&o.length>0&&(t.integrations=o),this.emit("preprocessEvent",e,t),(0,t0.R)(g,e,t,n,this,i).then(e=>{if(null===e)return e;let t={...i.getPropagationContext(),...n?n.getPropagationContext():void 0};if(!(e.contexts&&e.contexts.trace)&&t){let{traceId:i,spanId:g,parentSpanId:o,dsc:r}=t;e.contexts={trace:{trace_id:i,span_id:g,parent_span_id:o},...e.contexts};let l=r||(0,er._)(i,this,n);e.sdkProcessingMetadata={dynamicSamplingContext:l,...e.sdkProcessingMetadata}}return e})}_captureEvent(e,t={},n){return this._processEvent(e,t,n).then(e=>e.event_id,e=>{y.X&&("log"===e.logLevel?G.kg.log(e.message):G.kg.warn(e))})}_processEvent(e,t,n){let i=this.getOptions(),{sampleRate:g}=i,o=t1(e),r=t5(e),l=e.type||"error",s=`before send for type \`${l}\``;if(r&&"number"==typeof g&&Math.random()>g)return this.recordDroppedEvent("sample_rate","error",e),(0,tj.$2)(new tP(`Discarding event because it's not included in the random sample (sampling rate = ${g})`,"log"));let a="replay_event"===l?"replay":l,c=(e.sdkProcessingMetadata||{}).capturedSpanIsolationScope;return this._prepareEvent(e,t,n,c).then(n=>{if(null===n)throw this.recordDroppedEvent("event_processor",a,e),new tP("An event processor returned `null`, will not send event.","log");return t.data&&!0===t.data.__sentry__?n:function(e,t){let n=`${t} must return \`null\` or a valid event.`;if((0,X.J8)(e))return e.then(e=>{if(!(0,X.PO)(e)&&null!==e)throw new tP(n);return e},e=>{throw new tP(`${t} rejected with ${e}`)});if(!(0,X.PO)(e)&&null!==e)throw new tP(n);return e}(function(e,t,n){let{beforeSend:i,beforeSendTransaction:g}=e;return t5(t)&&i?i(t,n):t1(t)&&g?g(t,n):t}(i,n,t),s)}).then(i=>{if(null===i)throw this.recordDroppedEvent("before_send",a,e),new tP(`${s} returned \`null\`, will not send event.`,"log");let g=n&&n.getSession();!o&&g&&this._updateSessionFromEvent(g,i);let r=i.transaction_info;return o&&r&&i.transaction!==e.transaction&&(i.transaction_info={...r,source:"custom"}),this.sendEvent(i,t),i}).then(null,e=>{if(e instanceof tP)throw e;throw this.captureException(e,{data:{__sentry__:!0},originalException:e}),new tP(`Event processing pipeline threw an error, original event will not be sent. Details have been sent as a new event.
Reason: ${e}`)})}_process(e){this._numProcessing++,e.then(e=>(this._numProcessing--,e),e=>(this._numProcessing--,e))}_sendEnvelope(e){if(this.emit("beforeEnvelope",e),this._isEnabled()&&this._transport)return this._transport.send(e).then(null,e=>{y.X&&G.kg.error("Error while sending event:",e)});y.X&&G.kg.error("Transport disabled")}_clearOutcomes(){let e=this._outcomes;return this._outcomes={},Object.keys(e).map(t=>{let[n,i]=t.split(":");return{reason:n,category:i,quantity:e[t]}})}}function t5(e){return void 0===e.type}function t1(e){return"transaction"===e.type}var t3=n(9463);class t4{constructor(e){this._value=e}get weight(){return 1}add(e){this._value+=e}toString(){return`${this._value}`}}class t8{constructor(e){this._last=e,this._min=e,this._max=e,this._sum=e,this._count=1}get weight(){return 5}add(e){this._last=e,e<this._min&&(this._min=e),e>this._max&&(this._max=e),this._sum+=e,this._count++}toString(){return`${this._last}:${this._min}:${this._max}:${this._sum}:${this._count}`}}class t7{constructor(e){this._value=[e]}get weight(){return this._value.length}add(e){this._value.push(e)}toString(){return this._value.join(":")}}class t6{constructor(e){this.first=e,this._value=new Set([e])}get weight(){return this._value.size}add(e){this._value.add(e)}toString(){return Array.from(this._value).map(e=>"string"==typeof e?function(e){let t=0;for(let n=0;n<e.length;n++)t=(t<<5)-t+e.charCodeAt(n),t&=t;return t>>>0}(e):e).join(":")}}let ne={c:t4,g:t8,d:t7,s:t6};var nt=n(5045);class nn{constructor(e){this._client=e,this._buckets=new Map,this._bucketsTotalWeight=0,this._interval=setInterval(()=>this._flush(),1e4),this._flushShift=Math.floor(1e4*Math.random()/1e3),this._forceFlush=!1}add(e,t,n,i="none",g={},o=(0,t3.ph)()){let r=Math.floor(o),l=t.replace(tD,"_"),s=function(e){let t={};for(let n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n.replace(tD,"_")]=String(e[n]).replace(tq,""));return t}(g),a=function(e,t,n,i){let g=Object.entries((0,C.Jr)(i)).sort((e,t)=>e[0].localeCompare(t[0]));return`${e}${t}${n}${g}`}(e,l,i,s),c=this._buckets.get(a),I=c&&"s"===e?c.metric.weight:0;c?(c.metric.add(n),c.timestamp<r&&(c.timestamp=r)):(c={metric:new ne[e](n),timestamp:r,metricType:e,name:l,unit:i,tags:s},this._buckets.set(a,c));let d="string"==typeof n?c.metric.weight-I:n;(0,nt.v)(e,l,d,i,g,a),this._bucketsTotalWeight+=c.metric.weight,this._bucketsTotalWeight>=1e4&&this.flush()}flush(){this._forceFlush=!0,this._flush()}close(){this._forceFlush=!0,clearInterval(this._interval),this._flush()}_flush(){if(this._forceFlush){this._forceFlush=!1,this._bucketsTotalWeight=0,this._captureMetrics(this._buckets),this._buckets.clear();return}let e=Math.floor((0,t3.ph)())-10-this._flushShift,t=new Map;for(let[n,i]of this._buckets)i.timestamp<=e&&(t.set(n,i),this._bucketsTotalWeight-=i.metric.weight);for(let[e]of t)this._buckets.delete(e);this._captureMetrics(t)}_captureMetrics(e){if(e.size>0&&this._client.captureAggregateMetrics){let t=Array.from(e).map(([,e])=>e);this._client.captureAggregateMetrics(t)}}}class ni{constructor(e,t){this._client=e,this.flushTimeout=60,this._pendingAggregates={},this._isEnabled=!0,this._intervalId=setInterval(()=>this.flush(),1e3*this.flushTimeout),this._sessionAttrs=t}flush(){let e=this.getSessionAggregates();0!==e.aggregates.length&&(this._pendingAggregates={},this._client.sendSession(e))}getSessionAggregates(){let e=Object.keys(this._pendingAggregates).map(e=>this._pendingAggregates[parseInt(e)]),t={attrs:this._sessionAttrs,aggregates:e};return(0,C.Jr)(t)}close(){clearInterval(this._intervalId),this._isEnabled=!1,this.flush()}incrementSessionStatusCount(){if(!this._isEnabled)return;let e=(0,u.nZ)(),t=e.getRequestSession();t&&t.status&&(this._incrementSessionStatusCount(t.status,new Date),e.setRequestSession(void 0))}_incrementSessionStatusCount(e,t){let n=new Date(t).setSeconds(0,0);this._pendingAggregates[n]=this._pendingAggregates[n]||{};let i=this._pendingAggregates[n];switch(i.started||(i.started=new Date(n).toISOString()),e){case"errored":return i.errored=(i.errored||0)+1,i.errored;case"ok":return i.exited=(i.exited||0)+1,i.exited;default:return i.crashed=(i.crashed||0)+1,i.crashed}}}var ng=n(9972);class no extends t9{constructor(e){(0,c.T)(),super(e),e._experiments&&e._experiments.metricsAggregator&&(this.metricsAggregator=new nn(this))}eventFromException(e,t){return(0,tj.WD)(function(e,t,n,i){let g;let o="function"==typeof e?e().getClient():e,r=n,l=i&&i.data&&i.data.mechanism||{handled:!0,type:"generic"};if(!(0,X.VZ)(n)){if((0,X.PO)(n)){let e=o&&o.getOptions().normalizeDepth;g={__serialized__:(0,N.Qy)(n,e)};let t=function(e){if("name"in e&&"string"==typeof e.name){let t=`'${e.name}' captured as exception`;return"message"in e&&"string"==typeof e.message&&(t+=` with message '${e.message}'`),t}return"message"in e&&"string"==typeof e.message?e.message:`Object captured as exception with keys: ${(0,C.zf)(e)}`}(n);(r=i&&i.syntheticException||Error(t)).message=t}else(r=i&&i.syntheticException||Error(n)).message=n;l.synthetic=!0}let s={exception:{values:[K(t,r)]}};return g&&(s.extra=g),(0,B.Db)(s,void 0,void 0),(0,B.EG)(s,l),{...s,event_id:i&&i.event_id}}((0,u.s3)(),this._options.stackParser,e,t))}eventFromMessage(e,t="info",n){return(0,tj.WD)(function(e,t,n="info",i,g){let o={event_id:i&&i.event_id,level:n};if(g&&i&&i.syntheticException){let n=F(e,i.syntheticException);n.length&&(o.exception={values:[{value:t,stacktrace:{frames:n}}]})}if((0,X.Le)(t)){let{__sentry_template_string__:e,__sentry_template_values__:n}=t;return o.logentry={message:e,params:n},o}return o.message=t,o}(this._options.stackParser,e,t,n,this._options.attachStacktrace))}captureException(e,t,n){if(this._options.autoSessionTracking&&this._sessionFlusher&&n){let e=n.getRequestSession();e&&"ok"===e.status&&(e.status="errored")}return super.captureException(e,t,n)}captureEvent(e,t,n){if(this._options.autoSessionTracking&&this._sessionFlusher&&n&&"exception"===(e.type||"exception")&&e.exception&&e.exception.values&&e.exception.values.length>0){let e=n.getRequestSession();e&&"ok"===e.status&&(e.status="errored")}return super.captureEvent(e,t,n)}close(e){return this._sessionFlusher&&this._sessionFlusher.close(),super.close(e)}initSessionFlusher(){let{release:e,environment:t}=this._options;e?this._sessionFlusher=new ni(this,{release:e,environment:t}):y.X&&G.kg.warn("Cannot initialise an instance of SessionFlusher if no release is provided!")}captureCheckIn(e,t,n){let i="checkInId"in e&&e.checkInId?e.checkInId:(0,B.DM)();if(!this._isEnabled())return y.X&&G.kg.warn("SDK not enabled, will not capture checkin."),i;let{release:g,environment:o,tunnel:r}=this.getOptions(),l={check_in_id:i,monitor_slug:e.monitorSlug,status:e.status,release:g,environment:o};"duration"in e&&(l.duration=e.duration),t&&(l.monitor_config={schedule:t.schedule,checkin_margin:t.checkinMargin,max_runtime:t.maxRuntime,timezone:t.timezone});let[s,a]=this._getTraceInfoFromScope(n);a&&(l.contexts={trace:a});let c=function(e,t,n,i,g){let o={sent_at:new Date().toISOString()};return n&&n.sdk&&(o.sdk={name:n.sdk.name,version:n.sdk.version}),i&&g&&(o.dsn=ts(g)),t&&(o.trace=(0,C.Jr)(t)),tc(o,[[{type:"check_in"},e]])}(l,s,this.getSdkMetadata(),r,this.getDsn());return y.X&&G.kg.info("Sending checkin:",e.monitorSlug,e.status),this._sendEnvelope(c),i}_captureRequestSession(){this._sessionFlusher?this._sessionFlusher.incrementSessionStatusCount():y.X&&G.kg.warn("Discarded request mode session because autoSessionTracking option was disabled")}_prepareEvent(e,t,n,i){return this._options.platform&&(e.platform=e.platform||this._options.platform),this._options.runtime&&(e.contexts={...e.contexts,runtime:(e.contexts||{}).runtime||this._options.runtime}),this._options.serverName&&(e.server_name=e.server_name||this._options.serverName),super._prepareEvent(e,t,n,i)}_getTraceInfoFromScope(e){if(!e)return[void 0,void 0];let t=e.getSpan();if(t)return[(0,ng.G)(t)?(0,er.j)(t):void 0,(0,eo.wy)(t)];let{traceId:n,spanId:i,parentSpanId:g,dsc:o}=e.getPropagationContext(),r={trace_id:n,span_id:i,parent_span_id:g};return o?[o,r]:[(0,er._)(n,this,e),r]}}class nr extends no{constructor(e){d(e,"node"),e.transportOptions={textEncoder:new Q.TextEncoder,...e.transportOptions},super({...e,platform:"node",runtime:{name:"node",version:global.process.version},serverName:e.serverName||global.process.env.SENTRY_NAME||ex.hostname()})}}var nl=n(6915),ns=n(5687),na=n(2781),nc=n(5206);function nI(e,t,n=function(e){let t=[];function n(e){return t.splice(t.indexOf(e),1)[0]}return{$:t,add:function(i){if(!(void 0===e||t.length<e))return(0,tj.$2)(new tP("Not adding Promise because buffer limit was reached."));let g=i();return -1===t.indexOf(g)&&t.push(g),g.then(()=>n(g)).then(null,()=>n(g).then(null,()=>{})),g},drain:function(e){return new tj.cW((n,i)=>{let g=t.length;if(!g)return n(!0);let o=setTimeout(()=>{e&&e>0&&n(!1)},e);t.forEach(e=>{(0,tj.WD)(e).then(()=>{--g||(clearTimeout(o),n(!0))},i)})})}}}(e.bufferSize||30)){let i={};function g(g){let o=[];if(tI(g,(t,n)=>{let g=tC[n];if(function(e,t,n=Date.now()){return(e[t]||e.all||0)>n}(i,g)){let i=nd(t,n);e.recordDroppedEvent("ratelimit_backoff",g,i)}else o.push(t)}),0===o.length)return(0,tj.WD)();let r=tc(g[0],o),l=t=>{tI(r,(n,i)=>{let g=nd(n,i);e.recordDroppedEvent(t,tC[i],g)})};return n.add(()=>t({body:tu(r,e.textEncoder)}).then(e=>(void 0!==e.statusCode&&(e.statusCode<200||e.statusCode>=300)&&y.X&&G.kg.warn(`Sentry responded with status code ${e.statusCode} to sent event.`),i=function(e,{statusCode:t,headers:n},i=Date.now()){let g={...e},o=n&&n["x-sentry-rate-limits"],r=n&&n["retry-after"];if(o)for(let e of o.trim().split(",")){let[t,n]=e.split(":",2),o=parseInt(t,10),r=(isNaN(o)?60:o)*1e3;if(n)for(let e of n.split(";"))g[e]=i+r;else g.all=i+r}else r?g.all=i+function(e,t=Date.now()){let n=parseInt(`${e}`,10);if(!isNaN(n))return 1e3*n;let i=Date.parse(`${e}`);return isNaN(i)?6e4:i-t}(r,i):429===t&&(g.all=i+6e4);return g}(i,e),e),e=>{throw l("network_error"),e})).then(e=>e,e=>{if(e instanceof tP)return y.X&&G.kg.error("Skipped sending event because buffer is full."),l("queue_overflow"),(0,tj.WD)();throw e})}return g.__sentry__baseTransport__=!0,{send:g,flush:e=>n.drain(e)}}function nd(e,t){if("event"===t||"transaction"===t)return Array.isArray(e)?e[1]:void 0}var nu=n(9491),nC=n.n(nu),nb=n(1808),np=n(4404);let nm=Symbol("AgentBaseInternalState");class nZ extends to.Agent{constructor(e){super(e),this[nm]={}}isSecureEndpoint(e){if(e){if("boolean"==typeof e.secureEndpoint)return e.secureEndpoint;if("string"==typeof e.protocol)return"https:"===e.protocol}let{stack:t}=Error();return"string"==typeof t&&t.split("\n").some(e=>-1!==e.indexOf("(https.js:")||-1!==e.indexOf("node:https:"))}createSocket(e,t,n){let i={...t,secureEndpoint:this.isSecureEndpoint(t)};Promise.resolve().then(()=>this.connect(e,i)).then(g=>{if(g instanceof to.Agent)return g.addRequest(e,i);this[nm].currentSocket=g,super.createSocket(e,t,n)},n)}createConnection(){let e=this[nm].currentSocket;if(this[nm].currentSocket=void 0,!e)throw Error("No socket was returned in the `connect()` function");return e}get defaultPort(){return(0,nl.h)(this[nm].defaultPort,()=>"https:"===this.protocol?443:80)}set defaultPort(e){this[nm]&&(this[nm].defaultPort=e)}get protocol(){return(0,nl.h)(this[nm].protocol,()=>this.isSecureEndpoint()?"https:":"http:")}set protocol(e){this[nm]&&(this[nm].protocol=e)}}function nh(...e){G.kg.log("[https-proxy-agent:parse-proxy-response]",...e)}function nG(...e){G.kg.log("[https-proxy-agent]",...e)}class nB extends nZ{static __initStatic(){this.protocols=["http","https"]}constructor(e,t){super(t),this.options={},this.proxy="string"==typeof e?new eu.URL(e):e,this.proxyHeaders=(0,nl.h)((0,ee.x)([t,"optionalAccess",e=>e.headers]),()=>({})),nG("Creating new HttpsProxyAgent instance: %o",this.proxy.href);let n=(this.proxy.hostname||this.proxy.host).replace(/^\[|\]$/g,""),i=this.proxy.port?parseInt(this.proxy.port,10):"https:"===this.proxy.protocol?443:80;this.connectOpts={ALPNProtocols:["http/1.1"],...t?ny(t,"headers"):null,host:n,port:i}}async connect(e,t){var n;let i;let{proxy:g}=this;if(!t.host)throw TypeError('No "host" provided');if("https:"===g.protocol){nG("Creating `tls.Socket`: %o",this.connectOpts);let e=this.connectOpts.servername||this.connectOpts.host;i=np.connect({...this.connectOpts,servername:e&&nb.isIP(e)?void 0:e})}else nG("Creating `net.Socket`: %o",this.connectOpts),i=nb.connect(this.connectOpts);let o="function"==typeof this.proxyHeaders?this.proxyHeaders():{...this.proxyHeaders},r=nb.isIPv6(t.host)?`[${t.host}]`:t.host,l=`CONNECT ${r}:${t.port} HTTP/1.1\r
`;if(g.username||g.password){let e=`${decodeURIComponent(g.username)}:${decodeURIComponent(g.password)}`;o["Proxy-Authorization"]=`Basic ${Buffer.from(e).toString("base64")}`}for(let e of(o.Host=`${r}:${t.port}`,o["Proxy-Connection"]||(o["Proxy-Connection"]=this.keepAlive?"Keep-Alive":"close"),Object.keys(o)))l+=`${e}: ${o[e]}\r
`;let s=(n=i,new Promise((e,t)=>{let i=0,g=[];function o(){let l=n.read();l?function(l){g.push(l),i+=l.length;let s=Buffer.concat(g,i),a=s.indexOf("\r\n\r\n");if(-1===a){nh("have not received end of HTTP headers yet..."),o();return}let c=s.slice(0,a).toString("ascii").split("\r\n"),I=c.shift();if(!I)return n.destroy(),t(Error("No header received from proxy CONNECT response"));let d=I.split(" "),u=+d[1],C=d.slice(2).join(" "),b={};for(let e of c){if(!e)continue;let i=e.indexOf(":");if(-1===i)return n.destroy(),t(Error(`Invalid header from proxy CONNECT response: "${e}"`));let g=e.slice(0,i).toLowerCase(),o=e.slice(i+1).trimStart(),r=b[g];"string"==typeof r?b[g]=[r,o]:Array.isArray(r)?r.push(o):b[g]=o}nh("got proxy server response: %o %o",I,b),r(),e({connect:{statusCode:u,statusText:C,headers:b},buffered:s})}(l):n.once("readable",o)}function r(){n.removeListener("end",l),n.removeListener("error",s),n.removeListener("readable",o)}function l(){r(),nh("onend"),t(Error("Proxy connection ended before receiving CONNECT response"))}function s(e){r(),nh("onerror %o",e),t(e)}n.on("error",s),n.on("end",l),o()}));i.write(`${l}\r
`);let{connect:a,buffered:c}=await s;if(e.emit("proxyConnect",a),this.emit("proxyConnect",a,e),200===a.statusCode){if(e.once("socket",nA),t.secureEndpoint){nG("Upgrading socket connection to TLS");let e=t.servername||t.host;return np.connect({...ny(t,"host","path","port"),socket:i,servername:nb.isIP(e)?void 0:e})}return i}i.destroy();let I=new nb.Socket({writable:!1});return I.readable=!0,e.once("socket",e=>{nG("Replaying proxy buffer for failed request"),nC()(e.listenerCount("data")>0),e.push(c),e.push(null)}),I}}function nA(e){e.resume()}function ny(e,...t){let n;let i={};for(n in e)t.includes(n)||(i[n]=e[n]);return i}function nW(e){let t;try{t=new eu.URL(e.url)}catch(t){return(0,G.Cf)(()=>{console.warn("[@sentry/node]: Invalid dsn or tunnel option, will not send any events. The tunnel option must be a full URL when used.")}),nI(e,()=>Promise.resolve({}))}let n="https:"===t.protocol,i=function(e,t){let{no_proxy:n}=process.env;if(!(n&&n.split(",").some(t=>e.host.endsWith(t)||e.hostname.endsWith(t))))return t}(t,e.proxy||(n?process.env.https_proxy:void 0)||process.env.http_proxy),g=n?ns:to,o=void 0!==e.keepAlive&&e.keepAlive,r=i?new nB(i):new g.Agent({keepAlive:o,maxSockets:30,timeout:2e3}),l=function(e,t,n){let{hostname:i,pathname:g,port:o,protocol:r,search:l}=new eu.URL(e.url);return function(s){return new Promise((a,c)=>{var I;let d=(I=s.body,new na.Readable({read(){this.push(I),this.push(null)}})),u={...e.headers};s.body.length>32768&&(u["content-encoding"]="gzip",d=d.pipe((0,nc.createGzip)()));let C=t.request({method:"POST",agent:n,headers:u,hostname:i,path:`${g}${l}`,port:o,protocol:r,ca:e.caCerts},e=>{e.on("data",()=>{}),e.on("end",()=>{}),e.setEncoding("utf8");let t=(0,nl.h)(e.headers["retry-after"],()=>null),n=(0,nl.h)(e.headers["x-sentry-rate-limits"],()=>null);a({statusCode:e.statusCode,headers:{"retry-after":t,"x-sentry-rate-limits":Array.isArray(n)?n[0]:n}})});C.on("error",c),d.pipe(C)})}}(e,(0,nl.h)(e.httpModule,()=>g),r);return nI(e,l)}nB.__initStatic();let nV=[R(),Z(),J(),e9(),q(),eZ(),ti(),ey(),ev(),eF(),te(),eT(),eX()];function nv(e){let t=(0,et.cu)();return[...nV,...(0,ee.x)([t,"access",e=>e.__SENTRY__,"optionalAccess",e=>e.integrations])||[]]}let nR=(0,tz.pE)((0,tz.Ep)(L()));var nS=n(7077),nH=n(7593);function nX(){return process.env.NEXT_PHASE===nH.PHASE_PRODUCTION_BUILD}class nY extends tT.Http{constructor(e){super({...e,tracing:!0})}}class nf extends tT.OnUncaughtException{constructor(e){super({exitEvenIfOtherHandlersAreRegistered:!1,...e})}}let nN="RewriteFrames",nF=(0,b._I)((e={})=>{let t=e.root,n=e.prefix||"app:///",i=e.iteratee||(e=>{if(!e.filename)return e;let i=/^[a-zA-Z]:\\/.test(e.filename)||e.filename.includes("\\")&&!e.filename.includes("/"),g=/^\//.test(e.filename);if(i||g){let g=i?e.filename.replace(/^[a-zA-Z]:/,"").replace(/\\/g,"/"):e.filename,o=t?function(e,t){e=U(e).slice(1),t=U(t).slice(1);let n=T(e.split("/")),i=T(t.split("/")),g=Math.min(n.length,i.length),o=g;for(let e=0;e<g;e++)if(n[e]!==i[e]){o=e;break}let r=[];for(let e=o;e<n.length;e++)r.push("..");return(r=r.concat(i.slice(o))).join("/")}(t,g):function(e,t){let n=k(e)[2];return t&&n.slice(-1*t.length)===t&&(n=n.slice(0,n.length-t.length)),n}(g);e.filename=`${n}${o}`}return e});return{name:nN,setupOnce(){},processEvent(e){let t=e;return e.exception&&Array.isArray(e.exception.values)&&(t=function(e){try{return{...e,exception:{...e.exception,values:e.exception.values.map(e=>{var t;return{...e,...e.stacktrace&&{stacktrace:{...t=e.stacktrace,frames:t&&t.frames&&t.frames.map(e=>i(e))}}}})}}}catch(t){return e}}(t)),t}}}),nK=(0,b.RN)(nN,nF),n_=global,nJ=(0,b._I)(e=>{let t=n_.__rewriteFramesDistDir__;if(t){let n=new RegExp(x.resolve(t).replace(/(\/|\\)$/,"").replace(/[|\\{}()[\]^$+*?.]/g,"\\$&").replace(/-/g,"\\x2d"));return nF({iteratee:e=>(e.filename=(0,ee.x)([e,"access",e=>e.filename,"optionalAccess",e=>e.replace,"call",e=>e(n,"app:///_next")]),e),...e})}return{name:nK.id,setupOnce:()=>{},processEvent:e=>e}});nX();let nw=!!process.env.VERCEL;function nx(e){if((0,c.T)(),nX())return;let t=[...nv(e).filter(e=>!["Http","OnUncaughtException"].includes(e.name)),nJ(),new nY,new nf],n={environment:process.env.SENTRY_ENVIRONMENT||function(e){let t=e?process.env.NEXT_PUBLIC_VERCEL_ENV:process.env.VERCEL_ENV;return t?`vercel-${t}`:void 0}(!1)||"production",defaultIntegrations:t,...e,autoSessionTracking:!1};if(nS.X&&n.debug&&G.kg.enable(),nS.X&&G.kg.log("Initializing SDK..."),(0,u.s3)()){nS.X&&G.kg.log("SDK already initialized");return}d(n,"nextjs",["nextjs","node"]),function(e={}){ed.V.major>=14?function(){function e(){return o.getStore()}o||(o=new tM.AsyncLocalStorage),(0,et.$b)({getCurrentHub:e,runWithAsyncContext:function(t,n){let i=e();if(i&&(0,ee.x)([n,"optionalAccess",e=>e.reuseExisting]))return t();let g=function(e){let t={};return(0,et.uZ)(t,e),(0,et.vi)(t)}(i);return o.run(g,()=>t())}})}():(0,et.$b)({getCurrentHub:tQ,runWithAsyncContext:tO}),void 0===e.defaultIntegrations&&(e.defaultIntegrations=nv()),void 0===e.dsn&&process.env.SENTRY_DSN&&(e.dsn=process.env.SENTRY_DSN);let t=process.env.SENTRY_TRACES_SAMPLE_RATE;if(void 0===e.tracesSampleRate&&t){let n=parseFloat(t);isFinite(n)&&(e.tracesSampleRate=n)}if(void 0===e.release){let t=process.env.SENTRY_RELEASE?process.env.SENTRY_RELEASE:O.GLOBAL_OBJ.SENTRY_RELEASE&&O.GLOBAL_OBJ.SENTRY_RELEASE.id?O.GLOBAL_OBJ.SENTRY_RELEASE.id:process.env.GITHUB_SHA||process.env.COMMIT_REF||process.env.VERCEL_GIT_COMMIT_SHA||process.env.VERCEL_GITHUB_COMMIT_SHA||process.env.VERCEL_GITLAB_COMMIT_SHA||process.env.VERCEL_BITBUCKET_COMMIT_SHA||process.env.ZEIT_GITHUB_COMMIT_SHA||process.env.ZEIT_GITLAB_COMMIT_SHA||process.env.ZEIT_BITBUCKET_COMMIT_SHA||process.env.CF_PAGES_COMMIT_SHA||void 0;void 0!==t?e.release=t:e.autoSessionTracking=!1}void 0===e.environment&&process.env.SENTRY_ENVIRONMENT&&(e.environment=process.env.SENTRY_ENVIRONMENT),void 0===e.autoSessionTracking&&void 0!==e.dsn&&(e.autoSessionTracking=!0),void 0===e.instrumenter&&(e.instrumenter="sentry");let n={...e,stackParser:(0,tz.Sq)(e.stackParser||nR),integrations:(0,b.m8)(e),transport:e.transport||nW};if(function(e,t){!0===t.debug&&(y.X?G.kg.enable():(0,G.Cf)(()=>{console.warn("[Sentry] Cannot initialize SDK with `debug` option using a non-debug bundle.")})),(0,u.nZ)().update(t.initialScope);let n=new e(t);(function(e){let t=(0,et.Gd)().getStackTop();t.client=e,t.scope.setClient(e)})(n),n.init?n.init():n.setupIntegrations&&n.setupIntegrations()}(e.clientClass||nr,n),e.autoSessionTracking&&((0,u.yj)(),process.on("beforeExit",()=>{let e=(0,et.aF)().getSession();e&&!["exited","crashed"].includes(e.status)&&(0,u.TM)()})),function(){if(!["false","n","no","off","0"].includes((process.env.SENTRY_USE_ENVIRONMENT||"").toLowerCase())){let e=process.env.SENTRY_TRACE,t=process.env.SENTRY_BAGGAGE,n=(0,ec.pT)(e,t);(0,u.nZ)().setPropagationContext(n)}}(),e.spotlight){let t=(0,u.s3)();if(t&&t.addIntegration){for(let e of t.getOptions().integrations)t.addIntegration(e);t.addIntegration(tm({sidecarUrl:"string"==typeof e.spotlight?e.spotlight:void 0}))}}}(n);let i=e=>"transaction"===e.type&&"/404"===e.transaction?null:e;i.id="NextServer404TransactionFilter";let g=(0,u.nZ)();g.setTag("runtime","node"),nw&&g.setTag("vercel",!0),g.addEventProcessor(i),nS.X&&G.kg.log("SDK successfully initialized")}},948:(e,t,n)=>{"use strict";n.d(t,{q:()=>C});var i=n(1907);function g(e){let t=(0,i.x)(e);return null==t||t}var o=n(7310),r=n(6295),l=n(155),s=n(8488),a=n(6614),c=n(3383);function I(e,...t){s.kg.log(`[ANR] ${e}`,...t)}async function d(e){let t={message:"ANR"},n={};for(let i of e.getEventProcessors()){if(null===t)break;t=await i(t,n)}return(0,i.x)([t,"optionalAccess",e=>e.contexts])||{}}e=n.hmd(e);let u=(0,r._I)((e={})=>({name:"Anr",setupOnce(){},setup(t){if(c.V.major<16||16===c.V.major&&c.V.minor<17)throw Error("ANR detection requires Node 16.17.0 or later");setImmediate(()=>b(t,e))}})),C=(0,r.RN)("Anr",u);async function b(t,i){let r=await d(t),c=t.getDsn();if(!c)return;g([r,"access",e=>e.app,"optionalAccess",e=>delete e.app_memory]),g([r,"access",e=>e.device,"optionalAccess",e=>delete e.free_memory]);let u=t.getOptions(),C=t.getSdkMetadata()||{};C.sdk&&(C.sdk.integrations=u.integrations.map(e=>e.name));let b={debug:s.kg.isEnabled(),dsn:c,environment:u.environment||"production",release:u.release,dist:u.dist,sdkMetadata:C,appRootPath:i.appRootPath,pollInterval:i.pollInterval||50,anrThreshold:i.anrThreshold||5e3,captureStackTrace:!!i.captureStackTrace,staticTags:i.staticTags||{},contexts:r};if(b.captureStackTrace){let e=n(1405);e.url()||e.open(0)}let{Worker:p}=(0,a.l$)(e,"worker_threads"),m=new p(new o.URL("data:application/javascript;base64,aW1wb3J0IHsgU2Vzc2lvbiB9IGZyb20gJ2luc3BlY3Rvcic7CmltcG9ydCB7IHdvcmtlckRhdGEsIHBhcmVudFBvcnQgfSBmcm9tICd3b3JrZXJfdGhyZWFkcyc7CmltcG9ydCB7IHBvc2l4LCBzZXAgfSBmcm9tICdwYXRoJzsKaW1wb3J0ICogYXMgaHR0cCBmcm9tICdodHRwJzsKaW1wb3J0ICogYXMgaHR0cHMgZnJvbSAnaHR0cHMnOwppbXBvcnQgeyBSZWFkYWJsZSB9IGZyb20gJ3N0cmVhbSc7CmltcG9ydCB7IFVSTCB9IGZyb20gJ3VybCc7CmltcG9ydCB7IGNyZWF0ZUd6aXAgfSBmcm9tICd6bGliJzsKaW1wb3J0IGFzc2VydCBmcm9tICdhc3NlcnQnOwppbXBvcnQgKiBhcyBuZXQgZnJvbSAnbmV0JzsKaW1wb3J0ICogYXMgdGxzIGZyb20gJ3Rscyc7CgovLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L3VuYm91bmQtbWV0aG9kCmNvbnN0IG9iamVjdFRvU3RyaW5nID0gT2JqZWN0LnByb3RvdHlwZS50b1N0cmluZzsKCi8qKgogKiBDaGVja3Mgd2hldGhlciBnaXZlbiB2YWx1ZSdzIHR5cGUgaXMgb25lIG9mIGEgZmV3IEVycm9yIG9yIEVycm9yLWxpa2UKICoge0BsaW5rIGlzRXJyb3J9LgogKgogKiBAcGFyYW0gd2F0IEEgdmFsdWUgdG8gYmUgY2hlY2tlZC4KICogQHJldHVybnMgQSBib29sZWFuIHJlcHJlc2VudGluZyB0aGUgcmVzdWx0LgogKi8KZnVuY3Rpb24gaXNFcnJvcih3YXQpIHsKICBzd2l0Y2ggKG9iamVjdFRvU3RyaW5nLmNhbGwod2F0KSkgewogICAgY2FzZSAnW29iamVjdCBFcnJvcl0nOgogICAgY2FzZSAnW29iamVjdCBFeGNlcHRpb25dJzoKICAgIGNhc2UgJ1tvYmplY3QgRE9NRXhjZXB0aW9uXSc6CiAgICAgIHJldHVybiB0cnVlOwogICAgZGVmYXVsdDoKICAgICAgcmV0dXJuIGlzSW5zdGFuY2VPZih3YXQsIEVycm9yKTsKICB9Cn0KLyoqCiAqIENoZWNrcyB3aGV0aGVyIGdpdmVuIHZhbHVlIGlzIGFuIGluc3RhbmNlIG9mIHRoZSBnaXZlbiBidWlsdC1pbiBjbGFzcy4KICoKICogQHBhcmFtIHdhdCBUaGUgdmFsdWUgdG8gYmUgY2hlY2tlZAogKiBAcGFyYW0gY2xhc3NOYW1lCiAqIEByZXR1cm5zIEEgYm9vbGVhbiByZXByZXNlbnRpbmcgdGhlIHJlc3VsdC4KICovCmZ1bmN0aW9uIGlzQnVpbHRpbih3YXQsIGNsYXNzTmFtZSkgewogIHJldHVybiBvYmplY3RUb1N0cmluZy5jYWxsKHdhdCkgPT09IGBbb2JqZWN0ICR7Y2xhc3NOYW1lfV1gOwp9CgovKioKICogQ2hlY2tzIHdoZXRoZXIgZ2l2ZW4gdmFsdWUncyB0eXBlIGlzIGEgc3RyaW5nCiAqIHtAbGluayBpc1N0cmluZ30uCiAqCiAqIEBwYXJhbSB3YXQgQSB2YWx1ZSB0byBiZSBjaGVja2VkLgogKiBAcmV0dXJucyBBIGJvb2xlYW4gcmVwcmVzZW50aW5nIHRoZSByZXN1bHQuCiAqLwpmdW5jdGlvbiBpc1N0cmluZyh3YXQpIHsKICByZXR1cm4gaXNCdWlsdGluKHdhdCwgJ1N0cmluZycpOwp9CgovKioKICogQ2hlY2tzIHdoZXRoZXIgZ2l2ZW4gdmFsdWUncyB0eXBlIGlzIGFuIG9iamVjdCBsaXRlcmFsLCBvciBhIGNsYXNzIGluc3RhbmNlLgogKiB7QGxpbmsgaXNQbGFpbk9iamVjdH0uCiAqCiAqIEBwYXJhbSB3YXQgQSB2YWx1ZSB0byBiZSBjaGVja2VkLgogKiBAcmV0dXJucyBBIGJvb2xlYW4gcmVwcmVzZW50aW5nIHRoZSByZXN1bHQuCiAqLwpmdW5jdGlvbiBpc1BsYWluT2JqZWN0KHdhdCkgewogIHJldHVybiBpc0J1aWx0aW4od2F0LCAnT2JqZWN0Jyk7Cn0KCi8qKgogKiBDaGVja3Mgd2hldGhlciBnaXZlbiB2YWx1ZSdzIHR5cGUgaXMgYW4gRXZlbnQgaW5zdGFuY2UKICoge0BsaW5rIGlzRXZlbnR9LgogKgogKiBAcGFyYW0gd2F0IEEgdmFsdWUgdG8gYmUgY2hlY2tlZC4KICogQHJldHVybnMgQSBib29sZWFuIHJlcHJlc2VudGluZyB0aGUgcmVzdWx0LgogKi8KZnVuY3Rpb24gaXNFdmVudCh3YXQpIHsKICByZXR1cm4gdHlwZW9mIEV2ZW50ICE9PSAndW5kZWZpbmVkJyAmJiBpc0luc3RhbmNlT2Yod2F0LCBFdmVudCk7Cn0KCi8qKgogKiBDaGVja3Mgd2hldGhlciBnaXZlbiB2YWx1ZSdzIHR5cGUgaXMgYW4gRWxlbWVudCBpbnN0YW5jZQogKiB7QGxpbmsgaXNFbGVtZW50fS4KICoKICogQHBhcmFtIHdhdCBBIHZhbHVlIHRvIGJlIGNoZWNrZWQuCiAqIEByZXR1cm5zIEEgYm9vbGVhbiByZXByZXNlbnRpbmcgdGhlIHJlc3VsdC4KICovCmZ1bmN0aW9uIGlzRWxlbWVudCh3YXQpIHsKICByZXR1cm4gdHlwZW9mIEVsZW1lbnQgIT09ICd1bmRlZmluZWQnICYmIGlzSW5zdGFuY2VPZih3YXQsIEVsZW1lbnQpOwp9CgovKioKICogQ2hlY2tzIHdoZXRoZXIgZ2l2ZW4gdmFsdWUgaGFzIGEgdGhlbiBmdW5jdGlvbi4KICogQHBhcmFtIHdhdCBBIHZhbHVlIHRvIGJlIGNoZWNrZWQuCiAqLwpmdW5jdGlvbiBpc1RoZW5hYmxlKHdhdCkgewogIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tdW5zYWZlLW1lbWJlci1hY2Nlc3MKICByZXR1cm4gQm9vbGVhbih3YXQgJiYgd2F0LnRoZW4gJiYgdHlwZW9mIHdhdC50aGVuID09PSAnZnVuY3Rpb24nKTsKfQoKLyoqCiAqIENoZWNrcyB3aGV0aGVyIGdpdmVuIHZhbHVlJ3MgdHlwZSBpcyBhIFN5bnRoZXRpY0V2ZW50CiAqIHtAbGluayBpc1N5bnRoZXRpY0V2ZW50fS4KICoKICogQHBhcmFtIHdhdCBBIHZhbHVlIHRvIGJlIGNoZWNrZWQuCiAqIEByZXR1cm5zIEEgYm9vbGVhbiByZXByZXNlbnRpbmcgdGhlIHJlc3VsdC4KICovCmZ1bmN0aW9uIGlzU3ludGhldGljRXZlbnQod2F0KSB7CiAgcmV0dXJuIGlzUGxhaW5PYmplY3Qod2F0KSAmJiAnbmF0aXZlRXZlbnQnIGluIHdhdCAmJiAncHJldmVudERlZmF1bHQnIGluIHdhdCAmJiAnc3RvcFByb3BhZ2F0aW9uJyBpbiB3YXQ7Cn0KCi8qKgogKiBDaGVja3Mgd2hldGhlciBnaXZlbiB2YWx1ZSBpcyBOYU4KICoge0BsaW5rIGlzTmFOfS4KICoKICogQHBhcmFtIHdhdCBBIHZhbHVlIHRvIGJlIGNoZWNrZWQuCiAqIEByZXR1cm5zIEEgYm9vbGVhbiByZXByZXNlbnRpbmcgdGhlIHJlc3VsdC4KICovCmZ1bmN0aW9uIGlzTmFOJDEod2F0KSB7CiAgcmV0dXJuIHR5cGVvZiB3YXQgPT09ICdudW1iZXInICYmIHdhdCAhPT0gd2F0Owp9CgovKioKICogQ2hlY2tzIHdoZXRoZXIgZ2l2ZW4gdmFsdWUncyB0eXBlIGlzIGFuIGluc3RhbmNlIG9mIHByb3ZpZGVkIGNvbnN0cnVjdG9yLgogKiB7QGxpbmsgaXNJbnN0YW5jZU9mfS4KICoKICogQHBhcmFtIHdhdCBBIHZhbHVlIHRvIGJlIGNoZWNrZWQuCiAqIEBwYXJhbSBiYXNlIEEgY29uc3RydWN0b3IgdG8gYmUgdXNlZCBpbiBhIGNoZWNrLgogKiBAcmV0dXJucyBBIGJvb2xlYW4gcmVwcmVzZW50aW5nIHRoZSByZXN1bHQuCiAqLwpmdW5jdGlvbiBpc0luc3RhbmNlT2Yod2F0LCBiYXNlKSB7CiAgdHJ5IHsKICAgIHJldHVybiB3YXQgaW5zdGFuY2VvZiBiYXNlOwogIH0gY2F0Y2ggKF9lKSB7CiAgICByZXR1cm4gZmFsc2U7CiAgfQp9CgovKioKICogQ2hlY2tzIHdoZXRoZXIgZ2l2ZW4gdmFsdWUncyB0eXBlIGlzIGEgVnVlIFZpZXdNb2RlbC4KICoKICogQHBhcmFtIHdhdCBBIHZhbHVlIHRvIGJlIGNoZWNrZWQuCiAqIEByZXR1cm5zIEEgYm9vbGVhbiByZXByZXNlbnRpbmcgdGhlIHJlc3VsdC4KICovCmZ1bmN0aW9uIGlzVnVlVmlld01vZGVsKHdhdCkgewogIC8vIE5vdCB1c2luZyBPYmplY3QucHJvdG90eXBlLnRvU3RyaW5nIGJlY2F1c2UgaW4gVnVlIDMgaXQgd291bGQgcmVhZCB0aGUgaW5zdGFuY2UncyBTeW1ib2woU3ltYm9sLnRvU3RyaW5nVGFnKSBwcm9wZXJ0eS4KICByZXR1cm4gISEodHlwZW9mIHdhdCA9PT0gJ29iamVjdCcgJiYgd2F0ICE9PSBudWxsICYmICgod2F0ICkuX19pc1Z1ZSB8fCAod2F0ICkuX2lzVnVlKSk7Cn0KCi8qKiBJbnRlcm5hbCBnbG9iYWwgd2l0aCBjb21tb24gcHJvcGVydGllcyBhbmQgU2VudHJ5IGV4dGVuc2lvbnMgICovCgovLyBUaGUgY29kZSBiZWxvdyBmb3IgJ2lzR2xvYmFsT2JqJyBhbmQgJ0dMT0JBTF9PQkonIHdhcyBjb3BpZWQgZnJvbSBjb3JlLWpzIGJlZm9yZSBtb2RpZmljYXRpb24KLy8gaHR0cHM6Ly9naXRodWIuY29tL3psb2lyb2NrL2NvcmUtanMvYmxvYi8xYjk0NGRmNTUyODJjZGM5OWM5MGRiNWY0OWViMGI2ZWRhMmNjMGEzL3BhY2thZ2VzL2NvcmUtanMvaW50ZXJuYWxzL2dsb2JhbC5qcwovLyBjb3JlLWpzIGhhcyB0aGUgZm9sbG93aW5nIGxpY2VuY2U6Ci8vCi8vIENvcHlyaWdodCAoYykgMjAxNC0yMDIyIERlbmlzIFB1c2hrYXJldgovLwovLyBQZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmcgYSBjb3B5Ci8vIG9mIHRoaXMgc29mdHdhcmUgYW5kIGFzc29jaWF0ZWQgZG9jdW1lbnRhdGlvbiBmaWxlcyAodGhlICJTb2Z0d2FyZSIpLCB0byBkZWFsCi8vIGluIHRoZSBTb2Z0d2FyZSB3aXRob3V0IHJlc3RyaWN0aW9uLCBpbmNsdWRpbmcgd2l0aG91dCBsaW1pdGF0aW9uIHRoZSByaWdodHMKLy8gdG8gdXNlLCBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJsaXNoLCBkaXN0cmlidXRlLCBzdWJsaWNlbnNlLCBhbmQvb3Igc2VsbAovLyBjb3BpZXMgb2YgdGhlIFNvZnR3YXJlLCBhbmQgdG8gcGVybWl0IHBlcnNvbnMgdG8gd2hvbSB0aGUgU29mdHdhcmUgaXMKLy8gZnVybmlzaGVkIHRvIGRvIHNvLCBzdWJqZWN0IHRvIHRoZSBmb2xsb3dpbmcgY29uZGl0aW9uczoKLy8KLy8gVGhlIGFib3ZlIGNvcHlyaWdodCBub3RpY2UgYW5kIHRoaXMgcGVybWlzc2lvbiBub3RpY2Ugc2hhbGwgYmUgaW5jbHVkZWQgaW4KLy8gYWxsIGNvcGllcyBvciBzdWJzdGFudGlhbCBwb3J0aW9ucyBvZiB0aGUgU29mdHdhcmUuCi8vCi8vIFRIRSBTT0ZUV0FSRSBJUyBQUk9WSURFRCAiQVMgSVMiLCBXSVRIT1VUIFdBUlJBTlRZIE9GIEFOWSBLSU5ELCBFWFBSRVNTIE9SCi8vIElNUExJRUQsIElOQ0xVRElORyBCVVQgTk9UIExJTUlURUQgVE8gVEhFIFdBUlJBTlRJRVMgT0YgTUVSQ0hBTlRBQklMSVRZLAovLyBGSVRORVNTIEZPUiBBIFBBUlRJQ1VMQVIgUFVSUE9TRSBBTkQgTk9OSU5GUklOR0VNRU5ULiBJTiBOTyBFVkVOVCBTSEFMTCBUSEUKLy8gQVVUSE9SUyBPUiBDT1BZUklHSFQgSE9MREVSUyBCRSBMSUFCTEUgRk9SIEFOWSBDTEFJTSwgREFNQUdFUyBPUiBPVEhFUgovLyBMSUFCSUxJVFksIFdIRVRIRVIgSU4gQU4gQUNUSU9OIE9GIENPTlRSQUNULCBUT1JUIE9SIE9USEVSV0lTRSwgQVJJU0lORyBGUk9NLAovLyBPVVQgT0YgT1IgSU4gQ09OTkVDVElPTiBXSVRIIFRIRSBTT0ZUV0FSRSBPUiBUSEUgVVNFIE9SIE9USEVSIERFQUxJTkdTIElOCi8vIFRIRSBTT0ZUV0FSRS4KCi8qKiBSZXR1cm5zICdvYmonIGlmIGl0J3MgdGhlIGdsb2JhbCBvYmplY3QsIG90aGVyd2lzZSByZXR1cm5zIHVuZGVmaW5lZCAqLwpmdW5jdGlvbiBpc0dsb2JhbE9iaihvYmopIHsKICByZXR1cm4gb2JqICYmIG9iai5NYXRoID09IE1hdGggPyBvYmogOiB1bmRlZmluZWQ7Cn0KCi8qKiBHZXQncyB0aGUgZ2xvYmFsIG9iamVjdCBmb3IgdGhlIGN1cnJlbnQgSmF2YVNjcmlwdCBydW50aW1lICovCmNvbnN0IEdMT0JBTF9PQkogPQogICh0eXBlb2YgZ2xvYmFsVGhpcyA9PSAnb2JqZWN0JyAmJiBpc0dsb2JhbE9iaihnbG9iYWxUaGlzKSkgfHwKICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tcmVzdHJpY3RlZC1nbG9iYWxzCiAgKHR5cGVvZiB3aW5kb3cgPT0gJ29iamVjdCcgJiYgaXNHbG9iYWxPYmood2luZG93KSkgfHwKICAodHlwZW9mIHNlbGYgPT0gJ29iamVjdCcgJiYgaXNHbG9iYWxPYmooc2VsZikpIHx8CiAgKHR5cGVvZiBnbG9iYWwgPT0gJ29iamVjdCcgJiYgaXNHbG9iYWxPYmooZ2xvYmFsKSkgfHwKICAoZnVuY3Rpb24gKCkgewogICAgcmV0dXJuIHRoaXM7CiAgfSkoKSB8fAogIHt9OwoKLyoqCiAqIEBkZXByZWNhdGVkIFVzZSBHTE9CQUxfT0JKIGluc3RlYWQgb3IgV0lORE9XIGZyb20gQHNlbnRyeS9icm93c2VyLiBUaGlzIHdpbGwgYmUgcmVtb3ZlZCBpbiB2OAogKi8KZnVuY3Rpb24gZ2V0R2xvYmFsT2JqZWN0KCkgewogIHJldHVybiBHTE9CQUxfT0JKIDsKfQoKLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIGRlcHJlY2F0aW9uL2RlcHJlY2F0aW9uCmNvbnN0IFdJTkRPVyA9IGdldEdsb2JhbE9iamVjdCgpOwoKY29uc3QgREVGQVVMVF9NQVhfU1RSSU5HX0xFTkdUSCA9IDgwOwoKLyoqCiAqIEdpdmVuIGEgY2hpbGQgRE9NIGVsZW1lbnQsIHJldHVybnMgYSBxdWVyeS1zZWxlY3RvciBzdGF0ZW1lbnQgZGVzY3JpYmluZyB0aGF0CiAqIGFuZCBpdHMgYW5jZXN0b3JzCiAqIGUuZy4gW0hUTUxFbGVtZW50XSA9PiBib2R5ID4gZGl2ID4gaW5wdXQjZm9vLmJ0bltuYW1lPWJhel0KICogQHJldHVybnMgZ2VuZXJhdGVkIERPTSBwYXRoCiAqLwpmdW5jdGlvbiBodG1sVHJlZUFzU3RyaW5nKAogIGVsZW0sCiAgb3B0aW9ucyA9IHt9LAopIHsKICBpZiAoIWVsZW0pIHsKICAgIHJldHVybiAnPHVua25vd24+JzsKICB9CgogIC8vIHRyeS9jYXRjaCBib3RoOgogIC8vIC0gYWNjZXNzaW5nIGV2ZW50LnRhcmdldCAoc2VlIGdldHNlbnRyeS9yYXZlbi1qcyM4MzgsICM3NjgpCiAgLy8gLSBgaHRtbFRyZWVBc1N0cmluZ2AgYmVjYXVzZSBpdCdzIGNvbXBsZXgsIGFuZCBqdXN0IGFjY2Vzc2luZyB0aGUgRE9NIGluY29ycmVjdGx5CiAgLy8gLSBjYW4gdGhyb3cgYW4gZXhjZXB0aW9uIGluIHNvbWUgY2lyY3Vtc3RhbmNlcy4KICB0cnkgewogICAgbGV0IGN1cnJlbnRFbGVtID0gZWxlbSA7CiAgICBjb25zdCBNQVhfVFJBVkVSU0VfSEVJR0hUID0gNTsKICAgIGNvbnN0IG91dCA9IFtdOwogICAgbGV0IGhlaWdodCA9IDA7CiAgICBsZXQgbGVuID0gMDsKICAgIGNvbnN0IHNlcGFyYXRvciA9ICcgPiAnOwogICAgY29uc3Qgc2VwTGVuZ3RoID0gc2VwYXJhdG9yLmxlbmd0aDsKICAgIGxldCBuZXh0U3RyOwogICAgY29uc3Qga2V5QXR0cnMgPSBBcnJheS5pc0FycmF5KG9wdGlvbnMpID8gb3B0aW9ucyA6IG9wdGlvbnMua2V5QXR0cnM7CiAgICBjb25zdCBtYXhTdHJpbmdMZW5ndGggPSAoIUFycmF5LmlzQXJyYXkob3B0aW9ucykgJiYgb3B0aW9ucy5tYXhTdHJpbmdMZW5ndGgpIHx8IERFRkFVTFRfTUFYX1NUUklOR19MRU5HVEg7CgogICAgd2hpbGUgKGN1cnJlbnRFbGVtICYmIGhlaWdodCsrIDwgTUFYX1RSQVZFUlNFX0hFSUdIVCkgewogICAgICBuZXh0U3RyID0gX2h0bWxFbGVtZW50QXNTdHJpbmcoY3VycmVudEVsZW0sIGtleUF0dHJzKTsKICAgICAgLy8gYmFpbCBvdXQgaWYKICAgICAgLy8gLSBuZXh0U3RyIGlzIHRoZSAnaHRtbCcgZWxlbWVudAogICAgICAvLyAtIHRoZSBsZW5ndGggb2YgdGhlIHN0cmluZyB0aGF0IHdvdWxkIGJlIGNyZWF0ZWQgZXhjZWVkcyBtYXhTdHJpbmdMZW5ndGgKICAgICAgLy8gICAoaWdub3JlIHRoaXMgbGltaXQgaWYgd2UgYXJlIG9uIHRoZSBmaXJzdCBpdGVyYXRpb24pCiAgICAgIGlmIChuZXh0U3RyID09PSAnaHRtbCcgfHwgKGhlaWdodCA+IDEgJiYgbGVuICsgb3V0Lmxlbmd0aCAqIHNlcExlbmd0aCArIG5leHRTdHIubGVuZ3RoID49IG1heFN0cmluZ0xlbmd0aCkpIHsKICAgICAgICBicmVhazsKICAgICAgfQoKICAgICAgb3V0LnB1c2gobmV4dFN0cik7CgogICAgICBsZW4gKz0gbmV4dFN0ci5sZW5ndGg7CiAgICAgIGN1cnJlbnRFbGVtID0gY3VycmVudEVsZW0ucGFyZW50Tm9kZTsKICAgIH0KCiAgICByZXR1cm4gb3V0LnJldmVyc2UoKS5qb2luKHNlcGFyYXRvcik7CiAgfSBjYXRjaCAoX29PKSB7CiAgICByZXR1cm4gJzx1bmtub3duPic7CiAgfQp9CgovKioKICogUmV0dXJucyBhIHNpbXBsZSwgcXVlcnktc2VsZWN0b3IgcmVwcmVzZW50YXRpb24gb2YgYSBET00gZWxlbWVudAogKiBlLmcuIFtIVE1MRWxlbWVudF0gPT4gaW5wdXQjZm9vLmJ0bltuYW1lPWJhel0KICogQHJldHVybnMgZ2VuZXJhdGVkIERPTSBwYXRoCiAqLwpmdW5jdGlvbiBfaHRtbEVsZW1lbnRBc1N0cmluZyhlbCwga2V5QXR0cnMpIHsKICBjb25zdCBlbGVtID0gZWwKCjsKCiAgY29uc3Qgb3V0ID0gW107CiAgbGV0IGNsYXNzTmFtZTsKICBsZXQgY2xhc3NlczsKICBsZXQga2V5OwogIGxldCBhdHRyOwogIGxldCBpOwoKICBpZiAoIWVsZW0gfHwgIWVsZW0udGFnTmFtZSkgewogICAgcmV0dXJuICcnOwogIH0KCiAgLy8gQHRzLWV4cGVjdC1lcnJvciBXSU5ET1cgaGFzIEhUTUxFbGVtZW50CiAgaWYgKFdJTkRPVy5IVE1MRWxlbWVudCkgewogICAgLy8gSWYgdXNpbmcgdGhlIGNvbXBvbmVudCBuYW1lIGFubm90YXRpb24gcGx1Z2luLCB0aGlzIHZhbHVlIG1heSBiZSBhdmFpbGFibGUgb24gdGhlIERPTSBub2RlCiAgICBpZiAoZWxlbSBpbnN0YW5jZW9mIEhUTUxFbGVtZW50ICYmIGVsZW0uZGF0YXNldCAmJiBlbGVtLmRhdGFzZXRbJ3NlbnRyeUNvbXBvbmVudCddKSB7CiAgICAgIHJldHVybiBlbGVtLmRhdGFzZXRbJ3NlbnRyeUNvbXBvbmVudCddOwogICAgfQogIH0KCiAgb3V0LnB1c2goZWxlbS50YWdOYW1lLnRvTG93ZXJDYXNlKCkpOwoKICAvLyBQYWlycyBvZiBhdHRyaWJ1dGUga2V5cyBkZWZpbmVkIGluIGBzZXJpYWxpemVBdHRyaWJ1dGVgIGFuZCB0aGVpciB2YWx1ZXMgb24gZWxlbWVudC4KICBjb25zdCBrZXlBdHRyUGFpcnMgPQogICAga2V5QXR0cnMgJiYga2V5QXR0cnMubGVuZ3RoCiAgICAgID8ga2V5QXR0cnMuZmlsdGVyKGtleUF0dHIgPT4gZWxlbS5nZXRBdHRyaWJ1dGUoa2V5QXR0cikpLm1hcChrZXlBdHRyID0+IFtrZXlBdHRyLCBlbGVtLmdldEF0dHJpYnV0ZShrZXlBdHRyKV0pCiAgICAgIDogbnVsbDsKCiAgaWYgKGtleUF0dHJQYWlycyAmJiBrZXlBdHRyUGFpcnMubGVuZ3RoKSB7CiAgICBrZXlBdHRyUGFpcnMuZm9yRWFjaChrZXlBdHRyUGFpciA9PiB7CiAgICAgIG91dC5wdXNoKGBbJHtrZXlBdHRyUGFpclswXX09IiR7a2V5QXR0clBhaXJbMV19Il1gKTsKICAgIH0pOwogIH0gZWxzZSB7CiAgICBpZiAoZWxlbS5pZCkgewogICAgICBvdXQucHVzaChgIyR7ZWxlbS5pZH1gKTsKICAgIH0KCiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgcHJlZmVyLWNvbnN0CiAgICBjbGFzc05hbWUgPSBlbGVtLmNsYXNzTmFtZTsKICAgIGlmIChjbGFzc05hbWUgJiYgaXNTdHJpbmcoY2xhc3NOYW1lKSkgewogICAgICBjbGFzc2VzID0gY2xhc3NOYW1lLnNwbGl0KC9ccysvKTsKICAgICAgZm9yIChpID0gMDsgaSA8IGNsYXNzZXMubGVuZ3RoOyBpKyspIHsKICAgICAgICBvdXQucHVzaChgLiR7Y2xhc3Nlc1tpXX1gKTsKICAgICAgfQogICAgfQogIH0KICBjb25zdCBhbGxvd2VkQXR0cnMgPSBbJ2FyaWEtbGFiZWwnLCAndHlwZScsICduYW1lJywgJ3RpdGxlJywgJ2FsdCddOwogIGZvciAoaSA9IDA7IGkgPCBhbGxvd2VkQXR0cnMubGVuZ3RoOyBpKyspIHsKICAgIGtleSA9IGFsbG93ZWRBdHRyc1tpXTsKICAgIGF0dHIgPSBlbGVtLmdldEF0dHJpYnV0ZShrZXkpOwogICAgaWYgKGF0dHIpIHsKICAgICAgb3V0LnB1c2goYFske2tleX09IiR7YXR0cn0iXWApOwogICAgfQogIH0KICByZXR1cm4gb3V0LmpvaW4oJycpOwp9CgovKioKICogVGhpcyBzZXJ2ZXMgYXMgYSBidWlsZCB0aW1lIGZsYWcgdGhhdCB3aWxsIGJlIHRydWUgYnkgZGVmYXVsdCwgYnV0IGZhbHNlIGluIG5vbi1kZWJ1ZyBidWlsZHMgb3IgaWYgdXNlcnMgcmVwbGFjZSBgX19TRU5UUllfREVCVUdfX2AgaW4gdGhlaXIgZ2VuZXJhdGVkIGNvZGUuCiAqCiAqIEFUVEVOVElPTjogVGhpcyBjb25zdGFudCBtdXN0IG5ldmVyIGNyb3NzIHBhY2thZ2UgYm91bmRhcmllcyAoaS5lLiBiZSBleHBvcnRlZCkgdG8gZ3VhcmFudGVlIHRoYXQgaXQgY2FuIGJlIHVzZWQgZm9yIHRyZWUgc2hha2luZy4KICovCmNvbnN0IERFQlVHX0JVSUxEJDEgPSAodHlwZW9mIF9fU0VOVFJZX0RFQlVHX18gPT09ICd1bmRlZmluZWQnIHx8IF9fU0VOVFJZX0RFQlVHX18pOwoKLyoqIFByZWZpeCBmb3IgbG9nZ2luZyBzdHJpbmdzICovCmNvbnN0IFBSRUZJWCA9ICdTZW50cnkgTG9nZ2VyICc7Cgpjb25zdCBDT05TT0xFX0xFVkVMUyA9IFsKICAnZGVidWcnLAogICdpbmZvJywKICAnd2FybicsCiAgJ2Vycm9yJywKICAnbG9nJywKICAnYXNzZXJ0JywKICAndHJhY2UnLApdIDsKCi8qKiBUaGlzIG1heSBiZSBtdXRhdGVkIGJ5IHRoZSBjb25zb2xlIGluc3RydW1lbnRhdGlvbi4gKi8KY29uc3Qgb3JpZ2luYWxDb25zb2xlTWV0aG9kcwoKID0ge307CgovKiogSlNEb2MgKi8KCi8qKgogKiBUZW1wb3JhcmlseSBkaXNhYmxlIHNlbnRyeSBjb25zb2xlIGluc3RydW1lbnRhdGlvbnMuCiAqCiAqIEBwYXJhbSBjYWxsYmFjayBUaGUgZnVuY3Rpb24gdG8gcnVuIGFnYWluc3QgdGhlIG9yaWdpbmFsIGBjb25zb2xlYCBtZXNzYWdlcwogKiBAcmV0dXJucyBUaGUgcmVzdWx0cyBvZiB0aGUgY2FsbGJhY2sKICovCmZ1bmN0aW9uIGNvbnNvbGVTYW5kYm94KGNhbGxiYWNrKSB7CiAgaWYgKCEoJ2NvbnNvbGUnIGluIEdMT0JBTF9PQkopKSB7CiAgICByZXR1cm4gY2FsbGJhY2soKTsKICB9CgogIGNvbnN0IGNvbnNvbGUgPSBHTE9CQUxfT0JKLmNvbnNvbGUgOwogIGNvbnN0IHdyYXBwZWRGdW5jcyA9IHt9OwoKICBjb25zdCB3cmFwcGVkTGV2ZWxzID0gT2JqZWN0LmtleXMob3JpZ2luYWxDb25zb2xlTWV0aG9kcykgOwoKICAvLyBSZXN0b3JlIGFsbCB3cmFwcGVkIGNvbnNvbGUgbWV0aG9kcwogIHdyYXBwZWRMZXZlbHMuZm9yRWFjaChsZXZlbCA9PiB7CiAgICBjb25zdCBvcmlnaW5hbENvbnNvbGVNZXRob2QgPSBvcmlnaW5hbENvbnNvbGVNZXRob2RzW2xldmVsXSA7CiAgICB3cmFwcGVkRnVuY3NbbGV2ZWxdID0gY29uc29sZVtsZXZlbF0gOwogICAgY29uc29sZVtsZXZlbF0gPSBvcmlnaW5hbENvbnNvbGVNZXRob2Q7CiAgfSk7CgogIHRyeSB7CiAgICByZXR1cm4gY2FsbGJhY2soKTsKICB9IGZpbmFsbHkgewogICAgLy8gUmV2ZXJ0IHJlc3RvcmF0aW9uIHRvIHdyYXBwZWQgc3RhdGUKICAgIHdyYXBwZWRMZXZlbHMuZm9yRWFjaChsZXZlbCA9PiB7CiAgICAgIGNvbnNvbGVbbGV2ZWxdID0gd3JhcHBlZEZ1bmNzW2xldmVsXSA7CiAgICB9KTsKICB9Cn0KCmZ1bmN0aW9uIG1ha2VMb2dnZXIoKSB7CiAgbGV0IGVuYWJsZWQgPSBmYWxzZTsKICBjb25zdCBsb2dnZXIgPSB7CiAgICBlbmFibGU6ICgpID0+IHsKICAgICAgZW5hYmxlZCA9IHRydWU7CiAgICB9LAogICAgZGlzYWJsZTogKCkgPT4gewogICAgICBlbmFibGVkID0gZmFsc2U7CiAgICB9LAogICAgaXNFbmFibGVkOiAoKSA9PiBlbmFibGVkLAogIH07CgogIGlmIChERUJVR19CVUlMRCQxKSB7CiAgICBDT05TT0xFX0xFVkVMUy5mb3JFYWNoKG5hbWUgPT4gewogICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueQogICAgICBsb2dnZXJbbmFtZV0gPSAoLi4uYXJncykgPT4gewogICAgICAgIGlmIChlbmFibGVkKSB7CiAgICAgICAgICBjb25zb2xlU2FuZGJveCgoKSA9PiB7CiAgICAgICAgICAgIEdMT0JBTF9PQkouY29uc29sZVtuYW1lXShgJHtQUkVGSVh9WyR7bmFtZX1dOmAsIC4uLmFyZ3MpOwogICAgICAgICAgfSk7CiAgICAgICAgfQogICAgICB9OwogICAgfSk7CiAgfSBlbHNlIHsKICAgIENPTlNPTEVfTEVWRUxTLmZvckVhY2gobmFtZSA9PiB7CiAgICAgIGxvZ2dlcltuYW1lXSA9ICgpID0+IHVuZGVmaW5lZDsKICAgIH0pOwogIH0KCiAgcmV0dXJuIGxvZ2dlciA7Cn0KCmNvbnN0IGxvZ2dlciA9IG1ha2VMb2dnZXIoKTsKCi8qKgogKiBSZW5kZXJzIHRoZSBzdHJpbmcgcmVwcmVzZW50YXRpb24gb2YgdGhpcyBEc24uCiAqCiAqIEJ5IGRlZmF1bHQsIHRoaXMgd2lsbCByZW5kZXIgdGhlIHB1YmxpYyByZXByZXNlbnRhdGlvbiB3aXRob3V0IHRoZSBwYXNzd29yZAogKiBjb21wb25lbnQuIFRvIGdldCB0aGUgZGVwcmVjYXRlZCBwcml2YXRlIHJlcHJlc2VudGF0aW9uLCBzZXQgYHdpdGhQYXNzd29yZGAKICogdG8gdHJ1ZS4KICoKICogQHBhcmFtIHdpdGhQYXNzd29yZCBXaGVuIHNldCB0byB0cnVlLCB0aGUgcGFzc3dvcmQgd2lsbCBiZSBpbmNsdWRlZC4KICovCmZ1bmN0aW9uIGRzblRvU3RyaW5nKGRzbiwgd2l0aFBhc3N3b3JkID0gZmFsc2UpIHsKICBjb25zdCB7IGhvc3QsIHBhdGgsIHBhc3MsIHBvcnQsIHByb2plY3RJZCwgcHJvdG9jb2wsIHB1YmxpY0tleSB9ID0gZHNuOwogIHJldHVybiAoCiAgICBgJHtwcm90b2NvbH06Ly8ke3B1YmxpY0tleX0ke3dpdGhQYXNzd29yZCAmJiBwYXNzID8gYDoke3Bhc3N9YCA6ICcnfWAgKwogICAgYEAke2hvc3R9JHtwb3J0ID8gYDoke3BvcnR9YCA6ICcnfS8ke3BhdGggPyBgJHtwYXRofS9gIDogcGF0aH0ke3Byb2plY3RJZH1gCiAgKTsKfQoKLyoqIEFuIGVycm9yIGVtaXR0ZWQgYnkgU2VudHJ5IFNES3MgYW5kIHJlbGF0ZWQgdXRpbGl0aWVzLiAqLwpjbGFzcyBTZW50cnlFcnJvciBleHRlbmRzIEVycm9yIHsKICAvKiogRGlzcGxheSBuYW1lIG9mIHRoaXMgZXJyb3IgaW5zdGFuY2UuICovCgogICBjb25zdHJ1Y3RvciggbWVzc2FnZSwgbG9nTGV2ZWwgPSAnd2FybicpIHsKICAgIHN1cGVyKG1lc3NhZ2UpO3RoaXMubWVzc2FnZSA9IG1lc3NhZ2U7CiAgICB0aGlzLm5hbWUgPSBuZXcudGFyZ2V0LnByb3RvdHlwZS5jb25zdHJ1Y3Rvci5uYW1lOwogICAgLy8gVGhpcyBzZXRzIHRoZSBwcm90b3R5cGUgdG8gYmUgYEVycm9yYCwgbm90IGBTZW50cnlFcnJvcmAuIEl0J3MgdW5jbGVhciB3aHkgd2UgZG8gdGhpcywgYnV0IGNvbW1lbnRpbmcgdGhpcyBsaW5lCiAgICAvLyBvdXQgY2F1c2VzIHZhcmlvdXMgKHNlZW1pbmdseSB0b3RhbGx5IHVucmVsYXRlZCkgcGxheXdyaWdodCB0ZXN0cyBjb25zaXN0ZW50bHkgdGltZSBvdXQuIEZZSSwgdGhpcyBtYWtlcwogICAgLy8gaW5zdGFuY2VzIG9mIGBTZW50cnlFcnJvcmAgZmFpbCBgb2JqIGluc3RhbmNlb2YgU2VudHJ5RXJyb3JgIGNoZWNrcy4KICAgIE9iamVjdC5zZXRQcm90b3R5cGVPZih0aGlzLCBuZXcudGFyZ2V0LnByb3RvdHlwZSk7CiAgICB0aGlzLmxvZ0xldmVsID0gbG9nTGV2ZWw7CiAgfQp9CgovKioKICogRW5jb2RlcyBnaXZlbiBvYmplY3QgaW50byB1cmwtZnJpZW5kbHkgZm9ybWF0CiAqCiAqIEBwYXJhbSBvYmplY3QgQW4gb2JqZWN0IHRoYXQgY29udGFpbnMgc2VyaWFsaXphYmxlIHZhbHVlcwogKiBAcmV0dXJucyBzdHJpbmcgRW5jb2RlZAogKi8KZnVuY3Rpb24gdXJsRW5jb2RlKG9iamVjdCkgewogIHJldHVybiBPYmplY3Qua2V5cyhvYmplY3QpCiAgICAubWFwKGtleSA9PiBgJHtlbmNvZGVVUklDb21wb25lbnQoa2V5KX09JHtlbmNvZGVVUklDb21wb25lbnQob2JqZWN0W2tleV0pfWApCiAgICAuam9pbignJicpOwp9CgovKioKICogVHJhbnNmb3JtcyBhbnkgYEVycm9yYCBvciBgRXZlbnRgIGludG8gYSBwbGFpbiBvYmplY3Qgd2l0aCBhbGwgb2YgdGhlaXIgZW51bWVyYWJsZSBwcm9wZXJ0aWVzLCBhbmQgc29tZSBvZiB0aGVpcgogKiBub24tZW51bWVyYWJsZSBwcm9wZXJ0aWVzIGF0dGFjaGVkLgogKgogKiBAcGFyYW0gdmFsdWUgSW5pdGlhbCBzb3VyY2UgdGhhdCB3ZSBoYXZlIHRvIHRyYW5zZm9ybSBpbiBvcmRlciBmb3IgaXQgdG8gYmUgdXNhYmxlIGJ5IHRoZSBzZXJpYWxpemVyCiAqIEByZXR1cm5zIEFuIEV2ZW50IG9yIEVycm9yIHR1cm5lZCBpbnRvIGFuIG9iamVjdCAtIG9yIHRoZSB2YWx1ZSBhcmd1cm1lbnQgaXRzZWxmLCB3aGVuIHZhbHVlIGlzIG5laXRoZXIgYW4gRXZlbnQgbm9yCiAqICBhbiBFcnJvci4KICovCmZ1bmN0aW9uIGNvbnZlcnRUb1BsYWluT2JqZWN0KAogIHZhbHVlLAopCgogewogIGlmIChpc0Vycm9yKHZhbHVlKSkgewogICAgcmV0dXJuIHsKICAgICAgbWVzc2FnZTogdmFsdWUubWVzc2FnZSwKICAgICAgbmFtZTogdmFsdWUubmFtZSwKICAgICAgc3RhY2s6IHZhbHVlLnN0YWNrLAogICAgICAuLi5nZXRPd25Qcm9wZXJ0aWVzKHZhbHVlKSwKICAgIH07CiAgfSBlbHNlIGlmIChpc0V2ZW50KHZhbHVlKSkgewogICAgY29uc3QgbmV3T2JqCgogPSB7CiAgICAgIHR5cGU6IHZhbHVlLnR5cGUsCiAgICAgIHRhcmdldDogc2VyaWFsaXplRXZlbnRUYXJnZXQodmFsdWUudGFyZ2V0KSwKICAgICAgY3VycmVudFRhcmdldDogc2VyaWFsaXplRXZlbnRUYXJnZXQodmFsdWUuY3VycmVudFRhcmdldCksCiAgICAgIC4uLmdldE93blByb3BlcnRpZXModmFsdWUpLAogICAgfTsKCiAgICBpZiAodHlwZW9mIEN1c3RvbUV2ZW50ICE9PSAndW5kZWZpbmVkJyAmJiBpc0luc3RhbmNlT2YodmFsdWUsIEN1c3RvbUV2ZW50KSkgewogICAgICBuZXdPYmouZGV0YWlsID0gdmFsdWUuZGV0YWlsOwogICAgfQoKICAgIHJldHVybiBuZXdPYmo7CiAgfSBlbHNlIHsKICAgIHJldHVybiB2YWx1ZTsKICB9Cn0KCi8qKiBDcmVhdGVzIGEgc3RyaW5nIHJlcHJlc2VudGF0aW9uIG9mIHRoZSB0YXJnZXQgb2YgYW4gYEV2ZW50YCBvYmplY3QgKi8KZnVuY3Rpb24gc2VyaWFsaXplRXZlbnRUYXJnZXQodGFyZ2V0KSB7CiAgdHJ5IHsKICAgIHJldHVybiBpc0VsZW1lbnQodGFyZ2V0KSA/IGh0bWxUcmVlQXNTdHJpbmcodGFyZ2V0KSA6IE9iamVjdC5wcm90b3R5cGUudG9TdHJpbmcuY2FsbCh0YXJnZXQpOwogIH0gY2F0Y2ggKF9vTykgewogICAgcmV0dXJuICc8dW5rbm93bj4nOwogIH0KfQoKLyoqIEZpbHRlcnMgb3V0IGFsbCBidXQgYW4gb2JqZWN0J3Mgb3duIHByb3BlcnRpZXMgKi8KZnVuY3Rpb24gZ2V0T3duUHJvcGVydGllcyhvYmopIHsKICBpZiAodHlwZW9mIG9iaiA9PT0gJ29iamVjdCcgJiYgb2JqICE9PSBudWxsKSB7CiAgICBjb25zdCBleHRyYWN0ZWRQcm9wcyA9IHt9OwogICAgZm9yIChjb25zdCBwcm9wZXJ0eSBpbiBvYmopIHsKICAgICAgaWYgKE9iamVjdC5wcm90b3R5cGUuaGFzT3duUHJvcGVydHkuY2FsbChvYmosIHByb3BlcnR5KSkgewogICAgICAgIGV4dHJhY3RlZFByb3BzW3Byb3BlcnR5XSA9IChvYmogKVtwcm9wZXJ0eV07CiAgICAgIH0KICAgIH0KICAgIHJldHVybiBleHRyYWN0ZWRQcm9wczsKICB9IGVsc2UgewogICAgcmV0dXJuIHt9OwogIH0KfQoKLyoqCiAqIEdpdmVuIGFueSBvYmplY3QsIHJldHVybiBhIG5ldyBvYmplY3QgaGF2aW5nIHJlbW92ZWQgYWxsIGZpZWxkcyB3aG9zZSB2YWx1ZSB3YXMgYHVuZGVmaW5lZGAuCiAqIFdvcmtzIHJlY3Vyc2l2ZWx5IG9uIG9iamVjdHMgYW5kIGFycmF5cy4KICoKICogQXR0ZW50aW9uOiBUaGlzIGZ1bmN0aW9uIGtlZXBzIGNpcmN1bGFyIHJlZmVyZW5jZXMgaW4gdGhlIHJldHVybmVkIG9iamVjdC4KICovCmZ1bmN0aW9uIGRyb3BVbmRlZmluZWRLZXlzKGlucHV0VmFsdWUpIHsKICAvLyBUaGlzIG1hcCBrZWVwcyB0cmFjayBvZiB3aGF0IGFscmVhZHkgdmlzaXRlZCBub2RlcyBtYXAgdG8uCiAgLy8gT3VyIFNldCAtIGJhc2VkIG1lbW9CdWlsZGVyIGRvZXNuJ3Qgd29yayBoZXJlIGJlY2F1c2Ugd2Ugd2FudCB0byB0aGUgb3V0cHV0IG9iamVjdCB0byBoYXZlIHRoZSBzYW1lIGNpcmN1bGFyCiAgLy8gcmVmZXJlbmNlcyBhcyB0aGUgaW5wdXQgb2JqZWN0LgogIGNvbnN0IG1lbW9pemF0aW9uTWFwID0gbmV3IE1hcCgpOwoKICAvLyBUaGlzIGZ1bmN0aW9uIGp1c3QgcHJveGllcyBgX2Ryb3BVbmRlZmluZWRLZXlzYCB0byBrZWVwIHRoZSBgbWVtb0J1aWxkZXJgIG91dCBvZiB0aGlzIGZ1bmN0aW9uJ3MgQVBJCiAgcmV0dXJuIF9kcm9wVW5kZWZpbmVkS2V5cyhpbnB1dFZhbHVlLCBtZW1vaXphdGlvbk1hcCk7Cn0KCmZ1bmN0aW9uIF9kcm9wVW5kZWZpbmVkS2V5cyhpbnB1dFZhbHVlLCBtZW1vaXphdGlvbk1hcCkgewogIGlmIChpc1Bvam8oaW5wdXRWYWx1ZSkpIHsKICAgIC8vIElmIHRoaXMgbm9kZSBoYXMgYWxyZWFkeSBiZWVuIHZpc2l0ZWQgZHVlIHRvIGEgY2lyY3VsYXIgcmVmZXJlbmNlLCByZXR1cm4gdGhlIG9iamVjdCBpdCB3YXMgbWFwcGVkIHRvIGluIHRoZSBuZXcgb2JqZWN0CiAgICBjb25zdCBtZW1vVmFsID0gbWVtb2l6YXRpb25NYXAuZ2V0KGlucHV0VmFsdWUpOwogICAgaWYgKG1lbW9WYWwgIT09IHVuZGVmaW5lZCkgewogICAgICByZXR1cm4gbWVtb1ZhbCA7CiAgICB9CgogICAgY29uc3QgcmV0dXJuVmFsdWUgPSB7fTsKICAgIC8vIFN0b3JlIHRoZSBtYXBwaW5nIG9mIHRoaXMgdmFsdWUgaW4gY2FzZSB3ZSB2aXNpdCBpdCBhZ2FpbiwgaW4gY2FzZSBvZiBjaXJjdWxhciBkYXRhCiAgICBtZW1vaXphdGlvbk1hcC5zZXQoaW5wdXRWYWx1ZSwgcmV0dXJuVmFsdWUpOwoKICAgIGZvciAoY29uc3Qga2V5IG9mIE9iamVjdC5rZXlzKGlucHV0VmFsdWUpKSB7CiAgICAgIGlmICh0eXBlb2YgaW5wdXRWYWx1ZVtrZXldICE9PSAndW5kZWZpbmVkJykgewogICAgICAgIHJldHVyblZhbHVlW2tleV0gPSBfZHJvcFVuZGVmaW5lZEtleXMoaW5wdXRWYWx1ZVtrZXldLCBtZW1vaXphdGlvbk1hcCk7CiAgICAgIH0KICAgIH0KCiAgICByZXR1cm4gcmV0dXJuVmFsdWUgOwogIH0KCiAgaWYgKEFycmF5LmlzQXJyYXkoaW5wdXRWYWx1ZSkpIHsKICAgIC8vIElmIHRoaXMgbm9kZSBoYXMgYWxyZWFkeSBiZWVuIHZpc2l0ZWQgZHVlIHRvIGEgY2lyY3VsYXIgcmVmZXJlbmNlLCByZXR1cm4gdGhlIGFycmF5IGl0IHdhcyBtYXBwZWQgdG8gaW4gdGhlIG5ldyBvYmplY3QKICAgIGNvbnN0IG1lbW9WYWwgPSBtZW1vaXphdGlvbk1hcC5nZXQoaW5wdXRWYWx1ZSk7CiAgICBpZiAobWVtb1ZhbCAhPT0gdW5kZWZpbmVkKSB7CiAgICAgIHJldHVybiBtZW1vVmFsIDsKICAgIH0KCiAgICBjb25zdCByZXR1cm5WYWx1ZSA9IFtdOwogICAgLy8gU3RvcmUgdGhlIG1hcHBpbmcgb2YgdGhpcyB2YWx1ZSBpbiBjYXNlIHdlIHZpc2l0IGl0IGFnYWluLCBpbiBjYXNlIG9mIGNpcmN1bGFyIGRhdGEKICAgIG1lbW9pemF0aW9uTWFwLnNldChpbnB1dFZhbHVlLCByZXR1cm5WYWx1ZSk7CgogICAgaW5wdXRWYWx1ZS5mb3JFYWNoKChpdGVtKSA9PiB7CiAgICAgIHJldHVyblZhbHVlLnB1c2goX2Ryb3BVbmRlZmluZWRLZXlzKGl0ZW0sIG1lbW9pemF0aW9uTWFwKSk7CiAgICB9KTsKCiAgICByZXR1cm4gcmV0dXJuVmFsdWUgOwogIH0KCiAgcmV0dXJuIGlucHV0VmFsdWU7Cn0KCmZ1bmN0aW9uIGlzUG9qbyhpbnB1dCkgewogIGlmICghaXNQbGFpbk9iamVjdChpbnB1dCkpIHsKICAgIHJldHVybiBmYWxzZTsKICB9CgogIHRyeSB7CiAgICBjb25zdCBuYW1lID0gKE9iamVjdC5nZXRQcm90b3R5cGVPZihpbnB1dCkgKS5jb25zdHJ1Y3Rvci5uYW1lOwogICAgcmV0dXJuICFuYW1lIHx8IG5hbWUgPT09ICdPYmplY3QnOwogIH0gY2F0Y2ggKGUpIHsKICAgIHJldHVybiB0cnVlOwogIH0KfQoKLyoqCiAqIERvZXMgdGhpcyBmaWxlbmFtZSBsb29rIGxpa2UgaXQncyBwYXJ0IG9mIHRoZSBhcHAgY29kZT8KICovCmZ1bmN0aW9uIGZpbGVuYW1lSXNJbkFwcChmaWxlbmFtZSwgaXNOYXRpdmUgPSBmYWxzZSkgewogIGNvbnN0IGlzSW50ZXJuYWwgPQogICAgaXNOYXRpdmUgfHwKICAgIChmaWxlbmFtZSAmJgogICAgICAvLyBJdCdzIG5vdCBpbnRlcm5hbCBpZiBpdCdzIGFuIGFic29sdXRlIGxpbnV4IHBhdGgKICAgICAgIWZpbGVuYW1lLnN0YXJ0c1dpdGgoJy8nKSAmJgogICAgICAvLyBJdCdzIG5vdCBpbnRlcm5hbCBpZiBpdCdzIGFuIGFic29sdXRlIHdpbmRvd3MgcGF0aAogICAgICAhZmlsZW5hbWUubWF0Y2goL15bQS1aXTovKSAmJgogICAgICAvLyBJdCdzIG5vdCBpbnRlcm5hbCBpZiB0aGUgcGF0aCBpcyBzdGFydGluZyB3aXRoIGEgZG90CiAgICAgICFmaWxlbmFtZS5zdGFydHNXaXRoKCcuJykgJiYKICAgICAgLy8gSXQncyBub3QgaW50ZXJuYWwgaWYgdGhlIGZyYW1lIGhhcyBhIHByb3RvY29sLiBJbiBub2RlLCB0aGlzIGlzIHVzdWFsbHkgdGhlIGNhc2UgaWYgdGhlIGZpbGUgZ290IHByZS1wcm9jZXNzZWQgd2l0aCBhIGJ1bmRsZXIgbGlrZSB3ZWJwYWNrCiAgICAgICFmaWxlbmFtZS5tYXRjaCgvXlthLXpBLVpdKFthLXpBLVowLTkuXC0rXSkqOlwvXC8vKSk7IC8vIFNjaGVtYSBmcm9tOiBodHRwczovL3N0YWNrb3ZlcmZsb3cuY29tL2EvMzY0MTc4MgoKICAvLyBpbl9hcHAgaXMgYWxsIHRoYXQncyBub3QgYW4gaW50ZXJuYWwgTm9kZSBmdW5jdGlvbiBvciBhIG1vZHVsZSB3aXRoaW4gbm9kZV9tb2R1bGVzCiAgLy8gbm90ZSB0aGF0IGlzTmF0aXZlIGFwcGVhcnMgdG8gcmV0dXJuIHRydWUgZXZlbiBmb3Igbm9kZSBjb3JlIGxpYnJhcmllcwogIC8vIHNlZSBodHRwczovL2dpdGh1Yi5jb20vZ2V0c2VudHJ5L3JhdmVuLW5vZGUvaXNzdWVzLzE3NgoKICByZXR1cm4gIWlzSW50ZXJuYWwgJiYgZmlsZW5hbWUgIT09IHVuZGVmaW5lZCAmJiAhZmlsZW5hbWUuaW5jbHVkZXMoJ25vZGVfbW9kdWxlcy8nKTsKfQoKY29uc3QgU1RBQ0tUUkFDRV9GUkFNRV9MSU1JVCA9IDUwOwpjb25zdCBTVFJJUF9GUkFNRV9SRUdFWFAgPSAvY2FwdHVyZU1lc3NhZ2V8Y2FwdHVyZUV4Y2VwdGlvbi87CgovKioKICogUmVtb3ZlcyBTZW50cnkgZnJhbWVzIGZyb20gdGhlIHRvcCBhbmQgYm90dG9tIG9mIHRoZSBzdGFjayBpZiBwcmVzZW50IGFuZCBlbmZvcmNlcyBhIGxpbWl0IG9mIG1heCBudW1iZXIgb2YgZnJhbWVzLgogKiBBc3N1bWVzIHN0YWNrIGlucHV0IGlzIG9yZGVyZWQgZnJvbSB0b3AgdG8gYm90dG9tIGFuZCByZXR1cm5zIHRoZSByZXZlcnNlIHJlcHJlc2VudGF0aW9uIHNvIGNhbGwgc2l0ZSBvZiB0aGUKICogZnVuY3Rpb24gdGhhdCBjYXVzZWQgdGhlIGNyYXNoIGlzIHRoZSBsYXN0IGZyYW1lIGluIHRoZSBhcnJheS4KICogQGhpZGRlbgogKi8KZnVuY3Rpb24gc3RyaXBTZW50cnlGcmFtZXNBbmRSZXZlcnNlKHN0YWNrKSB7CiAgaWYgKCFzdGFjay5sZW5ndGgpIHsKICAgIHJldHVybiBbXTsKICB9CgogIGNvbnN0IGxvY2FsU3RhY2sgPSBBcnJheS5mcm9tKHN0YWNrKTsKCiAgLy8gSWYgc3RhY2sgc3RhcnRzIHdpdGggb25lIG9mIG91ciBBUEkgY2FsbHMsIHJlbW92ZSBpdCAoc3RhcnRzLCBtZWFuaW5nIGl0J3MgdGhlIHRvcCBvZiB0aGUgc3RhY2sgLSBha2EgbGFzdCBjYWxsKQogIGlmICgvc2VudHJ5V3JhcHBlZC8udGVzdChsb2NhbFN0YWNrW2xvY2FsU3RhY2subGVuZ3RoIC0gMV0uZnVuY3Rpb24gfHwgJycpKSB7CiAgICBsb2NhbFN0YWNrLnBvcCgpOwogIH0KCiAgLy8gUmV2ZXJzaW5nIGluIHRoZSBtaWRkbGUgb2YgdGhlIHByb2NlZHVyZSBhbGxvd3MgdXMgdG8ganVzdCBwb3AgdGhlIHZhbHVlcyBvZmYgdGhlIHN0YWNrCiAgbG9jYWxTdGFjay5yZXZlcnNlKCk7CgogIC8vIElmIHN0YWNrIGVuZHMgd2l0aCBvbmUgb2Ygb3VyIGludGVybmFsIEFQSSBjYWxscywgcmVtb3ZlIGl0IChlbmRzLCBtZWFuaW5nIGl0J3MgdGhlIGJvdHRvbSBvZiB0aGUgc3RhY2sgLSBha2EgdG9wLW1vc3QgY2FsbCkKICBpZiAoU1RSSVBfRlJBTUVfUkVHRVhQLnRlc3QobG9jYWxTdGFja1tsb2NhbFN0YWNrLmxlbmd0aCAtIDFdLmZ1bmN0aW9uIHx8ICcnKSkgewogICAgbG9jYWxTdGFjay5wb3AoKTsKCiAgICAvLyBXaGVuIHVzaW5nIHN5bnRoZXRpYyBldmVudHMsIHdlIHdpbGwgaGF2ZSBhIDIgbGV2ZWxzIGRlZXAgc3RhY2ssIGFzIGBuZXcgRXJyb3IoJ1NlbnRyeSBzeW50aGV0aWNFeGNlcHRpb24nKWAKICAgIC8vIGlzIHByb2R1Y2VkIHdpdGhpbiB0aGUgaHViIGl0c2VsZiwgbWFraW5nIGl0OgogICAgLy8KICAgIC8vICAgU2VudHJ5LmNhcHR1cmVFeGNlcHRpb24oKQogICAgLy8gICBnZXRDdXJyZW50SHViKCkuY2FwdHVyZUV4Y2VwdGlvbigpCiAgICAvLwogICAgLy8gaW5zdGVhZCBvZiBqdXN0IHRoZSB0b3AgYFNlbnRyeWAgY2FsbCBpdHNlbGYuCiAgICAvLyBUaGlzIGZvcmNlcyB1cyB0byBwb3NzaWJseSBzdHJpcCBhbiBhZGRpdGlvbmFsIGZyYW1lIGluIHRoZSBleGFjdCBzYW1lIHdhcyBhcyBhYm92ZS4KICAgIGlmIChTVFJJUF9GUkFNRV9SRUdFWFAudGVzdChsb2NhbFN0YWNrW2xvY2FsU3RhY2subGVuZ3RoIC0gMV0uZnVuY3Rpb24gfHwgJycpKSB7CiAgICAgIGxvY2FsU3RhY2sucG9wKCk7CiAgICB9CiAgfQoKICByZXR1cm4gbG9jYWxTdGFjay5zbGljZSgwLCBTVEFDS1RSQUNFX0ZSQU1FX0xJTUlUKS5tYXAoZnJhbWUgPT4gKHsKICAgIC4uLmZyYW1lLAogICAgZmlsZW5hbWU6IGZyYW1lLmZpbGVuYW1lIHx8IGxvY2FsU3RhY2tbbG9jYWxTdGFjay5sZW5ndGggLSAxXS5maWxlbmFtZSwKICAgIGZ1bmN0aW9uOiBmcmFtZS5mdW5jdGlvbiB8fCAnPycsCiAgfSkpOwp9Cgpjb25zdCBkZWZhdWx0RnVuY3Rpb25OYW1lID0gJzxhbm9ueW1vdXM+JzsKCi8qKgogKiBTYWZlbHkgZXh0cmFjdCBmdW5jdGlvbiBuYW1lIGZyb20gaXRzZWxmCiAqLwpmdW5jdGlvbiBnZXRGdW5jdGlvbk5hbWUoZm4pIHsKICB0cnkgewogICAgaWYgKCFmbiB8fCB0eXBlb2YgZm4gIT09ICdmdW5jdGlvbicpIHsKICAgICAgcmV0dXJuIGRlZmF1bHRGdW5jdGlvbk5hbWU7CiAgICB9CiAgICByZXR1cm4gZm4ubmFtZSB8fCBkZWZhdWx0RnVuY3Rpb25OYW1lOwogIH0gY2F0Y2ggKGUpIHsKICAgIC8vIEp1c3QgYWNjZXNzaW5nIGN1c3RvbSBwcm9wcyBpbiBzb21lIFNlbGVuaXVtIGVudmlyb25tZW50cwogICAgLy8gY2FuIGNhdXNlIGEgIlBlcm1pc3Npb24gZGVuaWVkIiBleGNlcHRpb24gKHNlZSByYXZlbi1qcyM0OTUpLgogICAgcmV0dXJuIGRlZmF1bHRGdW5jdGlvbk5hbWU7CiAgfQp9CgovKioKICogVVVJRDQgZ2VuZXJhdG9yCiAqCiAqIEByZXR1cm5zIHN0cmluZyBHZW5lcmF0ZWQgVVVJRDQuCiAqLwpmdW5jdGlvbiB1dWlkNCgpIHsKICBjb25zdCBnYmwgPSBHTE9CQUxfT0JKIDsKICBjb25zdCBjcnlwdG8gPSBnYmwuY3J5cHRvIHx8IGdibC5tc0NyeXB0bzsKCiAgbGV0IGdldFJhbmRvbUJ5dGUgPSAoKSA9PiBNYXRoLnJhbmRvbSgpICogMTY7CiAgdHJ5IHsKICAgIGlmIChjcnlwdG8gJiYgY3J5cHRvLnJhbmRvbVVVSUQpIHsKICAgICAgcmV0dXJuIGNyeXB0by5yYW5kb21VVUlEKCkucmVwbGFjZSgvLS9nLCAnJyk7CiAgICB9CiAgICBpZiAoY3J5cHRvICYmIGNyeXB0by5nZXRSYW5kb21WYWx1ZXMpIHsKICAgICAgZ2V0UmFuZG9tQnl0ZSA9ICgpID0+IHsKICAgICAgICAvLyBjcnlwdG8uZ2V0UmFuZG9tVmFsdWVzIG1pZ2h0IHJldHVybiB1bmRlZmluZWQgaW5zdGVhZCBvZiB0aGUgdHlwZWQgYXJyYXkKICAgICAgICAvLyBpbiBvbGQgQ2hyb21pdW0gdmVyc2lvbnMgKGUuZy4gMjMuMC4xMjM1LjAgKDE1MTQyMikpCiAgICAgICAgLy8gSG93ZXZlciwgYHR5cGVkQXJyYXlgIGlzIHN0aWxsIGZpbGxlZCBpbi1wbGFjZS4KICAgICAgICAvLyBAc2VlIGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvV2ViL0FQSS9DcnlwdG8vZ2V0UmFuZG9tVmFsdWVzI3R5cGVkYXJyYXkKICAgICAgICBjb25zdCB0eXBlZEFycmF5ID0gbmV3IFVpbnQ4QXJyYXkoMSk7CiAgICAgICAgY3J5cHRvLmdldFJhbmRvbVZhbHVlcyh0eXBlZEFycmF5KTsKICAgICAgICByZXR1cm4gdHlwZWRBcnJheVswXTsKICAgICAgfTsKICAgIH0KICB9IGNhdGNoIChfKSB7CiAgICAvLyBzb21lIHJ1bnRpbWVzIGNhbiBjcmFzaCBpbnZva2luZyBjcnlwdG8KICAgIC8vIGh0dHBzOi8vZ2l0aHViLmNvbS9nZXRzZW50cnkvc2VudHJ5LWphdmFzY3JpcHQvaXNzdWVzLzg5MzUKICB9CgogIC8vIGh0dHA6Ly9zdGFja292ZXJmbG93LmNvbS9xdWVzdGlvbnMvMTA1MDM0L2hvdy10by1jcmVhdGUtYS1ndWlkLXV1aWQtaW4tamF2YXNjcmlwdC8yMTE3NTIzIzIxMTc1MjMKICAvLyBDb25jYXRlbmF0aW5nIHRoZSBmb2xsb3dpbmcgbnVtYmVycyBhcyBzdHJpbmdzIHJlc3VsdHMgaW4gJzEwMDAwMDAwMTAwMDQwMDA4MDAwMTAwMDAwMDAwMDAwJwogIHJldHVybiAoKFsxZTddICkgKyAxZTMgKyA0ZTMgKyA4ZTMgKyAxZTExKS5yZXBsYWNlKC9bMDE4XS9nLCBjID0+CiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tYml0d2lzZQogICAgKChjICkgXiAoKGdldFJhbmRvbUJ5dGUoKSAmIDE1KSA+PiAoKGMgKSAvIDQpKSkudG9TdHJpbmcoMTYpLAogICk7Cn0KCi8qIGVzbGludC1kaXNhYmxlIEB0eXBlc2NyaXB0LWVzbGludC9uby11bnNhZmUtbWVtYmVyLWFjY2VzcyAqLwovKiBlc2xpbnQtZGlzYWJsZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZXhwbGljaXQtYW55ICovCgovKioKICogSGVscGVyIHRvIGRlY3ljbGUganNvbiBvYmplY3RzCiAqLwpmdW5jdGlvbiBtZW1vQnVpbGRlcigpIHsKICBjb25zdCBoYXNXZWFrU2V0ID0gdHlwZW9mIFdlYWtTZXQgPT09ICdmdW5jdGlvbic7CiAgY29uc3QgaW5uZXIgPSBoYXNXZWFrU2V0ID8gbmV3IFdlYWtTZXQoKSA6IFtdOwogIGZ1bmN0aW9uIG1lbW9pemUob2JqKSB7CiAgICBpZiAoaGFzV2Vha1NldCkgewogICAgICBpZiAoaW5uZXIuaGFzKG9iaikpIHsKICAgICAgICByZXR1cm4gdHJ1ZTsKICAgICAgfQogICAgICBpbm5lci5hZGQob2JqKTsKICAgICAgcmV0dXJuIGZhbHNlOwogICAgfQogICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9wcmVmZXItZm9yLW9mCiAgICBmb3IgKGxldCBpID0gMDsgaSA8IGlubmVyLmxlbmd0aDsgaSsrKSB7CiAgICAgIGNvbnN0IHZhbHVlID0gaW5uZXJbaV07CiAgICAgIGlmICh2YWx1ZSA9PT0gb2JqKSB7CiAgICAgICAgcmV0dXJuIHRydWU7CiAgICAgIH0KICAgIH0KICAgIGlubmVyLnB1c2gob2JqKTsKICAgIHJldHVybiBmYWxzZTsKICB9CgogIGZ1bmN0aW9uIHVubWVtb2l6ZShvYmopIHsKICAgIGlmIChoYXNXZWFrU2V0KSB7CiAgICAgIGlubmVyLmRlbGV0ZShvYmopOwogICAgfSBlbHNlIHsKICAgICAgZm9yIChsZXQgaSA9IDA7IGkgPCBpbm5lci5sZW5ndGg7IGkrKykgewogICAgICAgIGlmIChpbm5lcltpXSA9PT0gb2JqKSB7CiAgICAgICAgICBpbm5lci5zcGxpY2UoaSwgMSk7CiAgICAgICAgICBicmVhazsKICAgICAgICB9CiAgICAgIH0KICAgIH0KICB9CiAgcmV0dXJuIFttZW1vaXplLCB1bm1lbW9pemVdOwp9CgovKioKICogUmVjdXJzaXZlbHkgbm9ybWFsaXplcyB0aGUgZ2l2ZW4gb2JqZWN0LgogKgogKiAtIENyZWF0ZXMgYSBjb3B5IHRvIHByZXZlbnQgb3JpZ2luYWwgaW5wdXQgbXV0YXRpb24KICogLSBTa2lwcyBub24tZW51bWVyYWJsZSBwcm9wZXJ0aWVzCiAqIC0gV2hlbiBzdHJpbmdpZnlpbmcsIGNhbGxzIGB0b0pTT05gIGlmIGltcGxlbWVudGVkCiAqIC0gUmVtb3ZlcyBjaXJjdWxhciByZWZlcmVuY2VzCiAqIC0gVHJhbnNsYXRlcyBub24tc2VyaWFsaXphYmxlIHZhbHVlcyAoYHVuZGVmaW5lZGAvYE5hTmAvZnVuY3Rpb25zKSB0byBzZXJpYWxpemFibGUgZm9ybWF0CiAqIC0gVHJhbnNsYXRlcyBrbm93biBnbG9iYWwgb2JqZWN0cy9jbGFzc2VzIHRvIGEgc3RyaW5nIHJlcHJlc2VudGF0aW9ucwogKiAtIFRha2VzIGNhcmUgb2YgYEVycm9yYCBvYmplY3Qgc2VyaWFsaXphdGlvbgogKiAtIE9wdGlvbmFsbHkgbGltaXRzIGRlcHRoIG9mIGZpbmFsIG91dHB1dAogKiAtIE9wdGlvbmFsbHkgbGltaXRzIG51bWJlciBvZiBwcm9wZXJ0aWVzL2VsZW1lbnRzIGluY2x1ZGVkIGluIGFueSBzaW5nbGUgb2JqZWN0L2FycmF5CiAqCiAqIEBwYXJhbSBpbnB1dCBUaGUgb2JqZWN0IHRvIGJlIG5vcm1hbGl6ZWQuCiAqIEBwYXJhbSBkZXB0aCBUaGUgbWF4IGRlcHRoIHRvIHdoaWNoIHRvIG5vcm1hbGl6ZSB0aGUgb2JqZWN0LiAoQW55dGhpbmcgZGVlcGVyIHN0cmluZ2lmaWVkIHdob2xlLikKICogQHBhcmFtIG1heFByb3BlcnRpZXMgVGhlIG1heCBudW1iZXIgb2YgZWxlbWVudHMgb3IgcHJvcGVydGllcyB0byBiZSBpbmNsdWRlZCBpbiBhbnkgc2luZ2xlIGFycmF5IG9yCiAqIG9iamVjdCBpbiB0aGUgbm9ybWFsbGl6ZWQgb3V0cHV0LgogKiBAcmV0dXJucyBBIG5vcm1hbGl6ZWQgdmVyc2lvbiBvZiB0aGUgb2JqZWN0LCBvciBgIioqbm9uLXNlcmlhbGl6YWJsZSoqImAgaWYgYW55IGVycm9ycyBhcmUgdGhyb3duIGR1cmluZyBub3JtYWxpemF0aW9uLgogKi8KLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEB0eXBlc2NyaXB0LWVzbGludC9uby1leHBsaWNpdC1hbnkKZnVuY3Rpb24gbm9ybWFsaXplKGlucHV0LCBkZXB0aCA9IDEwMCwgbWF4UHJvcGVydGllcyA9ICtJbmZpbml0eSkgewogIHRyeSB7CiAgICAvLyBzaW5jZSB3ZSdyZSBhdCB0aGUgb3V0ZXJtb3N0IGxldmVsLCB3ZSBkb24ndCBwcm92aWRlIGEga2V5CiAgICByZXR1cm4gdmlzaXQoJycsIGlucHV0LCBkZXB0aCwgbWF4UHJvcGVydGllcyk7CiAgfSBjYXRjaCAoZXJyKSB7CiAgICByZXR1cm4geyBFUlJPUjogYCoqbm9uLXNlcmlhbGl6YWJsZSoqICgke2Vycn0pYCB9OwogIH0KfQoKLyoqCiAqIFZpc2l0cyBhIG5vZGUgdG8gcGVyZm9ybSBub3JtYWxpemF0aW9uIG9uIGl0CiAqCiAqIEBwYXJhbSBrZXkgVGhlIGtleSBjb3JyZXNwb25kaW5nIHRvIHRoZSBnaXZlbiBub2RlCiAqIEBwYXJhbSB2YWx1ZSBUaGUgbm9kZSB0byBiZSB2aXNpdGVkCiAqIEBwYXJhbSBkZXB0aCBPcHRpb25hbCBudW1iZXIgaW5kaWNhdGluZyB0aGUgbWF4aW11bSByZWN1cnNpb24gZGVwdGgKICogQHBhcmFtIG1heFByb3BlcnRpZXMgT3B0aW9uYWwgbWF4aW11bSBudW1iZXIgb2YgcHJvcGVydGllcy9lbGVtZW50cyBpbmNsdWRlZCBpbiBhbnkgc2luZ2xlIG9iamVjdC9hcnJheQogKiBAcGFyYW0gbWVtbyBPcHRpb25hbCBNZW1vIGNsYXNzIGhhbmRsaW5nIGRlY3ljbGluZwogKi8KZnVuY3Rpb24gdmlzaXQoCiAga2V5LAogIHZhbHVlLAogIGRlcHRoID0gK0luZmluaXR5LAogIG1heFByb3BlcnRpZXMgPSArSW5maW5pdHksCiAgbWVtbyA9IG1lbW9CdWlsZGVyKCksCikgewogIGNvbnN0IFttZW1vaXplLCB1bm1lbW9pemVdID0gbWVtbzsKCiAgLy8gR2V0IHRoZSBzaW1wbGUgY2FzZXMgb3V0IG9mIHRoZSB3YXkgZmlyc3QKICBpZiAoCiAgICB2YWx1ZSA9PSBudWxsIHx8IC8vIHRoaXMgbWF0Y2hlcyBudWxsIGFuZCB1bmRlZmluZWQgLT4gZXFlcSBub3QgZXFlcWVxCiAgICAoWydudW1iZXInLCAnYm9vbGVhbicsICdzdHJpbmcnXS5pbmNsdWRlcyh0eXBlb2YgdmFsdWUpICYmICFpc05hTiQxKHZhbHVlKSkKICApIHsKICAgIHJldHVybiB2YWx1ZSA7CiAgfQoKICBjb25zdCBzdHJpbmdpZmllZCA9IHN0cmluZ2lmeVZhbHVlKGtleSwgdmFsdWUpOwoKICAvLyBBbnl0aGluZyB3ZSBjb3VsZCBwb3RlbnRpYWxseSBkaWcgaW50byBtb3JlIChvYmplY3RzIG9yIGFycmF5cykgd2lsbCBoYXZlIGNvbWUgYmFjayBhcyBgIltvYmplY3QgWFhYWF0iYC4KICAvLyBFdmVyeXRoaW5nIGVsc2Ugd2lsbCBoYXZlIGFscmVhZHkgYmVlbiBzZXJpYWxpemVkLCBzbyBpZiB3ZSBkb24ndCBzZWUgdGhhdCBwYXR0ZXJuLCB3ZSdyZSBkb25lLgogIGlmICghc3RyaW5naWZpZWQuc3RhcnRzV2l0aCgnW29iamVjdCAnKSkgewogICAgcmV0dXJuIHN0cmluZ2lmaWVkOwogIH0KCiAgLy8gRnJvbSBoZXJlIG9uLCB3ZSBjYW4gYXNzZXJ0IHRoYXQgYHZhbHVlYCBpcyBlaXRoZXIgYW4gb2JqZWN0IG9yIGFuIGFycmF5LgoKICAvLyBEbyBub3Qgbm9ybWFsaXplIG9iamVjdHMgdGhhdCB3ZSBrbm93IGhhdmUgYWxyZWFkeSBiZWVuIG5vcm1hbGl6ZWQuIEFzIGEgZ2VuZXJhbCBydWxlLCB0aGUKICAvLyAiX19zZW50cnlfc2tpcF9ub3JtYWxpemF0aW9uX18iIHByb3BlcnR5IHNob3VsZCBvbmx5IGJlIHVzZWQgc3BhcmluZ2x5IGFuZCBvbmx5IHNob3VsZCBvbmx5IGJlIHNldCBvbiBvYmplY3RzIHRoYXQKICAvLyBoYXZlIGFscmVhZHkgYmVlbiBub3JtYWxpemVkLgogIGlmICgodmFsdWUgKVsnX19zZW50cnlfc2tpcF9ub3JtYWxpemF0aW9uX18nXSkgewogICAgcmV0dXJuIHZhbHVlIDsKICB9CgogIC8vIFdlIGNhbiBzZXQgYF9fc2VudHJ5X292ZXJyaWRlX25vcm1hbGl6YXRpb25fZGVwdGhfX2Agb24gYW4gb2JqZWN0IHRvIGVuc3VyZSB0aGF0IGZyb20gdGhlcmUKICAvLyBXZSBrZWVwIGEgY2VydGFpbiBhbW91bnQgb2YgZGVwdGguCiAgLy8gVGhpcyBzaG91bGQgYmUgdXNlZCBzcGFyaW5nbHksIGUuZy4gd2UgdXNlIGl0IGZvciB0aGUgcmVkdXggaW50ZWdyYXRpb24gdG8gZW5zdXJlIHdlIGdldCBhIGNlcnRhaW4gYW1vdW50IG9mIHN0YXRlLgogIGNvbnN0IHJlbWFpbmluZ0RlcHRoID0KICAgIHR5cGVvZiAodmFsdWUgKVsnX19zZW50cnlfb3ZlcnJpZGVfbm9ybWFsaXphdGlvbl9kZXB0aF9fJ10gPT09ICdudW1iZXInCiAgICAgID8gKCh2YWx1ZSApWydfX3NlbnRyeV9vdmVycmlkZV9ub3JtYWxpemF0aW9uX2RlcHRoX18nXSApCiAgICAgIDogZGVwdGg7CgogIC8vIFdlJ3JlIGFsc28gZG9uZSBpZiB3ZSd2ZSByZWFjaGVkIHRoZSBtYXggZGVwdGgKICBpZiAocmVtYWluaW5nRGVwdGggPT09IDApIHsKICAgIC8vIEF0IHRoaXMgcG9pbnQgd2Uga25vdyBgc2VyaWFsaXplZGAgaXMgYSBzdHJpbmcgb2YgdGhlIGZvcm0gYCJbb2JqZWN0IFhYWFhdImAuIENsZWFuIGl0IHVwIHNvIGl0J3MganVzdCBgIltYWFhYXSJgLgogICAgcmV0dXJuIHN0cmluZ2lmaWVkLnJlcGxhY2UoJ29iamVjdCAnLCAnJyk7CiAgfQoKICAvLyBJZiB3ZSd2ZSBhbHJlYWR5IHZpc2l0ZWQgdGhpcyBicmFuY2gsIGJhaWwgb3V0LCBhcyBpdCdzIGNpcmN1bGFyIHJlZmVyZW5jZS4gSWYgbm90LCBub3RlIHRoYXQgd2UncmUgc2VlaW5nIGl0IG5vdy4KICBpZiAobWVtb2l6ZSh2YWx1ZSkpIHsKICAgIHJldHVybiAnW0NpcmN1bGFyIH5dJzsKICB9CgogIC8vIElmIHRoZSB2YWx1ZSBoYXMgYSBgdG9KU09OYCBtZXRob2QsIHdlIGNhbGwgaXQgdG8gZXh0cmFjdCBtb3JlIGluZm9ybWF0aW9uCiAgY29uc3QgdmFsdWVXaXRoVG9KU09OID0gdmFsdWUgOwogIGlmICh2YWx1ZVdpdGhUb0pTT04gJiYgdHlwZW9mIHZhbHVlV2l0aFRvSlNPTi50b0pTT04gPT09ICdmdW5jdGlvbicpIHsKICAgIHRyeSB7CiAgICAgIGNvbnN0IGpzb25WYWx1ZSA9IHZhbHVlV2l0aFRvSlNPTi50b0pTT04oKTsKICAgICAgLy8gV2UgbmVlZCB0byBub3JtYWxpemUgdGhlIHJldHVybiB2YWx1ZSBvZiBgLnRvSlNPTigpYCBpbiBjYXNlIGl0IGhhcyBjaXJjdWxhciByZWZlcmVuY2VzCiAgICAgIHJldHVybiB2aXNpdCgnJywganNvblZhbHVlLCByZW1haW5pbmdEZXB0aCAtIDEsIG1heFByb3BlcnRpZXMsIG1lbW8pOwogICAgfSBjYXRjaCAoZXJyKSB7CiAgICAgIC8vIHBhc3MgKFRoZSBidWlsdC1pbiBgdG9KU09OYCBmYWlsZWQsIGJ1dCB3ZSBjYW4gc3RpbGwgdHJ5IHRvIGRvIGl0IG91cnNlbHZlcykKICAgIH0KICB9CgogIC8vIEF0IHRoaXMgcG9pbnQgd2Uga25vdyB3ZSBlaXRoZXIgaGF2ZSBhbiBvYmplY3Qgb3IgYW4gYXJyYXksIHdlIGhhdmVuJ3Qgc2VlbiBpdCBiZWZvcmUsIGFuZCB3ZSdyZSBnb2luZyB0byByZWN1cnNlCiAgLy8gYmVjYXVzZSB3ZSBoYXZlbid0IHlldCByZWFjaGVkIHRoZSBtYXggZGVwdGguIENyZWF0ZSBhbiBhY2N1bXVsYXRvciB0byBob2xkIHRoZSByZXN1bHRzIG9mIHZpc2l0aW5nIGVhY2gKICAvLyBwcm9wZXJ0eS9lbnRyeSwgYW5kIGtlZXAgdHJhY2sgb2YgdGhlIG51bWJlciBvZiBpdGVtcyB3ZSBhZGQgdG8gaXQuCiAgY29uc3Qgbm9ybWFsaXplZCA9IChBcnJheS5pc0FycmF5KHZhbHVlKSA/IFtdIDoge30pIDsKICBsZXQgbnVtQWRkZWQgPSAwOwoKICAvLyBCZWZvcmUgd2UgYmVnaW4sIGNvbnZlcnRgRXJyb3JgIGFuZGBFdmVudGAgaW5zdGFuY2VzIGludG8gcGxhaW4gb2JqZWN0cywgc2luY2Ugc29tZSBvZiBlYWNoIG9mIHRoZWlyIHJlbGV2YW50CiAgLy8gcHJvcGVydGllcyBhcmUgbm9uLWVudW1lcmFibGUgYW5kIG90aGVyd2lzZSB3b3VsZCBnZXQgbWlzc2VkLgogIGNvbnN0IHZpc2l0YWJsZSA9IGNvbnZlcnRUb1BsYWluT2JqZWN0KHZhbHVlICk7CgogIGZvciAoY29uc3QgdmlzaXRLZXkgaW4gdmlzaXRhYmxlKSB7CiAgICAvLyBBdm9pZCBpdGVyYXRpbmcgb3ZlciBmaWVsZHMgaW4gdGhlIHByb3RvdHlwZSBpZiB0aGV5J3ZlIHNvbWVob3cgYmVlbiBleHBvc2VkIHRvIGVudW1lcmF0aW9uLgogICAgaWYgKCFPYmplY3QucHJvdG90eXBlLmhhc093blByb3BlcnR5LmNhbGwodmlzaXRhYmxlLCB2aXNpdEtleSkpIHsKICAgICAgY29udGludWU7CiAgICB9CgogICAgaWYgKG51bUFkZGVkID49IG1heFByb3BlcnRpZXMpIHsKICAgICAgbm9ybWFsaXplZFt2aXNpdEtleV0gPSAnW01heFByb3BlcnRpZXMgfl0nOwogICAgICBicmVhazsKICAgIH0KCiAgICAvLyBSZWN1cnNpdmVseSB2aXNpdCBhbGwgdGhlIGNoaWxkIG5vZGVzCiAgICBjb25zdCB2aXNpdFZhbHVlID0gdmlzaXRhYmxlW3Zpc2l0S2V5XTsKICAgIG5vcm1hbGl6ZWRbdmlzaXRLZXldID0gdmlzaXQodmlzaXRLZXksIHZpc2l0VmFsdWUsIHJlbWFpbmluZ0RlcHRoIC0gMSwgbWF4UHJvcGVydGllcywgbWVtbyk7CgogICAgbnVtQWRkZWQrKzsKICB9CgogIC8vIE9uY2Ugd2UndmUgdmlzaXRlZCBhbGwgdGhlIGJyYW5jaGVzLCByZW1vdmUgdGhlIHBhcmVudCBmcm9tIG1lbW8gc3RvcmFnZQogIHVubWVtb2l6ZSh2YWx1ZSk7CgogIC8vIFJldHVybiBhY2N1bXVsYXRlZCB2YWx1ZXMKICByZXR1cm4gbm9ybWFsaXplZDsKfQoKLyogZXNsaW50LWRpc2FibGUgY29tcGxleGl0eSAqLwovKioKICogU3RyaW5naWZ5IHRoZSBnaXZlbiB2YWx1ZS4gSGFuZGxlcyB2YXJpb3VzIGtub3duIHNwZWNpYWwgdmFsdWVzIGFuZCB0eXBlcy4KICoKICogTm90IG1lYW50IHRvIGJlIHVzZWQgb24gc2ltcGxlIHByaW1pdGl2ZXMgd2hpY2ggYWxyZWFkeSBoYXZlIGEgc3RyaW5nIHJlcHJlc2VudGF0aW9uLCBhcyBpdCB3aWxsLCBmb3IgZXhhbXBsZSwgdHVybgogKiB0aGUgbnVtYmVyIDEyMzEgaW50byAiW09iamVjdCBOdW1iZXJdIiwgbm9yIG9uIGBudWxsYCwgYXMgaXQgd2lsbCB0aHJvdy4KICoKICogQHBhcmFtIHZhbHVlIFRoZSB2YWx1ZSB0byBzdHJpbmdpZnkKICogQHJldHVybnMgQSBzdHJpbmdpZmllZCByZXByZXNlbnRhdGlvbiBvZiB0aGUgZ2l2ZW4gdmFsdWUKICovCmZ1bmN0aW9uIHN0cmluZ2lmeVZhbHVlKAogIGtleSwKICAvLyB0aGlzIHR5cGUgaXMgYSB0aW55IGJpdCBvZiBhIGNoZWF0LCBzaW5jZSB0aGlzIGZ1bmN0aW9uIGRvZXMgaGFuZGxlIE5hTiAod2hpY2ggaXMgdGVjaG5pY2FsbHkgYSBudW1iZXIpLCBidXQgZm9yCiAgLy8gb3VyIGludGVybmFsIHVzZSwgaXQnbGwgZG8KICB2YWx1ZSwKKSB7CiAgdHJ5IHsKICAgIGlmIChrZXkgPT09ICdkb21haW4nICYmIHZhbHVlICYmIHR5cGVvZiB2YWx1ZSA9PT0gJ29iamVjdCcgJiYgKHZhbHVlICkuX2V2ZW50cykgewogICAgICByZXR1cm4gJ1tEb21haW5dJzsKICAgIH0KCiAgICBpZiAoa2V5ID09PSAnZG9tYWluRW1pdHRlcicpIHsKICAgICAgcmV0dXJuICdbRG9tYWluRW1pdHRlcl0nOwogICAgfQoKICAgIC8vIEl0J3Mgc2FmZSB0byB1c2UgYGdsb2JhbGAsIGB3aW5kb3dgLCBhbmQgYGRvY3VtZW50YCBoZXJlIGluIHRoaXMgbWFubmVyLCBhcyB3ZSBhcmUgYXNzZXJ0aW5nIHVzaW5nIGB0eXBlb2ZgIGZpcnN0CiAgICAvLyB3aGljaCB3b24ndCB0aHJvdyBpZiB0aGV5IGFyZSBub3QgcHJlc2VudC4KCiAgICBpZiAodHlwZW9mIGdsb2JhbCAhPT0gJ3VuZGVmaW5lZCcgJiYgdmFsdWUgPT09IGdsb2JhbCkgewogICAgICByZXR1cm4gJ1tHbG9iYWxdJzsKICAgIH0KCiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tcmVzdHJpY3RlZC1nbG9iYWxzCiAgICBpZiAodHlwZW9mIHdpbmRvdyAhPT0gJ3VuZGVmaW5lZCcgJiYgdmFsdWUgPT09IHdpbmRvdykgewogICAgICByZXR1cm4gJ1tXaW5kb3ddJzsKICAgIH0KCiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgbm8tcmVzdHJpY3RlZC1nbG9iYWxzCiAgICBpZiAodHlwZW9mIGRvY3VtZW50ICE9PSAndW5kZWZpbmVkJyAmJiB2YWx1ZSA9PT0gZG9jdW1lbnQpIHsKICAgICAgcmV0dXJuICdbRG9jdW1lbnRdJzsKICAgIH0KCiAgICBpZiAoaXNWdWVWaWV3TW9kZWwodmFsdWUpKSB7CiAgICAgIHJldHVybiAnW1Z1ZVZpZXdNb2RlbF0nOwogICAgfQoKICAgIC8vIFJlYWN0J3MgU3ludGhldGljRXZlbnQgdGhpbmd5CiAgICBpZiAoaXNTeW50aGV0aWNFdmVudCh2YWx1ZSkpIHsKICAgICAgcmV0dXJuICdbU3ludGhldGljRXZlbnRdJzsKICAgIH0KCiAgICBpZiAodHlwZW9mIHZhbHVlID09PSAnbnVtYmVyJyAmJiB2YWx1ZSAhPT0gdmFsdWUpIHsKICAgICAgcmV0dXJuICdbTmFOXSc7CiAgICB9CgogICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gJ2Z1bmN0aW9uJykgewogICAgICByZXR1cm4gYFtGdW5jdGlvbjogJHtnZXRGdW5jdGlvbk5hbWUodmFsdWUpfV1gOwogICAgfQoKICAgIGlmICh0eXBlb2YgdmFsdWUgPT09ICdzeW1ib2wnKSB7CiAgICAgIHJldHVybiBgWyR7U3RyaW5nKHZhbHVlKX1dYDsKICAgIH0KCiAgICAvLyBzdHJpbmdpZmllZCBCaWdJbnRzIGFyZSBpbmRpc3Rpbmd1aXNoYWJsZSBmcm9tIHJlZ3VsYXIgbnVtYmVycywgc28gd2UgbmVlZCB0byBsYWJlbCB0aGVtIHRvIGF2b2lkIGNvbmZ1c2lvbgogICAgaWYgKHR5cGVvZiB2YWx1ZSA9PT0gJ2JpZ2ludCcpIHsKICAgICAgcmV0dXJuIGBbQmlnSW50OiAke1N0cmluZyh2YWx1ZSl9XWA7CiAgICB9CgogICAgLy8gTm93IHRoYXQgd2UndmUga25vY2tlZCBvdXQgYWxsIHRoZSBzcGVjaWFsIGNhc2VzIGFuZCB0aGUgcHJpbWl0aXZlcywgYWxsIHdlIGhhdmUgbGVmdCBhcmUgb2JqZWN0cy4gU2ltcGx5IGNhc3RpbmcKICAgIC8vIHRoZW0gdG8gc3RyaW5ncyBtZWFucyB0aGF0IGluc3RhbmNlcyBvZiBjbGFzc2VzIHdoaWNoIGhhdmVuJ3QgZGVmaW5lZCB0aGVpciBgdG9TdHJpbmdUYWdgIHdpbGwganVzdCBjb21lIG91dCBhcwogICAgLy8gYCJbb2JqZWN0IE9iamVjdF0iYC4gSWYgd2UgaW5zdGVhZCBsb29rIGF0IHRoZSBjb25zdHJ1Y3RvcidzIG5hbWUgKHdoaWNoIGlzIHRoZSBzYW1lIGFzIHRoZSBuYW1lIG9mIHRoZSBjbGFzcyksCiAgICAvLyB3ZSBjYW4gbWFrZSBzdXJlIHRoYXQgb25seSBwbGFpbiBvYmplY3RzIGNvbWUgb3V0IHRoYXQgd2F5LgogICAgY29uc3Qgb2JqTmFtZSA9IGdldENvbnN0cnVjdG9yTmFtZSh2YWx1ZSk7CgogICAgLy8gSGFuZGxlIEhUTUwgRWxlbWVudHMKICAgIGlmICgvXkhUTUwoXHcqKUVsZW1lbnQkLy50ZXN0KG9iak5hbWUpKSB7CiAgICAgIHJldHVybiBgW0hUTUxFbGVtZW50OiAke29iak5hbWV9XWA7CiAgICB9CgogICAgcmV0dXJuIGBbb2JqZWN0ICR7b2JqTmFtZX1dYDsKICB9IGNhdGNoIChlcnIpIHsKICAgIHJldHVybiBgKipub24tc2VyaWFsaXphYmxlKiogKCR7ZXJyfSlgOwogIH0KfQovKiBlc2xpbnQtZW5hYmxlIGNvbXBsZXhpdHkgKi8KCmZ1bmN0aW9uIGdldENvbnN0cnVjdG9yTmFtZSh2YWx1ZSkgewogIGNvbnN0IHByb3RvdHlwZSA9IE9iamVjdC5nZXRQcm90b3R5cGVPZih2YWx1ZSk7CgogIHJldHVybiBwcm90b3R5cGUgPyBwcm90b3R5cGUuY29uc3RydWN0b3IubmFtZSA6ICdudWxsIHByb3RvdHlwZSc7Cn0KCi8qKgogKiBOb3JtYWxpemVzIFVSTHMgaW4gZXhjZXB0aW9ucyBhbmQgc3RhY2t0cmFjZXMgdG8gYSBiYXNlIHBhdGggc28gU2VudHJ5IGNhbiBmaW5nZXJwcmludAogKiBhY3Jvc3MgcGxhdGZvcm1zIGFuZCB3b3JraW5nIGRpcmVjdG9yeS4KICoKICogQHBhcmFtIHVybCBUaGUgVVJMIHRvIGJlIG5vcm1hbGl6ZWQuCiAqIEBwYXJhbSBiYXNlUGF0aCBUaGUgYXBwbGljYXRpb24gYmFzZSBwYXRoLgogKiBAcmV0dXJucyBUaGUgbm9ybWFsaXplZCBVUkwuCiAqLwpmdW5jdGlvbiBub3JtYWxpemVVcmxUb0Jhc2UodXJsLCBiYXNlUGF0aCkgewogIGNvbnN0IGVzY2FwZWRCYXNlID0gYmFzZVBhdGgKICAgIC8vIEJhY2tzbGFzaCB0byBmb3J3YXJkCiAgICAucmVwbGFjZSgvXFwvZywgJy8nKQogICAgLy8gRXNjYXBlIFJlZ0V4cCBzcGVjaWFsIGNoYXJhY3RlcnMKICAgIC5yZXBsYWNlKC9bfFxce30oKVtcXV4kKyo/Ll0vZywgJ1xcJCYnKTsKCiAgbGV0IG5ld1VybCA9IHVybDsKICB0cnkgewogICAgbmV3VXJsID0gZGVjb2RlVVJJKHVybCk7CiAgfSBjYXRjaCAoX09vKSB7CiAgICAvLyBTb21ldGltZSB0aGlzIGJyZWFrcwogIH0KICByZXR1cm4gKAogICAgbmV3VXJsCiAgICAgIC5yZXBsYWNlKC9cXC9nLCAnLycpCiAgICAgIC5yZXBsYWNlKC93ZWJwYWNrOlwvPy9nLCAnJykgLy8gUmVtb3ZlIGludGVybWVkaWF0ZSBiYXNlIHBhdGgKICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIEBzZW50cnktaW50ZXJuYWwvc2RrL25vLXJlZ2V4cC1jb25zdHJ1Y3RvcgogICAgICAucmVwbGFjZShuZXcgUmVnRXhwKGAoZmlsZTovLyk/Lyoke2VzY2FwZWRCYXNlfS8qYCwgJ2lnJyksICdhcHA6Ly8vJykKICApOwp9CgovLyBTbGlnaHRseSBtb2RpZmllZCAobm8gSUU4IHN1cHBvcnQsIEVTNikgYW5kIHRyYW5zY3JpYmVkIHRvIFR5cGVTY3JpcHQKCi8vIFNwbGl0IGEgZmlsZW5hbWUgaW50byBbcm9vdCwgZGlyLCBiYXNlbmFtZSwgZXh0XSwgdW5peCB2ZXJzaW9uCi8vICdyb290JyBpcyBqdXN0IGEgc2xhc2gsIG9yIG5vdGhpbmcuCmNvbnN0IHNwbGl0UGF0aFJlID0gL14oXFMrOlxcfFwvPykoW1xzXFNdKj8pKCg/OlwuezEsMn18W14vXFxdKz98KShcLlteLi9cXF0qfCkpKD86Wy9cXF0qKSQvOwovKiogSlNEb2MgKi8KZnVuY3Rpb24gc3BsaXRQYXRoKGZpbGVuYW1lKSB7CiAgLy8gVHJ1bmNhdGUgZmlsZXMgbmFtZXMgZ3JlYXRlciB0aGFuIDEwMjQgY2hhcmFjdGVycyB0byBhdm9pZCByZWdleCBkb3MKICAvLyBodHRwczovL2dpdGh1Yi5jb20vZ2V0c2VudHJ5L3NlbnRyeS1qYXZhc2NyaXB0L3B1bGwvODczNyNkaXNjdXNzaW9uX3IxMjg1NzE5MTcyCiAgY29uc3QgdHJ1bmNhdGVkID0gZmlsZW5hbWUubGVuZ3RoID4gMTAyNCA/IGA8dHJ1bmNhdGVkPiR7ZmlsZW5hbWUuc2xpY2UoLTEwMjQpfWAgOiBmaWxlbmFtZTsKICBjb25zdCBwYXJ0cyA9IHNwbGl0UGF0aFJlLmV4ZWModHJ1bmNhdGVkKTsKICByZXR1cm4gcGFydHMgPyBwYXJ0cy5zbGljZSgxKSA6IFtdOwp9CgovKiogSlNEb2MgKi8KZnVuY3Rpb24gZGlybmFtZShwYXRoKSB7CiAgY29uc3QgcmVzdWx0ID0gc3BsaXRQYXRoKHBhdGgpOwogIGNvbnN0IHJvb3QgPSByZXN1bHRbMF07CiAgbGV0IGRpciA9IHJlc3VsdFsxXTsKCiAgaWYgKCFyb290ICYmICFkaXIpIHsKICAgIC8vIE5vIGRpcm5hbWUgd2hhdHNvZXZlcgogICAgcmV0dXJuICcuJzsKICB9CgogIGlmIChkaXIpIHsKICAgIC8vIEl0IGhhcyBhIGRpcm5hbWUsIHN0cmlwIHRyYWlsaW5nIHNsYXNoCiAgICBkaXIgPSBkaXIuc2xpY2UoMCwgZGlyLmxlbmd0aCAtIDEpOwogIH0KCiAgcmV0dXJuIHJvb3QgKyBkaXI7Cn0KCi8qIGVzbGludC1kaXNhYmxlIEB0eXBlc2NyaXB0LWVzbGludC9leHBsaWNpdC1mdW5jdGlvbi1yZXR1cm4tdHlwZSAqLwoKLyoqIFN5bmNQcm9taXNlIGludGVybmFsIHN0YXRlcyAqLwp2YXIgU3RhdGVzOyAoZnVuY3Rpb24gKFN0YXRlcykgewogIC8qKiBQZW5kaW5nICovCiAgY29uc3QgUEVORElORyA9IDA7IFN0YXRlc1tTdGF0ZXNbIlBFTkRJTkciXSA9IFBFTkRJTkddID0gIlBFTkRJTkciOwogIC8qKiBSZXNvbHZlZCAvIE9LICovCiAgY29uc3QgUkVTT0xWRUQgPSAxOyBTdGF0ZXNbU3RhdGVzWyJSRVNPTFZFRCJdID0gUkVTT0xWRURdID0gIlJFU09MVkVEIjsKICAvKiogUmVqZWN0ZWQgLyBFcnJvciAqLwogIGNvbnN0IFJFSkVDVEVEID0gMjsgU3RhdGVzW1N0YXRlc1siUkVKRUNURUQiXSA9IFJFSkVDVEVEXSA9ICJSRUpFQ1RFRCI7Cn0pKFN0YXRlcyB8fCAoU3RhdGVzID0ge30pKTsKCi8vIE92ZXJsb2FkcyBzbyB3ZSBjYW4gY2FsbCByZXNvbHZlZFN5bmNQcm9taXNlIHdpdGhvdXQgYXJndW1lbnRzIGFuZCBnZW5lcmljIGFyZ3VtZW50CgovKioKICogQ3JlYXRlcyBhIHJlc29sdmVkIHN5bmMgcHJvbWlzZS4KICoKICogQHBhcmFtIHZhbHVlIHRoZSB2YWx1ZSB0byByZXNvbHZlIHRoZSBwcm9taXNlIHdpdGgKICogQHJldHVybnMgdGhlIHJlc29sdmVkIHN5bmMgcHJvbWlzZQogKi8KZnVuY3Rpb24gcmVzb2x2ZWRTeW5jUHJvbWlzZSh2YWx1ZSkgewogIHJldHVybiBuZXcgU3luY1Byb21pc2UocmVzb2x2ZSA9PiB7CiAgICByZXNvbHZlKHZhbHVlKTsKICB9KTsKfQoKLyoqCiAqIENyZWF0ZXMgYSByZWplY3RlZCBzeW5jIHByb21pc2UuCiAqCiAqIEBwYXJhbSB2YWx1ZSB0aGUgdmFsdWUgdG8gcmVqZWN0IHRoZSBwcm9taXNlIHdpdGgKICogQHJldHVybnMgdGhlIHJlamVjdGVkIHN5bmMgcHJvbWlzZQogKi8KZnVuY3Rpb24gcmVqZWN0ZWRTeW5jUHJvbWlzZShyZWFzb24pIHsKICByZXR1cm4gbmV3IFN5bmNQcm9taXNlKChfLCByZWplY3QpID0+IHsKICAgIHJlamVjdChyZWFzb24pOwogIH0pOwp9CgovKioKICogVGhlbmFibGUgY2xhc3MgdGhhdCBiZWhhdmVzIGxpa2UgYSBQcm9taXNlIGFuZCBmb2xsb3dzIGl0J3MgaW50ZXJmYWNlCiAqIGJ1dCBpcyBub3QgYXN5bmMgaW50ZXJuYWxseQogKi8KY2xhc3MgU3luY1Byb21pc2UgewoKICAgY29uc3RydWN0b3IoCiAgICBleGVjdXRvciwKICApIHtTeW5jUHJvbWlzZS5wcm90b3R5cGUuX19pbml0LmNhbGwodGhpcyk7U3luY1Byb21pc2UucHJvdG90eXBlLl9faW5pdDIuY2FsbCh0aGlzKTtTeW5jUHJvbWlzZS5wcm90b3R5cGUuX19pbml0My5jYWxsKHRoaXMpO1N5bmNQcm9taXNlLnByb3RvdHlwZS5fX2luaXQ0LmNhbGwodGhpcyk7CiAgICB0aGlzLl9zdGF0ZSA9IFN0YXRlcy5QRU5ESU5HOwogICAgdGhpcy5faGFuZGxlcnMgPSBbXTsKCiAgICB0cnkgewogICAgICBleGVjdXRvcih0aGlzLl9yZXNvbHZlLCB0aGlzLl9yZWplY3QpOwogICAgfSBjYXRjaCAoZSkgewogICAgICB0aGlzLl9yZWplY3QoZSk7CiAgICB9CiAgfQoKICAvKiogSlNEb2MgKi8KICAgdGhlbigKICAgIG9uZnVsZmlsbGVkLAogICAgb25yZWplY3RlZCwKICApIHsKICAgIHJldHVybiBuZXcgU3luY1Byb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4gewogICAgICB0aGlzLl9oYW5kbGVycy5wdXNoKFsKICAgICAgICBmYWxzZSwKICAgICAgICByZXN1bHQgPT4gewogICAgICAgICAgaWYgKCFvbmZ1bGZpbGxlZCkgewogICAgICAgICAgICAvLyBUT0RPOiDCr1xfKOODhClfL8KvCiAgICAgICAgICAgIC8vIFRPRE86IEZJWE1FCiAgICAgICAgICAgIHJlc29sdmUocmVzdWx0ICk7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgIHJlc29sdmUob25mdWxmaWxsZWQocmVzdWx0KSk7CiAgICAgICAgICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgICAgICAgICByZWplY3QoZSk7CiAgICAgICAgICAgIH0KICAgICAgICAgIH0KICAgICAgICB9LAogICAgICAgIHJlYXNvbiA9PiB7CiAgICAgICAgICBpZiAoIW9ucmVqZWN0ZWQpIHsKICAgICAgICAgICAgcmVqZWN0KHJlYXNvbik7CiAgICAgICAgICB9IGVsc2UgewogICAgICAgICAgICB0cnkgewogICAgICAgICAgICAgIHJlc29sdmUob25yZWplY3RlZChyZWFzb24pKTsKICAgICAgICAgICAgfSBjYXRjaCAoZSkgewogICAgICAgICAgICAgIHJlamVjdChlKTsKICAgICAgICAgICAgfQogICAgICAgICAgfQogICAgICAgIH0sCiAgICAgIF0pOwogICAgICB0aGlzLl9leGVjdXRlSGFuZGxlcnMoKTsKICAgIH0pOwogIH0KCiAgLyoqIEpTRG9jICovCiAgIGNhdGNoKAogICAgb25yZWplY3RlZCwKICApIHsKICAgIHJldHVybiB0aGlzLnRoZW4odmFsID0+IHZhbCwgb25yZWplY3RlZCk7CiAgfQoKICAvKiogSlNEb2MgKi8KICAgZmluYWxseShvbmZpbmFsbHkpIHsKICAgIHJldHVybiBuZXcgU3luY1Byb21pc2UoKHJlc29sdmUsIHJlamVjdCkgPT4gewogICAgICBsZXQgdmFsOwogICAgICBsZXQgaXNSZWplY3RlZDsKCiAgICAgIHJldHVybiB0aGlzLnRoZW4oCiAgICAgICAgdmFsdWUgPT4gewogICAgICAgICAgaXNSZWplY3RlZCA9IGZhbHNlOwogICAgICAgICAgdmFsID0gdmFsdWU7CiAgICAgICAgICBpZiAob25maW5hbGx5KSB7CiAgICAgICAgICAgIG9uZmluYWxseSgpOwogICAgICAgICAgfQogICAgICAgIH0sCiAgICAgICAgcmVhc29uID0+IHsKICAgICAgICAgIGlzUmVqZWN0ZWQgPSB0cnVlOwogICAgICAgICAgdmFsID0gcmVhc29uOwogICAgICAgICAgaWYgKG9uZmluYWxseSkgewogICAgICAgICAgICBvbmZpbmFsbHkoKTsKICAgICAgICAgIH0KICAgICAgICB9LAogICAgICApLnRoZW4oKCkgPT4gewogICAgICAgIGlmIChpc1JlamVjdGVkKSB7CiAgICAgICAgICByZWplY3QodmFsKTsKICAgICAgICAgIHJldHVybjsKICAgICAgICB9CgogICAgICAgIHJlc29sdmUodmFsICk7CiAgICAgIH0pOwogICAgfSk7CiAgfQoKICAvKiogSlNEb2MgKi8KICAgIF9faW5pdCgpIHt0aGlzLl9yZXNvbHZlID0gKHZhbHVlKSA9PiB7CiAgICB0aGlzLl9zZXRSZXN1bHQoU3RhdGVzLlJFU09MVkVELCB2YWx1ZSk7CiAgfTt9CgogIC8qKiBKU0RvYyAqLwogICAgX19pbml0MigpIHt0aGlzLl9yZWplY3QgPSAocmVhc29uKSA9PiB7CiAgICB0aGlzLl9zZXRSZXN1bHQoU3RhdGVzLlJFSkVDVEVELCByZWFzb24pOwogIH07fQoKICAvKiogSlNEb2MgKi8KICAgIF9faW5pdDMoKSB7dGhpcy5fc2V0UmVzdWx0ID0gKHN0YXRlLCB2YWx1ZSkgPT4gewogICAgaWYgKHRoaXMuX3N0YXRlICE9PSBTdGF0ZXMuUEVORElORykgewogICAgICByZXR1cm47CiAgICB9CgogICAgaWYgKGlzVGhlbmFibGUodmFsdWUpKSB7CiAgICAgIHZvaWQgKHZhbHVlICkudGhlbih0aGlzLl9yZXNvbHZlLCB0aGlzLl9yZWplY3QpOwogICAgICByZXR1cm47CiAgICB9CgogICAgdGhpcy5fc3RhdGUgPSBzdGF0ZTsKICAgIHRoaXMuX3ZhbHVlID0gdmFsdWU7CgogICAgdGhpcy5fZXhlY3V0ZUhhbmRsZXJzKCk7CiAgfTt9CgogIC8qKiBKU0RvYyAqLwogICAgX19pbml0NCgpIHt0aGlzLl9leGVjdXRlSGFuZGxlcnMgPSAoKSA9PiB7CiAgICBpZiAodGhpcy5fc3RhdGUgPT09IFN0YXRlcy5QRU5ESU5HKSB7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICBjb25zdCBjYWNoZWRIYW5kbGVycyA9IHRoaXMuX2hhbmRsZXJzLnNsaWNlKCk7CiAgICB0aGlzLl9oYW5kbGVycyA9IFtdOwoKICAgIGNhY2hlZEhhbmRsZXJzLmZvckVhY2goaGFuZGxlciA9PiB7CiAgICAgIGlmIChoYW5kbGVyWzBdKSB7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICBpZiAodGhpcy5fc3RhdGUgPT09IFN0YXRlcy5SRVNPTFZFRCkgewogICAgICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvbm8tZmxvYXRpbmctcHJvbWlzZXMKICAgICAgICBoYW5kbGVyWzFdKHRoaXMuX3ZhbHVlICk7CiAgICAgIH0KCiAgICAgIGlmICh0aGlzLl9zdGF0ZSA9PT0gU3RhdGVzLlJFSkVDVEVEKSB7CiAgICAgICAgaGFuZGxlclsyXSh0aGlzLl92YWx1ZSk7CiAgICAgIH0KCiAgICAgIGhhbmRsZXJbMF0gPSB0cnVlOwogICAgfSk7CiAgfTt9Cn0KCi8qKgogKiBDcmVhdGVzIGFuIG5ldyBQcm9taXNlQnVmZmVyIG9iamVjdCB3aXRoIHRoZSBzcGVjaWZpZWQgbGltaXQKICogQHBhcmFtIGxpbWl0IG1heCBudW1iZXIgb2YgcHJvbWlzZXMgdGhhdCBjYW4gYmUgc3RvcmVkIGluIHRoZSBidWZmZXIKICovCmZ1bmN0aW9uIG1ha2VQcm9taXNlQnVmZmVyKGxpbWl0KSB7CiAgY29uc3QgYnVmZmVyID0gW107CgogIGZ1bmN0aW9uIGlzUmVhZHkoKSB7CiAgICByZXR1cm4gbGltaXQgPT09IHVuZGVmaW5lZCB8fCBidWZmZXIubGVuZ3RoIDwgbGltaXQ7CiAgfQoKICAvKioKICAgKiBSZW1vdmUgYSBwcm9taXNlIGZyb20gdGhlIHF1ZXVlLgogICAqCiAgICogQHBhcmFtIHRhc2sgQ2FuIGJlIGFueSBQcm9taXNlTGlrZTxUPgogICAqIEByZXR1cm5zIFJlbW92ZWQgcHJvbWlzZS4KICAgKi8KICBmdW5jdGlvbiByZW1vdmUodGFzaykgewogICAgcmV0dXJuIGJ1ZmZlci5zcGxpY2UoYnVmZmVyLmluZGV4T2YodGFzayksIDEpWzBdOwogIH0KCiAgLyoqCiAgICogQWRkIGEgcHJvbWlzZSAocmVwcmVzZW50aW5nIGFuIGluLWZsaWdodCBhY3Rpb24pIHRvIHRoZSBxdWV1ZSwgYW5kIHNldCBpdCB0byByZW1vdmUgaXRzZWxmIG9uIGZ1bGZpbGxtZW50LgogICAqCiAgICogQHBhcmFtIHRhc2tQcm9kdWNlciBBIGZ1bmN0aW9uIHByb2R1Y2luZyBhbnkgUHJvbWlzZUxpa2U8VD47IEluIHByZXZpb3VzIHZlcnNpb25zIHRoaXMgdXNlZCB0byBiZSBgdGFzazoKICAgKiAgICAgICAgUHJvbWlzZUxpa2U8VD5gLCBidXQgdW5kZXIgdGhhdCBtb2RlbCwgUHJvbWlzZXMgd2VyZSBpbnN0YW50bHkgY3JlYXRlZCBvbiB0aGUgY2FsbC1zaXRlIGFuZCB0aGVpciBleGVjdXRvcgogICAqICAgICAgICBmdW5jdGlvbnMgdGhlcmVmb3JlIHJhbiBpbW1lZGlhdGVseS4gVGh1cywgZXZlbiBpZiB0aGUgYnVmZmVyIHdhcyBmdWxsLCB0aGUgYWN0aW9uIHN0aWxsIGhhcHBlbmVkLiBCeQogICAqICAgICAgICByZXF1aXJpbmcgdGhlIHByb21pc2UgdG8gYmUgd3JhcHBlZCBpbiBhIGZ1bmN0aW9uLCB3ZSBjYW4gZGVmZXIgcHJvbWlzZSBjcmVhdGlvbiB1bnRpbCBhZnRlciB0aGUgYnVmZmVyCiAgICogICAgICAgIGxpbWl0IGNoZWNrLgogICAqIEByZXR1cm5zIFRoZSBvcmlnaW5hbCBwcm9taXNlLgogICAqLwogIGZ1bmN0aW9uIGFkZCh0YXNrUHJvZHVjZXIpIHsKICAgIGlmICghaXNSZWFkeSgpKSB7CiAgICAgIHJldHVybiByZWplY3RlZFN5bmNQcm9taXNlKG5ldyBTZW50cnlFcnJvcignTm90IGFkZGluZyBQcm9taXNlIGJlY2F1c2UgYnVmZmVyIGxpbWl0IHdhcyByZWFjaGVkLicpKTsKICAgIH0KCiAgICAvLyBzdGFydCB0aGUgdGFzayBhbmQgYWRkIGl0cyBwcm9taXNlIHRvIHRoZSBxdWV1ZQogICAgY29uc3QgdGFzayA9IHRhc2tQcm9kdWNlcigpOwogICAgaWYgKGJ1ZmZlci5pbmRleE9mKHRhc2spID09PSAtMSkgewogICAgICBidWZmZXIucHVzaCh0YXNrKTsKICAgIH0KICAgIHZvaWQgdGFzawogICAgICAudGhlbigoKSA9PiByZW1vdmUodGFzaykpCiAgICAgIC8vIFVzZSBgdGhlbihudWxsLCByZWplY3Rpb25IYW5kbGVyKWAgcmF0aGVyIHRoYW4gYGNhdGNoKHJlamVjdGlvbkhhbmRsZXIpYCBzbyB0aGF0IHdlIGNhbiB1c2UgYFByb21pc2VMaWtlYAogICAgICAvLyByYXRoZXIgdGhhbiBgUHJvbWlzZWAuIGBQcm9taXNlTGlrZWAgZG9lc24ndCBoYXZlIGEgYC5jYXRjaGAgbWV0aG9kLCBtYWtpbmcgaXRzIHBvbHlmaWxsIHNtYWxsZXIuIChFUzUgZGlkbid0CiAgICAgIC8vIGhhdmUgcHJvbWlzZXMsIHNvIFRTIGhhcyB0byBwb2x5ZmlsbCB3aGVuIGRvd24tY29tcGlsaW5nLikKICAgICAgLnRoZW4obnVsbCwgKCkgPT4KICAgICAgICByZW1vdmUodGFzaykudGhlbihudWxsLCAoKSA9PiB7CiAgICAgICAgICAvLyBXZSBoYXZlIHRvIGFkZCBhbm90aGVyIGNhdGNoIGhlcmUgYmVjYXVzZSBgcmVtb3ZlKClgIHN0YXJ0cyBhIG5ldyBwcm9taXNlIGNoYWluLgogICAgICAgIH0pLAogICAgICApOwogICAgcmV0dXJuIHRhc2s7CiAgfQoKICAvKioKICAgKiBXYWl0IGZvciBhbGwgcHJvbWlzZXMgaW4gdGhlIHF1ZXVlIHRvIHJlc29sdmUgb3IgZm9yIHRpbWVvdXQgdG8gZXhwaXJlLCB3aGljaGV2ZXIgY29tZXMgZmlyc3QuCiAgICoKICAgKiBAcGFyYW0gdGltZW91dCBUaGUgdGltZSwgaW4gbXMsIGFmdGVyIHdoaWNoIHRvIHJlc29sdmUgdG8gYGZhbHNlYCBpZiB0aGUgcXVldWUgaXMgc3RpbGwgbm9uLWVtcHR5LiBQYXNzaW5nIGAwYCAob3IKICAgKiBub3QgcGFzc2luZyBhbnl0aGluZykgd2lsbCBtYWtlIHRoZSBwcm9taXNlIHdhaXQgYXMgbG9uZyBhcyBpdCB0YWtlcyBmb3IgdGhlIHF1ZXVlIHRvIGRyYWluIGJlZm9yZSByZXNvbHZpbmcgdG8KICAgKiBgdHJ1ZWAuCiAgICogQHJldHVybnMgQSBwcm9taXNlIHdoaWNoIHdpbGwgcmVzb2x2ZSB0byBgdHJ1ZWAgaWYgdGhlIHF1ZXVlIGlzIGFscmVhZHkgZW1wdHkgb3IgZHJhaW5zIGJlZm9yZSB0aGUgdGltZW91dCwgYW5kCiAgICogYGZhbHNlYCBvdGhlcndpc2UKICAgKi8KICBmdW5jdGlvbiBkcmFpbih0aW1lb3V0KSB7CiAgICByZXR1cm4gbmV3IFN5bmNQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHsKICAgICAgbGV0IGNvdW50ZXIgPSBidWZmZXIubGVuZ3RoOwoKICAgICAgaWYgKCFjb3VudGVyKSB7CiAgICAgICAgcmV0dXJuIHJlc29sdmUodHJ1ZSk7CiAgICAgIH0KCiAgICAgIC8vIHdhaXQgZm9yIGB0aW1lb3V0YCBtcyBhbmQgdGhlbiByZXNvbHZlIHRvIGBmYWxzZWAgKGlmIG5vdCBjYW5jZWxsZWQgZmlyc3QpCiAgICAgIGNvbnN0IGNhcHR1cmVkU2V0VGltZW91dCA9IHNldFRpbWVvdXQoKCkgPT4gewogICAgICAgIGlmICh0aW1lb3V0ICYmIHRpbWVvdXQgPiAwKSB7CiAgICAgICAgICByZXNvbHZlKGZhbHNlKTsKICAgICAgICB9CiAgICAgIH0sIHRpbWVvdXQpOwoKICAgICAgLy8gaWYgYWxsIHByb21pc2VzIHJlc29sdmUgaW4gdGltZSwgY2FuY2VsIHRoZSB0aW1lciBhbmQgcmVzb2x2ZSB0byBgdHJ1ZWAKICAgICAgYnVmZmVyLmZvckVhY2goaXRlbSA9PiB7CiAgICAgICAgdm9pZCByZXNvbHZlZFN5bmNQcm9taXNlKGl0ZW0pLnRoZW4oKCkgPT4gewogICAgICAgICAgaWYgKCEtLWNvdW50ZXIpIHsKICAgICAgICAgICAgY2xlYXJUaW1lb3V0KGNhcHR1cmVkU2V0VGltZW91dCk7CiAgICAgICAgICAgIHJlc29sdmUodHJ1ZSk7CiAgICAgICAgICB9CiAgICAgICAgfSwgcmVqZWN0KTsKICAgICAgfSk7CiAgICB9KTsKICB9CgogIHJldHVybiB7CiAgICAkOiBidWZmZXIsCiAgICBhZGQsCiAgICBkcmFpbiwKICB9Owp9Cgpjb25zdCBPTkVfU0VDT05EX0lOX01TID0gMTAwMDsKCi8qKgogKiBBIHBhcnRpYWwgZGVmaW5pdGlvbiBvZiB0aGUgW1BlcmZvcm1hbmNlIFdlYiBBUElde0BsaW5rIGh0dHBzOi8vZGV2ZWxvcGVyLm1vemlsbGEub3JnL2VuLVVTL2RvY3MvV2ViL0FQSS9QZXJmb3JtYW5jZX0KICogZm9yIGFjY2Vzc2luZyBhIGhpZ2gtcmVzb2x1dGlvbiBtb25vdG9uaWMgY2xvY2suCiAqLwoKLyoqCiAqIFJldHVybnMgYSB0aW1lc3RhbXAgaW4gc2Vjb25kcyBzaW5jZSB0aGUgVU5JWCBlcG9jaCB1c2luZyB0aGUgRGF0ZSBBUEkuCiAqCiAqIFRPRE8odjgpOiBSZXR1cm4gdHlwZSBzaG91bGQgYmUgcm91bmRlZC4KICovCmZ1bmN0aW9uIGRhdGVUaW1lc3RhbXBJblNlY29uZHMoKSB7CiAgcmV0dXJuIERhdGUubm93KCkgLyBPTkVfU0VDT05EX0lOX01TOwp9CgovKioKICogUmV0dXJucyBhIHdyYXBwZXIgYXJvdW5kIHRoZSBuYXRpdmUgUGVyZm9ybWFuY2UgQVBJIGJyb3dzZXIgaW1wbGVtZW50YXRpb24sIG9yIHVuZGVmaW5lZCBmb3IgYnJvd3NlcnMgdGhhdCBkbyBub3QKICogc3VwcG9ydCB0aGUgQVBJLgogKgogKiBXcmFwcGluZyB0aGUgbmF0aXZlIEFQSSB3b3JrcyBhcm91bmQgZGlmZmVyZW5jZXMgaW4gYmVoYXZpb3IgZnJvbSBkaWZmZXJlbnQgYnJvd3NlcnMuCiAqLwpmdW5jdGlvbiBjcmVhdGVVbml4VGltZXN0YW1wSW5TZWNvbmRzRnVuYygpIHsKICBjb25zdCB7IHBlcmZvcm1hbmNlIH0gPSBHTE9CQUxfT0JKIDsKICBpZiAoIXBlcmZvcm1hbmNlIHx8ICFwZXJmb3JtYW5jZS5ub3cpIHsKICAgIHJldHVybiBkYXRlVGltZXN0YW1wSW5TZWNvbmRzOwogIH0KCiAgLy8gU29tZSBicm93c2VyIGFuZCBlbnZpcm9ubWVudHMgZG9uJ3QgaGF2ZSBhIHRpbWVPcmlnaW4sIHNvIHdlIGZhbGxiYWNrIHRvCiAgLy8gdXNpbmcgRGF0ZS5ub3coKSB0byBjb21wdXRlIHRoZSBzdGFydGluZyB0aW1lLgogIGNvbnN0IGFwcHJveFN0YXJ0aW5nVGltZU9yaWdpbiA9IERhdGUubm93KCkgLSBwZXJmb3JtYW5jZS5ub3coKTsKICBjb25zdCB0aW1lT3JpZ2luID0gcGVyZm9ybWFuY2UudGltZU9yaWdpbiA9PSB1bmRlZmluZWQgPyBhcHByb3hTdGFydGluZ1RpbWVPcmlnaW4gOiBwZXJmb3JtYW5jZS50aW1lT3JpZ2luOwoKICAvLyBwZXJmb3JtYW5jZS5ub3coKSBpcyBhIG1vbm90b25pYyBjbG9jaywgd2hpY2ggbWVhbnMgaXQgc3RhcnRzIGF0IDAgd2hlbiB0aGUgcHJvY2VzcyBiZWdpbnMuIFRvIGdldCB0aGUgY3VycmVudAogIC8vIHdhbGwgY2xvY2sgdGltZSAoYWN0dWFsIFVOSVggdGltZXN0YW1wKSwgd2UgbmVlZCB0byBhZGQgdGhlIHN0YXJ0aW5nIHRpbWUgb3JpZ2luIGFuZCB0aGUgY3VycmVudCB0aW1lIGVsYXBzZWQuCiAgLy8KICAvLyBUT0RPOiBUaGlzIGRvZXMgbm90IGFjY291bnQgZm9yIHRoZSBjYXNlIHdoZXJlIHRoZSBtb25vdG9uaWMgY2xvY2sgdGhhdCBwb3dlcnMgcGVyZm9ybWFuY2Uubm93KCkgZHJpZnRzIGZyb20gdGhlCiAgLy8gd2FsbCBjbG9jayB0aW1lLCB3aGljaCBjYXVzZXMgdGhlIHJldHVybmVkIHRpbWVzdGFtcCB0byBiZSBpbmFjY3VyYXRlLiBXZSBzaG91bGQgaW52ZXN0aWdhdGUgaG93IHRvIGRldGVjdCBhbmQKICAvLyBjb3JyZWN0IGZvciB0aGlzLgogIC8vIFNlZTogaHR0cHM6Ly9naXRodWIuY29tL2dldHNlbnRyeS9zZW50cnktamF2YXNjcmlwdC9pc3N1ZXMvMjU5MAogIC8vIFNlZTogaHR0cHM6Ly9naXRodWIuY29tL21kbi9jb250ZW50L2lzc3Vlcy80NzEzCiAgLy8gU2VlOiBodHRwczovL2Rldi50by9ub2Ftci93aGVuLWEtbWlsbGlzZWNvbmQtaXMtbm90LWEtbWlsbGlzZWNvbmQtM2g2CiAgcmV0dXJuICgpID0+IHsKICAgIHJldHVybiAodGltZU9yaWdpbiArIHBlcmZvcm1hbmNlLm5vdygpKSAvIE9ORV9TRUNPTkRfSU5fTVM7CiAgfTsKfQoKLyoqCiAqIFJldHVybnMgYSB0aW1lc3RhbXAgaW4gc2Vjb25kcyBzaW5jZSB0aGUgVU5JWCBlcG9jaCB1c2luZyBlaXRoZXIgdGhlIFBlcmZvcm1hbmNlIG9yIERhdGUgQVBJcywgZGVwZW5kaW5nIG9uIHRoZQogKiBhdmFpbGFiaWxpdHkgb2YgdGhlIFBlcmZvcm1hbmNlIEFQSS4KICoKICogQlVHOiBOb3RlIHRoYXQgYmVjYXVzZSBvZiBob3cgYnJvd3NlcnMgaW1wbGVtZW50IHRoZSBQZXJmb3JtYW5jZSBBUEksIHRoZSBjbG9jayBtaWdodCBzdG9wIHdoZW4gdGhlIGNvbXB1dGVyIGlzCiAqIGFzbGVlcC4gVGhpcyBjcmVhdGVzIGEgc2tldyBiZXR3ZWVuIGBkYXRlVGltZXN0YW1wSW5TZWNvbmRzYCBhbmQgYHRpbWVzdGFtcEluU2Vjb25kc2AuIFRoZQogKiBza2V3IGNhbiBncm93IHRvIGFyYml0cmFyeSBhbW91bnRzIGxpa2UgZGF5cywgd2Vla3Mgb3IgbW9udGhzLgogKiBTZWUgaHR0cHM6Ly9naXRodWIuY29tL2dldHNlbnRyeS9zZW50cnktamF2YXNjcmlwdC9pc3N1ZXMvMjU5MC4KICovCmNvbnN0IHRpbWVzdGFtcEluU2Vjb25kcyA9IGNyZWF0ZVVuaXhUaW1lc3RhbXBJblNlY29uZHNGdW5jKCk7CgovKioKICogVGhlIG51bWJlciBvZiBtaWxsaXNlY29uZHMgc2luY2UgdGhlIFVOSVggZXBvY2guIFRoaXMgdmFsdWUgaXMgb25seSB1c2FibGUgaW4gYSBicm93c2VyLCBhbmQgb25seSB3aGVuIHRoZQogKiBwZXJmb3JtYW5jZSBBUEkgaXMgYXZhaWxhYmxlLgogKi8KKCgpID0+IHsKICAvLyBVbmZvcnR1bmF0ZWx5IGJyb3dzZXJzIG1heSByZXBvcnQgYW4gaW5hY2N1cmF0ZSB0aW1lIG9yaWdpbiBkYXRhLCB0aHJvdWdoIGVpdGhlciBwZXJmb3JtYW5jZS50aW1lT3JpZ2luIG9yCiAgLy8gcGVyZm9ybWFuY2UudGltaW5nLm5hdmlnYXRpb25TdGFydCwgd2hpY2ggcmVzdWx0cyBpbiBwb29yIHJlc3VsdHMgaW4gcGVyZm9ybWFuY2UgZGF0YS4gV2Ugb25seSB0cmVhdCB0aW1lIG9yaWdpbgogIC8vIGRhdGEgYXMgcmVsaWFibGUgaWYgdGhleSBhcmUgd2l0aGluIGEgcmVhc29uYWJsZSB0aHJlc2hvbGQgb2YgdGhlIGN1cnJlbnQgdGltZS4KCiAgY29uc3QgeyBwZXJmb3JtYW5jZSB9ID0gR0xPQkFMX09CSiA7CiAgaWYgKCFwZXJmb3JtYW5jZSB8fCAhcGVyZm9ybWFuY2Uubm93KSB7CiAgICByZXR1cm4gdW5kZWZpbmVkOwogIH0KCiAgY29uc3QgdGhyZXNob2xkID0gMzYwMCAqIDEwMDA7CiAgY29uc3QgcGVyZm9ybWFuY2VOb3cgPSBwZXJmb3JtYW5jZS5ub3coKTsKICBjb25zdCBkYXRlTm93ID0gRGF0ZS5ub3coKTsKCiAgLy8gaWYgdGltZU9yaWdpbiBpc24ndCBhdmFpbGFibGUgc2V0IGRlbHRhIHRvIHRocmVzaG9sZCBzbyBpdCBpc24ndCB1c2VkCiAgY29uc3QgdGltZU9yaWdpbkRlbHRhID0gcGVyZm9ybWFuY2UudGltZU9yaWdpbgogICAgPyBNYXRoLmFicyhwZXJmb3JtYW5jZS50aW1lT3JpZ2luICsgcGVyZm9ybWFuY2VOb3cgLSBkYXRlTm93KQogICAgOiB0aHJlc2hvbGQ7CiAgY29uc3QgdGltZU9yaWdpbklzUmVsaWFibGUgPSB0aW1lT3JpZ2luRGVsdGEgPCB0aHJlc2hvbGQ7CgogIC8vIFdoaWxlIHBlcmZvcm1hbmNlLnRpbWluZy5uYXZpZ2F0aW9uU3RhcnQgaXMgZGVwcmVjYXRlZCBpbiBmYXZvciBvZiBwZXJmb3JtYW5jZS50aW1lT3JpZ2luLCBwZXJmb3JtYW5jZS50aW1lT3JpZ2luCiAgLy8gaXMgbm90IGFzIHdpZGVseSBzdXBwb3J0ZWQuIE5hbWVseSwgcGVyZm9ybWFuY2UudGltZU9yaWdpbiBpcyB1bmRlZmluZWQgaW4gU2FmYXJpIGFzIG9mIHdyaXRpbmcuCiAgLy8gQWxzbyBhcyBvZiB3cml0aW5nLCBwZXJmb3JtYW5jZS50aW1pbmcgaXMgbm90IGF2YWlsYWJsZSBpbiBXZWIgV29ya2VycyBpbiBtYWluc3RyZWFtIGJyb3dzZXJzLCBzbyBpdCBpcyBub3QgYWx3YXlzCiAgLy8gYSB2YWxpZCBmYWxsYmFjay4gSW4gdGhlIGFic2VuY2Ugb2YgYW4gaW5pdGlhbCB0aW1lIHByb3ZpZGVkIGJ5IHRoZSBicm93c2VyLCBmYWxsYmFjayB0byB0aGUgY3VycmVudCB0aW1lIGZyb20gdGhlCiAgLy8gRGF0ZSBBUEkuCiAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIGRlcHJlY2F0aW9uL2RlcHJlY2F0aW9uCiAgY29uc3QgbmF2aWdhdGlvblN0YXJ0ID0gcGVyZm9ybWFuY2UudGltaW5nICYmIHBlcmZvcm1hbmNlLnRpbWluZy5uYXZpZ2F0aW9uU3RhcnQ7CiAgY29uc3QgaGFzTmF2aWdhdGlvblN0YXJ0ID0gdHlwZW9mIG5hdmlnYXRpb25TdGFydCA9PT0gJ251bWJlcic7CiAgLy8gaWYgbmF2aWdhdGlvblN0YXJ0IGlzbid0IGF2YWlsYWJsZSBzZXQgZGVsdGEgdG8gdGhyZXNob2xkIHNvIGl0IGlzbid0IHVzZWQKICBjb25zdCBuYXZpZ2F0aW9uU3RhcnREZWx0YSA9IGhhc05hdmlnYXRpb25TdGFydCA/IE1hdGguYWJzKG5hdmlnYXRpb25TdGFydCArIHBlcmZvcm1hbmNlTm93IC0gZGF0ZU5vdykgOiB0aHJlc2hvbGQ7CiAgY29uc3QgbmF2aWdhdGlvblN0YXJ0SXNSZWxpYWJsZSA9IG5hdmlnYXRpb25TdGFydERlbHRhIDwgdGhyZXNob2xkOwoKICBpZiAodGltZU9yaWdpbklzUmVsaWFibGUgfHwgbmF2aWdhdGlvblN0YXJ0SXNSZWxpYWJsZSkgewogICAgLy8gVXNlIHRoZSBtb3JlIHJlbGlhYmxlIHRpbWUgb3JpZ2luCiAgICBpZiAodGltZU9yaWdpbkRlbHRhIDw9IG5hdmlnYXRpb25TdGFydERlbHRhKSB7CiAgICAgIHJldHVybiBwZXJmb3JtYW5jZS50aW1lT3JpZ2luOwogICAgfSBlbHNlIHsKICAgICAgcmV0dXJuIG5hdmlnYXRpb25TdGFydDsKICAgIH0KICB9CiAgcmV0dXJuIGRhdGVOb3c7Cn0pKCk7CgovKioKICogQ3JlYXRlcyBhbiBlbnZlbG9wZS4KICogTWFrZSBzdXJlIHRvIGFsd2F5cyBleHBsaWNpdGx5IHByb3ZpZGUgdGhlIGdlbmVyaWMgdG8gdGhpcyBmdW5jdGlvbgogKiBzbyB0aGF0IHRoZSBlbnZlbG9wZSB0eXBlcyByZXNvbHZlIGNvcnJlY3RseS4KICovCmZ1bmN0aW9uIGNyZWF0ZUVudmVsb3BlKGhlYWRlcnMsIGl0ZW1zID0gW10pIHsKICByZXR1cm4gW2hlYWRlcnMsIGl0ZW1zXSA7Cn0KCi8qKgogKiBDb252ZW5pZW5jZSBmdW5jdGlvbiB0byBsb29wIHRocm91Z2ggdGhlIGl0ZW1zIGFuZCBpdGVtIHR5cGVzIG9mIGFuIGVudmVsb3BlLgogKiAoVGhpcyBmdW5jdGlvbiB3YXMgbW9zdGx5IGNyZWF0ZWQgYmVjYXVzZSB3b3JraW5nIHdpdGggZW52ZWxvcGUgdHlwZXMgaXMgcGFpbmZ1bCBhdCB0aGUgbW9tZW50KQogKgogKiBJZiB0aGUgY2FsbGJhY2sgcmV0dXJucyB0cnVlLCB0aGUgcmVzdCBvZiB0aGUgaXRlbXMgd2lsbCBiZSBza2lwcGVkLgogKi8KZnVuY3Rpb24gZm9yRWFjaEVudmVsb3BlSXRlbSgKICBlbnZlbG9wZSwKICBjYWxsYmFjaywKKSB7CiAgY29uc3QgZW52ZWxvcGVJdGVtcyA9IGVudmVsb3BlWzFdOwoKICBmb3IgKGNvbnN0IGVudmVsb3BlSXRlbSBvZiBlbnZlbG9wZUl0ZW1zKSB7CiAgICBjb25zdCBlbnZlbG9wZUl0ZW1UeXBlID0gZW52ZWxvcGVJdGVtWzBdLnR5cGU7CiAgICBjb25zdCByZXN1bHQgPSBjYWxsYmFjayhlbnZlbG9wZUl0ZW0sIGVudmVsb3BlSXRlbVR5cGUpOwoKICAgIGlmIChyZXN1bHQpIHsKICAgICAgcmV0dXJuIHRydWU7CiAgICB9CiAgfQoKICByZXR1cm4gZmFsc2U7Cn0KCi8qKgogKiBFbmNvZGUgYSBzdHJpbmcgdG8gVVRGOC4KICovCmZ1bmN0aW9uIGVuY29kZVVURjgoaW5wdXQsIHRleHRFbmNvZGVyKSB7CiAgY29uc3QgdXRmOCA9IHRleHRFbmNvZGVyIHx8IG5ldyBUZXh0RW5jb2RlcigpOwogIHJldHVybiB1dGY4LmVuY29kZShpbnB1dCk7Cn0KCi8qKgogKiBTZXJpYWxpemVzIGFuIGVudmVsb3BlLgogKi8KZnVuY3Rpb24gc2VyaWFsaXplRW52ZWxvcGUoZW52ZWxvcGUsIHRleHRFbmNvZGVyKSB7CiAgY29uc3QgW2VudkhlYWRlcnMsIGl0ZW1zXSA9IGVudmVsb3BlOwoKICAvLyBJbml0aWFsbHkgd2UgY29uc3RydWN0IG91ciBlbnZlbG9wZSBhcyBhIHN0cmluZyBhbmQgb25seSBjb252ZXJ0IHRvIGJpbmFyeSBjaHVua3MgaWYgd2UgZW5jb3VudGVyIGJpbmFyeSBkYXRhCiAgbGV0IHBhcnRzID0gSlNPTi5zdHJpbmdpZnkoZW52SGVhZGVycyk7CgogIGZ1bmN0aW9uIGFwcGVuZChuZXh0KSB7CiAgICBpZiAodHlwZW9mIHBhcnRzID09PSAnc3RyaW5nJykgewogICAgICBwYXJ0cyA9IHR5cGVvZiBuZXh0ID09PSAnc3RyaW5nJyA/IHBhcnRzICsgbmV4dCA6IFtlbmNvZGVVVEY4KHBhcnRzLCB0ZXh0RW5jb2RlciksIG5leHRdOwogICAgfSBlbHNlIHsKICAgICAgcGFydHMucHVzaCh0eXBlb2YgbmV4dCA9PT0gJ3N0cmluZycgPyBlbmNvZGVVVEY4KG5leHQsIHRleHRFbmNvZGVyKSA6IG5leHQpOwogICAgfQogIH0KCiAgZm9yIChjb25zdCBpdGVtIG9mIGl0ZW1zKSB7CiAgICBjb25zdCBbaXRlbUhlYWRlcnMsIHBheWxvYWRdID0gaXRlbTsKCiAgICBhcHBlbmQoYFxuJHtKU09OLnN0cmluZ2lmeShpdGVtSGVhZGVycyl9XG5gKTsKCiAgICBpZiAodHlwZW9mIHBheWxvYWQgPT09ICdzdHJpbmcnIHx8IHBheWxvYWQgaW5zdGFuY2VvZiBVaW50OEFycmF5KSB7CiAgICAgIGFwcGVuZChwYXlsb2FkKTsKICAgIH0gZWxzZSB7CiAgICAgIGxldCBzdHJpbmdpZmllZFBheWxvYWQ7CiAgICAgIHRyeSB7CiAgICAgICAgc3RyaW5naWZpZWRQYXlsb2FkID0gSlNPTi5zdHJpbmdpZnkocGF5bG9hZCk7CiAgICAgIH0gY2F0Y2ggKGUpIHsKICAgICAgICAvLyBJbiBjYXNlLCBkZXNwaXRlIGFsbCBvdXIgZWZmb3J0cyB0byBrZWVwIGBwYXlsb2FkYCBjaXJjdWxhci1kZXBlbmRlbmN5LWZyZWUsIGBKU09OLnN0cmluaWZ5KClgIHN0aWxsCiAgICAgICAgLy8gZmFpbHMsIHdlIHRyeSBhZ2FpbiBhZnRlciBub3JtYWxpemluZyBpdCBhZ2FpbiB3aXRoIGluZmluaXRlIG5vcm1hbGl6YXRpb24gZGVwdGguIFRoaXMgb2YgY291cnNlIGhhcyBhCiAgICAgICAgLy8gcGVyZm9ybWFuY2UgaW1wYWN0IGJ1dCBpbiB0aGlzIGNhc2UgYSBwZXJmb3JtYW5jZSBoaXQgaXMgYmV0dGVyIHRoYW4gdGhyb3dpbmcuCiAgICAgICAgc3RyaW5naWZpZWRQYXlsb2FkID0gSlNPTi5zdHJpbmdpZnkobm9ybWFsaXplKHBheWxvYWQpKTsKICAgICAgfQogICAgICBhcHBlbmQoc3RyaW5naWZpZWRQYXlsb2FkKTsKICAgIH0KICB9CgogIHJldHVybiB0eXBlb2YgcGFydHMgPT09ICdzdHJpbmcnID8gcGFydHMgOiBjb25jYXRCdWZmZXJzKHBhcnRzKTsKfQoKZnVuY3Rpb24gY29uY2F0QnVmZmVycyhidWZmZXJzKSB7CiAgY29uc3QgdG90YWxMZW5ndGggPSBidWZmZXJzLnJlZHVjZSgoYWNjLCBidWYpID0+IGFjYyArIGJ1Zi5sZW5ndGgsIDApOwoKICBjb25zdCBtZXJnZWQgPSBuZXcgVWludDhBcnJheSh0b3RhbExlbmd0aCk7CiAgbGV0IG9mZnNldCA9IDA7CiAgZm9yIChjb25zdCBidWZmZXIgb2YgYnVmZmVycykgewogICAgbWVyZ2VkLnNldChidWZmZXIsIG9mZnNldCk7CiAgICBvZmZzZXQgKz0gYnVmZmVyLmxlbmd0aDsKICB9CgogIHJldHVybiBtZXJnZWQ7Cn0KCmNvbnN0IElURU1fVFlQRV9UT19EQVRBX0NBVEVHT1JZX01BUCA9IHsKICBzZXNzaW9uOiAnc2Vzc2lvbicsCiAgc2Vzc2lvbnM6ICdzZXNzaW9uJywKICBhdHRhY2htZW50OiAnYXR0YWNobWVudCcsCiAgdHJhbnNhY3Rpb246ICd0cmFuc2FjdGlvbicsCiAgZXZlbnQ6ICdlcnJvcicsCiAgY2xpZW50X3JlcG9ydDogJ2ludGVybmFsJywKICB1c2VyX3JlcG9ydDogJ2RlZmF1bHQnLAogIHByb2ZpbGU6ICdwcm9maWxlJywKICByZXBsYXlfZXZlbnQ6ICdyZXBsYXknLAogIHJlcGxheV9yZWNvcmRpbmc6ICdyZXBsYXknLAogIGNoZWNrX2luOiAnbW9uaXRvcicsCiAgZmVlZGJhY2s6ICdmZWVkYmFjaycsCiAgc3BhbjogJ3NwYW4nLAogIC8vIFRPRE86IFRoaXMgaXMgYSB0ZW1wb3Jhcnkgd29ya2Fyb3VuZCB1bnRpbCB3ZSBoYXZlIGEgcHJvcGVyIGRhdGEgY2F0ZWdvcnkgZm9yIG1ldHJpY3MKICBzdGF0c2Q6ICd1bmtub3duJywKfTsKCi8qKgogKiBNYXBzIHRoZSB0eXBlIG9mIGFuIGVudmVsb3BlIGl0ZW0gdG8gYSBkYXRhIGNhdGVnb3J5LgogKi8KZnVuY3Rpb24gZW52ZWxvcGVJdGVtVHlwZVRvRGF0YUNhdGVnb3J5KHR5cGUpIHsKICByZXR1cm4gSVRFTV9UWVBFX1RPX0RBVEFfQ0FURUdPUllfTUFQW3R5cGVdOwp9CgovKiogRXh0cmFjdHMgdGhlIG1pbmltYWwgU0RLIGluZm8gZnJvbSBmcm9tIHRoZSBtZXRhZGF0YSBvciBhbiBldmVudHMgKi8KZnVuY3Rpb24gZ2V0U2RrTWV0YWRhdGFGb3JFbnZlbG9wZUhlYWRlcihtZXRhZGF0YU9yRXZlbnQpIHsKICBpZiAoIW1ldGFkYXRhT3JFdmVudCB8fCAhbWV0YWRhdGFPckV2ZW50LnNkaykgewogICAgcmV0dXJuOwogIH0KICBjb25zdCB7IG5hbWUsIHZlcnNpb24gfSA9IG1ldGFkYXRhT3JFdmVudC5zZGs7CiAgcmV0dXJuIHsgbmFtZSwgdmVyc2lvbiB9Owp9CgovKioKICogQ3JlYXRlcyBldmVudCBlbnZlbG9wZSBoZWFkZXJzLCBiYXNlZCBvbiBldmVudCwgc2RrIGluZm8gYW5kIHR1bm5lbAogKiBOb3RlOiBUaGlzIGZ1bmN0aW9uIHdhcyBleHRyYWN0ZWQgZnJvbSB0aGUgY29yZSBwYWNrYWdlIHRvIG1ha2UgaXQgYXZhaWxhYmxlIGluIFJlcGxheQogKi8KZnVuY3Rpb24gY3JlYXRlRXZlbnRFbnZlbG9wZUhlYWRlcnMoCiAgZXZlbnQsCiAgc2RrSW5mbywKICB0dW5uZWwsCiAgZHNuLAopIHsKICBjb25zdCBkeW5hbWljU2FtcGxpbmdDb250ZXh0ID0gZXZlbnQuc2RrUHJvY2Vzc2luZ01ldGFkYXRhICYmIGV2ZW50LnNka1Byb2Nlc3NpbmdNZXRhZGF0YS5keW5hbWljU2FtcGxpbmdDb250ZXh0OwogIHJldHVybiB7CiAgICBldmVudF9pZDogZXZlbnQuZXZlbnRfaWQgLAogICAgc2VudF9hdDogbmV3IERhdGUoKS50b0lTT1N0cmluZygpLAogICAgLi4uKHNka0luZm8gJiYgeyBzZGs6IHNka0luZm8gfSksCiAgICAuLi4oISF0dW5uZWwgJiYgZHNuICYmIHsgZHNuOiBkc25Ub1N0cmluZyhkc24pIH0pLAogICAgLi4uKGR5bmFtaWNTYW1wbGluZ0NvbnRleHQgJiYgewogICAgICB0cmFjZTogZHJvcFVuZGVmaW5lZEtleXMoeyAuLi5keW5hbWljU2FtcGxpbmdDb250ZXh0IH0pLAogICAgfSksCiAgfTsKfQoKLy8gSW50ZW50aW9uYWxseSBrZWVwaW5nIHRoZSBrZXkgYnJvYWQsIGFzIHdlIGRvbid0IGtub3cgZm9yIHN1cmUgd2hhdCByYXRlIGxpbWl0IGhlYWRlcnMgZ2V0IHJldHVybmVkIGZyb20gYmFja2VuZAoKY29uc3QgREVGQVVMVF9SRVRSWV9BRlRFUiA9IDYwICogMTAwMDsgLy8gNjAgc2Vjb25kcwoKLyoqCiAqIEV4dHJhY3RzIFJldHJ5LUFmdGVyIHZhbHVlIGZyb20gdGhlIHJlcXVlc3QgaGVhZGVyIG9yIHJldHVybnMgZGVmYXVsdCB2YWx1ZQogKiBAcGFyYW0gaGVhZGVyIHN0cmluZyByZXByZXNlbnRhdGlvbiBvZiAnUmV0cnktQWZ0ZXInIGhlYWRlcgogKiBAcGFyYW0gbm93IGN1cnJlbnQgdW5peCB0aW1lc3RhbXAKICoKICovCmZ1bmN0aW9uIHBhcnNlUmV0cnlBZnRlckhlYWRlcihoZWFkZXIsIG5vdyA9IERhdGUubm93KCkpIHsKICBjb25zdCBoZWFkZXJEZWxheSA9IHBhcnNlSW50KGAke2hlYWRlcn1gLCAxMCk7CiAgaWYgKCFpc05hTihoZWFkZXJEZWxheSkpIHsKICAgIHJldHVybiBoZWFkZXJEZWxheSAqIDEwMDA7CiAgfQoKICBjb25zdCBoZWFkZXJEYXRlID0gRGF0ZS5wYXJzZShgJHtoZWFkZXJ9YCk7CiAgaWYgKCFpc05hTihoZWFkZXJEYXRlKSkgewogICAgcmV0dXJuIGhlYWRlckRhdGUgLSBub3c7CiAgfQoKICByZXR1cm4gREVGQVVMVF9SRVRSWV9BRlRFUjsKfQoKLyoqCiAqIEdldHMgdGhlIHRpbWUgdGhhdCB0aGUgZ2l2ZW4gY2F0ZWdvcnkgaXMgZGlzYWJsZWQgdW50aWwgZm9yIHJhdGUgbGltaXRpbmcuCiAqIEluIGNhc2Ugbm8gY2F0ZWdvcnktc3BlY2lmaWMgbGltaXQgaXMgc2V0IGJ1dCBhIGdlbmVyYWwgcmF0ZSBsaW1pdCBhY3Jvc3MgYWxsIGNhdGVnb3JpZXMgaXMgYWN0aXZlLAogKiB0aGF0IHRpbWUgaXMgcmV0dXJuZWQuCiAqCiAqIEByZXR1cm4gdGhlIHRpbWUgaW4gbXMgdGhhdCB0aGUgY2F0ZWdvcnkgaXMgZGlzYWJsZWQgdW50aWwgb3IgMCBpZiB0aGVyZSdzIG5vIGFjdGl2ZSByYXRlIGxpbWl0LgogKi8KZnVuY3Rpb24gZGlzYWJsZWRVbnRpbChsaW1pdHMsIGNhdGVnb3J5KSB7CiAgcmV0dXJuIGxpbWl0c1tjYXRlZ29yeV0gfHwgbGltaXRzLmFsbCB8fCAwOwp9CgovKioKICogQ2hlY2tzIGlmIGEgY2F0ZWdvcnkgaXMgcmF0ZSBsaW1pdGVkCiAqLwpmdW5jdGlvbiBpc1JhdGVMaW1pdGVkKGxpbWl0cywgY2F0ZWdvcnksIG5vdyA9IERhdGUubm93KCkpIHsKICByZXR1cm4gZGlzYWJsZWRVbnRpbChsaW1pdHMsIGNhdGVnb3J5KSA+IG5vdzsKfQoKLyoqCiAqIFVwZGF0ZSByYXRlbGltaXRzIGZyb20gaW5jb21pbmcgaGVhZGVycy4KICoKICogQHJldHVybiB0aGUgdXBkYXRlZCBSYXRlTGltaXRzIG9iamVjdC4KICovCmZ1bmN0aW9uIHVwZGF0ZVJhdGVMaW1pdHMoCiAgbGltaXRzLAogIHsgc3RhdHVzQ29kZSwgaGVhZGVycyB9LAogIG5vdyA9IERhdGUubm93KCksCikgewogIGNvbnN0IHVwZGF0ZWRSYXRlTGltaXRzID0gewogICAgLi4ubGltaXRzLAogIH07CgogIC8vICJUaGUgbmFtZSBpcyBjYXNlLWluc2Vuc2l0aXZlLiIKICAvLyBodHRwczovL2RldmVsb3Blci5tb3ppbGxhLm9yZy9lbi1VUy9kb2NzL1dlYi9BUEkvSGVhZGVycy9nZXQKICBjb25zdCByYXRlTGltaXRIZWFkZXIgPSBoZWFkZXJzICYmIGhlYWRlcnNbJ3gtc2VudHJ5LXJhdGUtbGltaXRzJ107CiAgY29uc3QgcmV0cnlBZnRlckhlYWRlciA9IGhlYWRlcnMgJiYgaGVhZGVyc1sncmV0cnktYWZ0ZXInXTsKCiAgaWYgKHJhdGVMaW1pdEhlYWRlcikgewogICAgLyoqCiAgICAgKiByYXRlIGxpbWl0IGhlYWRlcnMgYXJlIG9mIHRoZSBmb3JtCiAgICAgKiAgICAgPGhlYWRlcj4sPGhlYWRlcj4sLi4KICAgICAqIHdoZXJlIGVhY2ggPGhlYWRlcj4gaXMgb2YgdGhlIGZvcm0KICAgICAqICAgICA8cmV0cnlfYWZ0ZXI+OiA8Y2F0ZWdvcmllcz46IDxzY29wZT46IDxyZWFzb25fY29kZT4KICAgICAqIHdoZXJlCiAgICAgKiAgICAgPHJldHJ5X2FmdGVyPiBpcyBhIGRlbGF5IGluIHNlY29uZHMKICAgICAqICAgICA8Y2F0ZWdvcmllcz4gaXMgdGhlIGV2ZW50IHR5cGUocykgKGVycm9yLCB0cmFuc2FjdGlvbiwgZXRjKSBiZWluZyByYXRlIGxpbWl0ZWQgYW5kIGlzIG9mIHRoZSBmb3JtCiAgICAgKiAgICAgICAgIDxjYXRlZ29yeT47PGNhdGVnb3J5PjsuLi4KICAgICAqICAgICA8c2NvcGU+IGlzIHdoYXQncyBiZWluZyBsaW1pdGVkIChvcmcsIHByb2plY3QsIG9yIGtleSkgLSBpZ25vcmVkIGJ5IFNESwogICAgICogICAgIDxyZWFzb25fY29kZT4gaXMgYW4gYXJiaXRyYXJ5IHN0cmluZyBsaWtlICJvcmdfcXVvdGEiIC0gaWdub3JlZCBieSBTREsKICAgICAqLwogICAgZm9yIChjb25zdCBsaW1pdCBvZiByYXRlTGltaXRIZWFkZXIudHJpbSgpLnNwbGl0KCcsJykpIHsKICAgICAgY29uc3QgW3JldHJ5QWZ0ZXIsIGNhdGVnb3JpZXNdID0gbGltaXQuc3BsaXQoJzonLCAyKTsKICAgICAgY29uc3QgaGVhZGVyRGVsYXkgPSBwYXJzZUludChyZXRyeUFmdGVyLCAxMCk7CiAgICAgIGNvbnN0IGRlbGF5ID0gKCFpc05hTihoZWFkZXJEZWxheSkgPyBoZWFkZXJEZWxheSA6IDYwKSAqIDEwMDA7IC8vIDYwc2VjIGRlZmF1bHQKICAgICAgaWYgKCFjYXRlZ29yaWVzKSB7CiAgICAgICAgdXBkYXRlZFJhdGVMaW1pdHMuYWxsID0gbm93ICsgZGVsYXk7CiAgICAgIH0gZWxzZSB7CiAgICAgICAgZm9yIChjb25zdCBjYXRlZ29yeSBvZiBjYXRlZ29yaWVzLnNwbGl0KCc7JykpIHsKICAgICAgICAgIHVwZGF0ZWRSYXRlTGltaXRzW2NhdGVnb3J5XSA9IG5vdyArIGRlbGF5OwogICAgICAgIH0KICAgICAgfQogICAgfQogIH0gZWxzZSBpZiAocmV0cnlBZnRlckhlYWRlcikgewogICAgdXBkYXRlZFJhdGVMaW1pdHMuYWxsID0gbm93ICsgcGFyc2VSZXRyeUFmdGVySGVhZGVyKHJldHJ5QWZ0ZXJIZWFkZXIsIG5vdyk7CiAgfSBlbHNlIGlmIChzdGF0dXNDb2RlID09PSA0MjkpIHsKICAgIHVwZGF0ZWRSYXRlTGltaXRzLmFsbCA9IG5vdyArIDYwICogMTAwMDsKICB9CgogIHJldHVybiB1cGRhdGVkUmF0ZUxpbWl0czsKfQoKLyoqCiAqIEEgbm9kZS5qcyB3YXRjaGRvZyB0aW1lcgogKiBAcGFyYW0gcG9sbEludGVydmFsIFRoZSBpbnRlcnZhbCB0aGF0IHdlIGV4cGVjdCB0byBnZXQgcG9sbGVkIGF0CiAqIEBwYXJhbSBhbnJUaHJlc2hvbGQgVGhlIHRocmVzaG9sZCBmb3Igd2hlbiB3ZSBjb25zaWRlciBBTlIKICogQHBhcmFtIGNhbGxiYWNrIFRoZSBjYWxsYmFjayB0byBjYWxsIGZvciBBTlIKICogQHJldHVybnMgQW4gb2JqZWN0IHdpdGggYHBvbGxgIGFuZCBgZW5hYmxlZGAgZnVuY3Rpb25zIHtAbGluayBXYXRjaGRvZ1JldHVybn0KICovCmZ1bmN0aW9uIHdhdGNoZG9nVGltZXIoCiAgY3JlYXRlVGltZXIsCiAgcG9sbEludGVydmFsLAogIGFuclRocmVzaG9sZCwKICBjYWxsYmFjaywKKSB7CiAgY29uc3QgdGltZXIgPSBjcmVhdGVUaW1lcigpOwogIGxldCB0cmlnZ2VyZWQgPSBmYWxzZTsKICBsZXQgZW5hYmxlZCA9IHRydWU7CgogIHNldEludGVydmFsKCgpID0+IHsKICAgIGNvbnN0IGRpZmZNcyA9IHRpbWVyLmdldFRpbWVNcygpOwoKICAgIGlmICh0cmlnZ2VyZWQgPT09IGZhbHNlICYmIGRpZmZNcyA+IHBvbGxJbnRlcnZhbCArIGFuclRocmVzaG9sZCkgewogICAgICB0cmlnZ2VyZWQgPSB0cnVlOwogICAgICBpZiAoZW5hYmxlZCkgewogICAgICAgIGNhbGxiYWNrKCk7CiAgICAgIH0KICAgIH0KCiAgICBpZiAoZGlmZk1zIDwgcG9sbEludGVydmFsICsgYW5yVGhyZXNob2xkKSB7CiAgICAgIHRyaWdnZXJlZCA9IGZhbHNlOwogICAgfQogIH0sIDIwKTsKCiAgcmV0dXJuIHsKICAgIHBvbGw6ICgpID0+IHsKICAgICAgdGltZXIucmVzZXQoKTsKICAgIH0sCiAgICBlbmFibGVkOiAoc3RhdGUpID0+IHsKICAgICAgZW5hYmxlZCA9IHN0YXRlOwogICAgfSwKICB9Owp9CgovLyB0eXBlcyBjb3BpZWQgZnJvbSBpbnNwZWN0b3IuZC50cwoKLyoqCiAqIENvbnZlcnRzIERlYnVnZ2VyLkNhbGxGcmFtZSB0byBTZW50cnkgU3RhY2tGcmFtZQogKi8KZnVuY3Rpb24gY2FsbEZyYW1lVG9TdGFja0ZyYW1lKAogIGZyYW1lLAogIHVybCwKICBnZXRNb2R1bGVGcm9tRmlsZW5hbWUsCikgewogIGNvbnN0IGZpbGVuYW1lID0gdXJsID8gdXJsLnJlcGxhY2UoL15maWxlOlwvXC8vLCAnJykgOiB1bmRlZmluZWQ7CgogIC8vIENhbGxGcmFtZSByb3cvY29sIGFyZSAwIGJhc2VkLCB3aGVyZWFzIFN0YWNrRnJhbWUgYXJlIDEgYmFzZWQKICBjb25zdCBjb2xubyA9IGZyYW1lLmxvY2F0aW9uLmNvbHVtbk51bWJlciA/IGZyYW1lLmxvY2F0aW9uLmNvbHVtbk51bWJlciArIDEgOiB1bmRlZmluZWQ7CiAgY29uc3QgbGluZW5vID0gZnJhbWUubG9jYXRpb24ubGluZU51bWJlciA/IGZyYW1lLmxvY2F0aW9uLmxpbmVOdW1iZXIgKyAxIDogdW5kZWZpbmVkOwoKICByZXR1cm4gZHJvcFVuZGVmaW5lZEtleXMoewogICAgZmlsZW5hbWUsCiAgICBtb2R1bGU6IGdldE1vZHVsZUZyb21GaWxlbmFtZShmaWxlbmFtZSksCiAgICBmdW5jdGlvbjogZnJhbWUuZnVuY3Rpb25OYW1lIHx8ICc/JywKICAgIGNvbG5vLAogICAgbGluZW5vLAogICAgaW5fYXBwOiBmaWxlbmFtZSA/IGZpbGVuYW1lSXNJbkFwcChmaWxlbmFtZSkgOiB1bmRlZmluZWQsCiAgfSk7Cn0KCi8qKgogKiBUaGlzIHNlcnZlcyBhcyBhIGJ1aWxkIHRpbWUgZmxhZyB0aGF0IHdpbGwgYmUgdHJ1ZSBieSBkZWZhdWx0LCBidXQgZmFsc2UgaW4gbm9uLWRlYnVnIGJ1aWxkcyBvciBpZiB1c2VycyByZXBsYWNlIGBfX1NFTlRSWV9ERUJVR19fYCBpbiB0aGVpciBnZW5lcmF0ZWQgY29kZS4KICoKICogQVRURU5USU9OOiBUaGlzIGNvbnN0YW50IG11c3QgbmV2ZXIgY3Jvc3MgcGFja2FnZSBib3VuZGFyaWVzIChpLmUuIGJlIGV4cG9ydGVkKSB0byBndWFyYW50ZWUgdGhhdCBpdCBjYW4gYmUgdXNlZCBmb3IgdHJlZSBzaGFraW5nLgogKi8KY29uc3QgREVCVUdfQlVJTEQgPSAodHlwZW9mIF9fU0VOVFJZX0RFQlVHX18gPT09ICd1bmRlZmluZWQnIHx8IF9fU0VOVFJZX0RFQlVHX18pOwoKLyoqCiAqIENyZWF0ZXMgYSBuZXcgYFNlc3Npb25gIG9iamVjdCBieSBzZXR0aW5nIGNlcnRhaW4gZGVmYXVsdCBwYXJhbWV0ZXJzLiBJZiBvcHRpb25hbCBAcGFyYW0gY29udGV4dAogKiBpcyBwYXNzZWQsIHRoZSBwYXNzZWQgcHJvcGVydGllcyBhcmUgYXBwbGllZCB0byB0aGUgc2Vzc2lvbiBvYmplY3QuCiAqCiAqIEBwYXJhbSBjb250ZXh0IChvcHRpb25hbCkgYWRkaXRpb25hbCBwcm9wZXJ0aWVzIHRvIGJlIGFwcGxpZWQgdG8gdGhlIHJldHVybmVkIHNlc3Npb24gb2JqZWN0CiAqCiAqIEByZXR1cm5zIGEgbmV3IGBTZXNzaW9uYCBvYmplY3QKICovCmZ1bmN0aW9uIG1ha2VTZXNzaW9uKGNvbnRleHQpIHsKICAvLyBCb3RoIHRpbWVzdGFtcCBhbmQgc3RhcnRlZCBhcmUgaW4gc2Vjb25kcyBzaW5jZSB0aGUgVU5JWCBlcG9jaC4KICBjb25zdCBzdGFydGluZ1RpbWUgPSB0aW1lc3RhbXBJblNlY29uZHMoKTsKCiAgY29uc3Qgc2Vzc2lvbiA9IHsKICAgIHNpZDogdXVpZDQoKSwKICAgIGluaXQ6IHRydWUsCiAgICB0aW1lc3RhbXA6IHN0YXJ0aW5nVGltZSwKICAgIHN0YXJ0ZWQ6IHN0YXJ0aW5nVGltZSwKICAgIGR1cmF0aW9uOiAwLAogICAgc3RhdHVzOiAnb2snLAogICAgZXJyb3JzOiAwLAogICAgaWdub3JlRHVyYXRpb246IGZhbHNlLAogICAgdG9KU09OOiAoKSA9PiBzZXNzaW9uVG9KU09OKHNlc3Npb24pLAogIH07CgogIGlmIChjb250ZXh0KSB7CiAgICB1cGRhdGVTZXNzaW9uKHNlc3Npb24sIGNvbnRleHQpOwogIH0KCiAgcmV0dXJuIHNlc3Npb247Cn0KCi8qKgogKiBVcGRhdGVzIGEgc2Vzc2lvbiBvYmplY3Qgd2l0aCB0aGUgcHJvcGVydGllcyBwYXNzZWQgaW4gdGhlIGNvbnRleHQuCiAqCiAqIE5vdGUgdGhhdCB0aGlzIGZ1bmN0aW9uIG11dGF0ZXMgdGhlIHBhc3NlZCBvYmplY3QgYW5kIHJldHVybnMgdm9pZC4KICogKEhhZCB0byBkbyB0aGlzIGluc3RlYWQgb2YgcmV0dXJuaW5nIGEgbmV3IGFuZCB1cGRhdGVkIHNlc3Npb24gYmVjYXVzZSBjbG9zaW5nIGFuZCBzZW5kaW5nIGEgc2Vzc2lvbgogKiBtYWtlcyBhbiB1cGRhdGUgdG8gdGhlIHNlc3Npb24gYWZ0ZXIgaXQgd2FzIHBhc3NlZCB0byB0aGUgc2VuZGluZyBsb2dpYy4KICogQHNlZSBCYXNlQ2xpZW50LmNhcHR1cmVTZXNzaW9uICkKICoKICogQHBhcmFtIHNlc3Npb24gdGhlIGBTZXNzaW9uYCB0byB1cGRhdGUKICogQHBhcmFtIGNvbnRleHQgdGhlIGBTZXNzaW9uQ29udGV4dGAgaG9sZGluZyB0aGUgcHJvcGVydGllcyB0aGF0IHNob3VsZCBiZSB1cGRhdGVkIGluIEBwYXJhbSBzZXNzaW9uCiAqLwovLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgY29tcGxleGl0eQpmdW5jdGlvbiB1cGRhdGVTZXNzaW9uKHNlc3Npb24sIGNvbnRleHQgPSB7fSkgewogIGlmIChjb250ZXh0LnVzZXIpIHsKICAgIGlmICghc2Vzc2lvbi5pcEFkZHJlc3MgJiYgY29udGV4dC51c2VyLmlwX2FkZHJlc3MpIHsKICAgICAgc2Vzc2lvbi5pcEFkZHJlc3MgPSBjb250ZXh0LnVzZXIuaXBfYWRkcmVzczsKICAgIH0KCiAgICBpZiAoIXNlc3Npb24uZGlkICYmICFjb250ZXh0LmRpZCkgewogICAgICBzZXNzaW9uLmRpZCA9IGNvbnRleHQudXNlci5pZCB8fCBjb250ZXh0LnVzZXIuZW1haWwgfHwgY29udGV4dC51c2VyLnVzZXJuYW1lOwogICAgfQogIH0KCiAgc2Vzc2lvbi50aW1lc3RhbXAgPSBjb250ZXh0LnRpbWVzdGFtcCB8fCB0aW1lc3RhbXBJblNlY29uZHMoKTsKCiAgaWYgKGNvbnRleHQuYWJub3JtYWxfbWVjaGFuaXNtKSB7CiAgICBzZXNzaW9uLmFibm9ybWFsX21lY2hhbmlzbSA9IGNvbnRleHQuYWJub3JtYWxfbWVjaGFuaXNtOwogIH0KCiAgaWYgKGNvbnRleHQuaWdub3JlRHVyYXRpb24pIHsKICAgIHNlc3Npb24uaWdub3JlRHVyYXRpb24gPSBjb250ZXh0Lmlnbm9yZUR1cmF0aW9uOwogIH0KICBpZiAoY29udGV4dC5zaWQpIHsKICAgIC8vIEdvb2QgZW5vdWdoIHV1aWQgdmFsaWRhdGlvbi4g4oCUIEthbWlsCiAgICBzZXNzaW9uLnNpZCA9IGNvbnRleHQuc2lkLmxlbmd0aCA9PT0gMzIgPyBjb250ZXh0LnNpZCA6IHV1aWQ0KCk7CiAgfQogIGlmIChjb250ZXh0LmluaXQgIT09IHVuZGVmaW5lZCkgewogICAgc2Vzc2lvbi5pbml0ID0gY29udGV4dC5pbml0OwogIH0KICBpZiAoIXNlc3Npb24uZGlkICYmIGNvbnRleHQuZGlkKSB7CiAgICBzZXNzaW9uLmRpZCA9IGAke2NvbnRleHQuZGlkfWA7CiAgfQogIGlmICh0eXBlb2YgY29udGV4dC5zdGFydGVkID09PSAnbnVtYmVyJykgewogICAgc2Vzc2lvbi5zdGFydGVkID0gY29udGV4dC5zdGFydGVkOwogIH0KICBpZiAoc2Vzc2lvbi5pZ25vcmVEdXJhdGlvbikgewogICAgc2Vzc2lvbi5kdXJhdGlvbiA9IHVuZGVmaW5lZDsKICB9IGVsc2UgaWYgKHR5cGVvZiBjb250ZXh0LmR1cmF0aW9uID09PSAnbnVtYmVyJykgewogICAgc2Vzc2lvbi5kdXJhdGlvbiA9IGNvbnRleHQuZHVyYXRpb247CiAgfSBlbHNlIHsKICAgIGNvbnN0IGR1cmF0aW9uID0gc2Vzc2lvbi50aW1lc3RhbXAgLSBzZXNzaW9uLnN0YXJ0ZWQ7CiAgICBzZXNzaW9uLmR1cmF0aW9uID0gZHVyYXRpb24gPj0gMCA/IGR1cmF0aW9uIDogMDsKICB9CiAgaWYgKGNvbnRleHQucmVsZWFzZSkgewogICAgc2Vzc2lvbi5yZWxlYXNlID0gY29udGV4dC5yZWxlYXNlOwogIH0KICBpZiAoY29udGV4dC5lbnZpcm9ubWVudCkgewogICAgc2Vzc2lvbi5lbnZpcm9ubWVudCA9IGNvbnRleHQuZW52aXJvbm1lbnQ7CiAgfQogIGlmICghc2Vzc2lvbi5pcEFkZHJlc3MgJiYgY29udGV4dC5pcEFkZHJlc3MpIHsKICAgIHNlc3Npb24uaXBBZGRyZXNzID0gY29udGV4dC5pcEFkZHJlc3M7CiAgfQogIGlmICghc2Vzc2lvbi51c2VyQWdlbnQgJiYgY29udGV4dC51c2VyQWdlbnQpIHsKICAgIHNlc3Npb24udXNlckFnZW50ID0gY29udGV4dC51c2VyQWdlbnQ7CiAgfQogIGlmICh0eXBlb2YgY29udGV4dC5lcnJvcnMgPT09ICdudW1iZXInKSB7CiAgICBzZXNzaW9uLmVycm9ycyA9IGNvbnRleHQuZXJyb3JzOwogIH0KICBpZiAoY29udGV4dC5zdGF0dXMpIHsKICAgIHNlc3Npb24uc3RhdHVzID0gY29udGV4dC5zdGF0dXM7CiAgfQp9CgovKioKICogU2VyaWFsaXplcyBhIHBhc3NlZCBzZXNzaW9uIG9iamVjdCB0byBhIEpTT04gb2JqZWN0IHdpdGggYSBzbGlnaHRseSBkaWZmZXJlbnQgc3RydWN0dXJlLgogKiBUaGlzIGlzIG5lY2Vzc2FyeSBiZWNhdXNlIHRoZSBTZW50cnkgYmFja2VuZCByZXF1aXJlcyBhIHNsaWdodGx5IGRpZmZlcmVudCBzY2hlbWEgb2YgYSBzZXNzaW9uCiAqIHRoYW4gdGhlIG9uZSB0aGUgSlMgU0RLcyB1c2UgaW50ZXJuYWxseS4KICoKICogQHBhcmFtIHNlc3Npb24gdGhlIHNlc3Npb24gdG8gYmUgY29udmVydGVkCiAqCiAqIEByZXR1cm5zIGEgSlNPTiBvYmplY3Qgb2YgdGhlIHBhc3NlZCBzZXNzaW9uCiAqLwpmdW5jdGlvbiBzZXNzaW9uVG9KU09OKHNlc3Npb24pIHsKICByZXR1cm4gZHJvcFVuZGVmaW5lZEtleXMoewogICAgc2lkOiBgJHtzZXNzaW9uLnNpZH1gLAogICAgaW5pdDogc2Vzc2lvbi5pbml0LAogICAgLy8gTWFrZSBzdXJlIHRoYXQgc2VjIGlzIGNvbnZlcnRlZCB0byBtcyBmb3IgZGF0ZSBjb25zdHJ1Y3RvcgogICAgc3RhcnRlZDogbmV3IERhdGUoc2Vzc2lvbi5zdGFydGVkICogMTAwMCkudG9JU09TdHJpbmcoKSwKICAgIHRpbWVzdGFtcDogbmV3IERhdGUoc2Vzc2lvbi50aW1lc3RhbXAgKiAxMDAwKS50b0lTT1N0cmluZygpLAogICAgc3RhdHVzOiBzZXNzaW9uLnN0YXR1cywKICAgIGVycm9yczogc2Vzc2lvbi5lcnJvcnMsCiAgICBkaWQ6IHR5cGVvZiBzZXNzaW9uLmRpZCA9PT0gJ251bWJlcicgfHwgdHlwZW9mIHNlc3Npb24uZGlkID09PSAnc3RyaW5nJyA/IGAke3Nlc3Npb24uZGlkfWAgOiB1bmRlZmluZWQsCiAgICBkdXJhdGlvbjogc2Vzc2lvbi5kdXJhdGlvbiwKICAgIGFibm9ybWFsX21lY2hhbmlzbTogc2Vzc2lvbi5hYm5vcm1hbF9tZWNoYW5pc20sCiAgICBhdHRyczogewogICAgICByZWxlYXNlOiBzZXNzaW9uLnJlbGVhc2UsCiAgICAgIGVudmlyb25tZW50OiBzZXNzaW9uLmVudmlyb25tZW50LAogICAgICBpcF9hZGRyZXNzOiBzZXNzaW9uLmlwQWRkcmVzcywKICAgICAgdXNlcl9hZ2VudDogc2Vzc2lvbi51c2VyQWdlbnQsCiAgICB9LAogIH0pOwp9CgovKioKICogQXBwbHkgU2RrSW5mbyAobmFtZSwgdmVyc2lvbiwgcGFja2FnZXMsIGludGVncmF0aW9ucykgdG8gdGhlIGNvcnJlc3BvbmRpbmcgZXZlbnQga2V5LgogKiBNZXJnZSB3aXRoIGV4aXN0aW5nIGRhdGEgaWYgYW55LgogKiovCmZ1bmN0aW9uIGVuaGFuY2VFdmVudFdpdGhTZGtJbmZvKGV2ZW50LCBzZGtJbmZvKSB7CiAgaWYgKCFzZGtJbmZvKSB7CiAgICByZXR1cm4gZXZlbnQ7CiAgfQogIGV2ZW50LnNkayA9IGV2ZW50LnNkayB8fCB7fTsKICBldmVudC5zZGsubmFtZSA9IGV2ZW50LnNkay5uYW1lIHx8IHNka0luZm8ubmFtZTsKICBldmVudC5zZGsudmVyc2lvbiA9IGV2ZW50LnNkay52ZXJzaW9uIHx8IHNka0luZm8udmVyc2lvbjsKICBldmVudC5zZGsuaW50ZWdyYXRpb25zID0gWy4uLihldmVudC5zZGsuaW50ZWdyYXRpb25zIHx8IFtdKSwgLi4uKHNka0luZm8uaW50ZWdyYXRpb25zIHx8IFtdKV07CiAgZXZlbnQuc2RrLnBhY2thZ2VzID0gWy4uLihldmVudC5zZGsucGFja2FnZXMgfHwgW10pLCAuLi4oc2RrSW5mby5wYWNrYWdlcyB8fCBbXSldOwogIHJldHVybiBldmVudDsKfQoKLyoqIENyZWF0ZXMgYW4gZW52ZWxvcGUgZnJvbSBhIFNlc3Npb24gKi8KZnVuY3Rpb24gY3JlYXRlU2Vzc2lvbkVudmVsb3BlKAogIHNlc3Npb24sCiAgZHNuLAogIG1ldGFkYXRhLAogIHR1bm5lbCwKKSB7CiAgY29uc3Qgc2RrSW5mbyA9IGdldFNka01ldGFkYXRhRm9yRW52ZWxvcGVIZWFkZXIobWV0YWRhdGEpOwogIGNvbnN0IGVudmVsb3BlSGVhZGVycyA9IHsKICAgIHNlbnRfYXQ6IG5ldyBEYXRlKCkudG9JU09TdHJpbmcoKSwKICAgIC4uLihzZGtJbmZvICYmIHsgc2RrOiBzZGtJbmZvIH0pLAogICAgLi4uKCEhdHVubmVsICYmIGRzbiAmJiB7IGRzbjogZHNuVG9TdHJpbmcoZHNuKSB9KSwKICB9OwoKICBjb25zdCBlbnZlbG9wZUl0ZW0gPQogICAgJ2FnZ3JlZ2F0ZXMnIGluIHNlc3Npb24gPyBbeyB0eXBlOiAnc2Vzc2lvbnMnIH0sIHNlc3Npb25dIDogW3sgdHlwZTogJ3Nlc3Npb24nIH0sIHNlc3Npb24udG9KU09OKCldOwoKICByZXR1cm4gY3JlYXRlRW52ZWxvcGUoZW52ZWxvcGVIZWFkZXJzLCBbZW52ZWxvcGVJdGVtXSk7Cn0KCi8qKgogKiBDcmVhdGUgYW4gRW52ZWxvcGUgZnJvbSBhbiBldmVudC4KICovCmZ1bmN0aW9uIGNyZWF0ZUV2ZW50RW52ZWxvcGUoCiAgZXZlbnQsCiAgZHNuLAogIG1ldGFkYXRhLAogIHR1bm5lbCwKKSB7CiAgY29uc3Qgc2RrSW5mbyA9IGdldFNka01ldGFkYXRhRm9yRW52ZWxvcGVIZWFkZXIobWV0YWRhdGEpOwoKICAvKgogICAgTm90ZTogRHVlIHRvIFRTLCBldmVudC50eXBlIG1heSBiZSBgcmVwbGF5X2V2ZW50YCwgdGhlb3JldGljYWxseS4KICAgIEluIHByYWN0aWNlLCB3ZSBuZXZlciBjYWxsIGBjcmVhdGVFdmVudEVudmVsb3BlYCB3aXRoIGByZXBsYXlfZXZlbnRgIHR5cGUsCiAgICBhbmQgd2UnZCBoYXZlIHRvIGFkanV0IGEgbG9vb3Qgb2YgdHlwZXMgdG8gbWFrZSB0aGlzIHdvcmsgcHJvcGVybHkuCiAgICBXZSB3YW50IHRvIGF2b2lkIGNhc3RpbmcgdGhpcyBhcm91bmQsIGFzIHRoYXQgY291bGQgbGVhZCB0byBidWdzIChlLmcuIHdoZW4gd2UgYWRkIGFub3RoZXIgdHlwZSkKICAgIFNvIHRoZSBzYWZlIGNob2ljZSBpcyB0byByZWFsbHkgZ3VhcmQgYWdhaW5zdCB0aGUgcmVwbGF5X2V2ZW50IHR5cGUgaGVyZS4KICAqLwogIGNvbnN0IGV2ZW50VHlwZSA9IGV2ZW50LnR5cGUgJiYgZXZlbnQudHlwZSAhPT0gJ3JlcGxheV9ldmVudCcgPyBldmVudC50eXBlIDogJ2V2ZW50JzsKCiAgZW5oYW5jZUV2ZW50V2l0aFNka0luZm8oZXZlbnQsIG1ldGFkYXRhICYmIG1ldGFkYXRhLnNkayk7CgogIGNvbnN0IGVudmVsb3BlSGVhZGVycyA9IGNyZWF0ZUV2ZW50RW52ZWxvcGVIZWFkZXJzKGV2ZW50LCBzZGtJbmZvLCB0dW5uZWwsIGRzbik7CgogIC8vIFByZXZlbnQgdGhpcyBkYXRhICh3aGljaCwgaWYgaXQgZXhpc3RzLCB3YXMgdXNlZCBpbiBlYXJsaWVyIHN0ZXBzIGluIHRoZSBwcm9jZXNzaW5nIHBpcGVsaW5lKSBmcm9tIGJlaW5nIHNlbnQgdG8KICAvLyBzZW50cnkuIChOb3RlOiBPdXIgdXNlIG9mIHRoaXMgcHJvcGVydHkgY29tZXMgYW5kIGdvZXMgd2l0aCB3aGF0ZXZlciB3ZSBtaWdodCBiZSBkZWJ1Z2dpbmcsIHdoYXRldmVyIGhhY2tzIHdlIG1heQogIC8vIGhhdmUgdGVtcG9yYXJpbHkgYWRkZWQsIGV0Yy4gRXZlbiBpZiB3ZSBkb24ndCBoYXBwZW4gdG8gYmUgdXNpbmcgaXQgYXQgc29tZSBwb2ludCBpbiB0aGUgZnV0dXJlLCBsZXQncyBub3QgZ2V0IHJpZAogIC8vIG9mIHRoaXMgYGRlbGV0ZWAsIGxlc3Qgd2UgbWlzcyBwdXR0aW5nIGl0IGJhY2sgaW4gdGhlIG5leHQgdGltZSB0aGUgcHJvcGVydHkgaXMgaW4gdXNlLikKICBkZWxldGUgZXZlbnQuc2RrUHJvY2Vzc2luZ01ldGFkYXRhOwoKICBjb25zdCBldmVudEl0ZW0gPSBbeyB0eXBlOiBldmVudFR5cGUgfSwgZXZlbnRdOwogIHJldHVybiBjcmVhdGVFbnZlbG9wZShlbnZlbG9wZUhlYWRlcnMsIFtldmVudEl0ZW1dKTsKfQoKY29uc3QgU0VOVFJZX0FQSV9WRVJTSU9OID0gJzcnOwoKLyoqIFJldHVybnMgdGhlIHByZWZpeCB0byBjb25zdHJ1Y3QgU2VudHJ5IGluZ2VzdGlvbiBBUEkgZW5kcG9pbnRzLiAqLwpmdW5jdGlvbiBnZXRCYXNlQXBpRW5kcG9pbnQoZHNuKSB7CiAgY29uc3QgcHJvdG9jb2wgPSBkc24ucHJvdG9jb2wgPyBgJHtkc24ucHJvdG9jb2x9OmAgOiAnJzsKICBjb25zdCBwb3J0ID0gZHNuLnBvcnQgPyBgOiR7ZHNuLnBvcnR9YCA6ICcnOwogIHJldHVybiBgJHtwcm90b2NvbH0vLyR7ZHNuLmhvc3R9JHtwb3J0fSR7ZHNuLnBhdGggPyBgLyR7ZHNuLnBhdGh9YCA6ICcnfS9hcGkvYDsKfQoKLyoqIFJldHVybnMgdGhlIGluZ2VzdCBBUEkgZW5kcG9pbnQgZm9yIHRhcmdldC4gKi8KZnVuY3Rpb24gX2dldEluZ2VzdEVuZHBvaW50KGRzbikgewogIHJldHVybiBgJHtnZXRCYXNlQXBpRW5kcG9pbnQoZHNuKX0ke2Rzbi5wcm9qZWN0SWR9L2VudmVsb3BlL2A7Cn0KCi8qKiBSZXR1cm5zIGEgVVJMLWVuY29kZWQgc3RyaW5nIHdpdGggYXV0aCBjb25maWcgc3VpdGFibGUgZm9yIGEgcXVlcnkgc3RyaW5nLiAqLwpmdW5jdGlvbiBfZW5jb2RlZEF1dGgoZHNuLCBzZGtJbmZvKSB7CiAgcmV0dXJuIHVybEVuY29kZSh7CiAgICAvLyBXZSBzZW5kIG9ubHkgdGhlIG1pbmltdW0gc2V0IG9mIHJlcXVpcmVkIGluZm9ybWF0aW9uLiBTZWUKICAgIC8vIGh0dHBzOi8vZ2l0aHViLmNvbS9nZXRzZW50cnkvc2VudHJ5LWphdmFzY3JpcHQvaXNzdWVzLzI1NzIuCiAgICBzZW50cnlfa2V5OiBkc24ucHVibGljS2V5LAogICAgc2VudHJ5X3ZlcnNpb246IFNFTlRSWV9BUElfVkVSU0lPTiwKICAgIC4uLihzZGtJbmZvICYmIHsgc2VudHJ5X2NsaWVudDogYCR7c2RrSW5mby5uYW1lfS8ke3Nka0luZm8udmVyc2lvbn1gIH0pLAogIH0pOwp9CgovKioKICogUmV0dXJucyB0aGUgZW52ZWxvcGUgZW5kcG9pbnQgVVJMIHdpdGggYXV0aCBpbiB0aGUgcXVlcnkgc3RyaW5nLgogKgogKiBTZW5kaW5nIGF1dGggYXMgcGFydCBvZiB0aGUgcXVlcnkgc3RyaW5nIGFuZCBub3QgYXMgY3VzdG9tIEhUVFAgaGVhZGVycyBhdm9pZHMgQ09SUyBwcmVmbGlnaHQgcmVxdWVzdHMuCiAqLwpmdW5jdGlvbiBnZXRFbnZlbG9wZUVuZHBvaW50V2l0aFVybEVuY29kZWRBdXRoKAogIGRzbiwKICAvLyBUT0RPICh2OCk6IFJlbW92ZSBgdHVubmVsT3JPcHRpb25zYCBpbiBmYXZvciBvZiBgb3B0aW9uc2AsIGFuZCB1c2UgdGhlIHN1YnN0aXR1dGUgY29kZSBiZWxvdwogIC8vIG9wdGlvbnM6IENsaWVudE9wdGlvbnMgPSB7fSBhcyBDbGllbnRPcHRpb25zLAogIHR1bm5lbE9yT3B0aW9ucyA9IHt9ICwKKSB7CiAgLy8gVE9ETyAodjgpOiBVc2UgdGhpcyBjb2RlIGluc3RlYWQKICAvLyBjb25zdCB7IHR1bm5lbCwgX21ldGFkYXRhID0ge30gfSA9IG9wdGlvbnM7CiAgLy8gcmV0dXJuIHR1bm5lbCA/IHR1bm5lbCA6IGAke19nZXRJbmdlc3RFbmRwb2ludChkc24pfT8ke19lbmNvZGVkQXV0aChkc24sIF9tZXRhZGF0YS5zZGspfWA7CgogIGNvbnN0IHR1bm5lbCA9IHR5cGVvZiB0dW5uZWxPck9wdGlvbnMgPT09ICdzdHJpbmcnID8gdHVubmVsT3JPcHRpb25zIDogdHVubmVsT3JPcHRpb25zLnR1bm5lbDsKICBjb25zdCBzZGtJbmZvID0KICAgIHR5cGVvZiB0dW5uZWxPck9wdGlvbnMgPT09ICdzdHJpbmcnIHx8ICF0dW5uZWxPck9wdGlvbnMuX21ldGFkYXRhID8gdW5kZWZpbmVkIDogdHVubmVsT3JPcHRpb25zLl9tZXRhZGF0YS5zZGs7CgogIHJldHVybiB0dW5uZWwgPyB0dW5uZWwgOiBgJHtfZ2V0SW5nZXN0RW5kcG9pbnQoZHNuKX0/JHtfZW5jb2RlZEF1dGgoZHNuLCBzZGtJbmZvKX1gOwp9Cgpjb25zdCBERUZBVUxUX1RSQU5TUE9SVF9CVUZGRVJfU0laRSA9IDMwOwoKLyoqCiAqIENyZWF0ZXMgYW4gaW5zdGFuY2Ugb2YgYSBTZW50cnkgYFRyYW5zcG9ydGAKICoKICogQHBhcmFtIG9wdGlvbnMKICogQHBhcmFtIG1ha2VSZXF1ZXN0CiAqLwpmdW5jdGlvbiBjcmVhdGVUcmFuc3BvcnQoCiAgb3B0aW9ucywKICBtYWtlUmVxdWVzdCwKICBidWZmZXIgPSBtYWtlUHJvbWlzZUJ1ZmZlcigKICAgIG9wdGlvbnMuYnVmZmVyU2l6ZSB8fCBERUZBVUxUX1RSQU5TUE9SVF9CVUZGRVJfU0laRSwKICApLAopIHsKICBsZXQgcmF0ZUxpbWl0cyA9IHt9OwogIGNvbnN0IGZsdXNoID0gKHRpbWVvdXQpID0+IGJ1ZmZlci5kcmFpbih0aW1lb3V0KTsKCiAgZnVuY3Rpb24gc2VuZChlbnZlbG9wZSkgewogICAgY29uc3QgZmlsdGVyZWRFbnZlbG9wZUl0ZW1zID0gW107CgogICAgLy8gRHJvcCByYXRlIGxpbWl0ZWQgaXRlbXMgZnJvbSBlbnZlbG9wZQogICAgZm9yRWFjaEVudmVsb3BlSXRlbShlbnZlbG9wZSwgKGl0ZW0sIHR5cGUpID0+IHsKICAgICAgY29uc3QgZW52ZWxvcGVJdGVtRGF0YUNhdGVnb3J5ID0gZW52ZWxvcGVJdGVtVHlwZVRvRGF0YUNhdGVnb3J5KHR5cGUpOwogICAgICBpZiAoaXNSYXRlTGltaXRlZChyYXRlTGltaXRzLCBlbnZlbG9wZUl0ZW1EYXRhQ2F0ZWdvcnkpKSB7CiAgICAgICAgY29uc3QgZXZlbnQgPSBnZXRFdmVudEZvckVudmVsb3BlSXRlbShpdGVtLCB0eXBlKTsKICAgICAgICBvcHRpb25zLnJlY29yZERyb3BwZWRFdmVudCgncmF0ZWxpbWl0X2JhY2tvZmYnLCBlbnZlbG9wZUl0ZW1EYXRhQ2F0ZWdvcnksIGV2ZW50KTsKICAgICAgfSBlbHNlIHsKICAgICAgICBmaWx0ZXJlZEVudmVsb3BlSXRlbXMucHVzaChpdGVtKTsKICAgICAgfQogICAgfSk7CgogICAgLy8gU2tpcCBzZW5kaW5nIGlmIGVudmVsb3BlIGlzIGVtcHR5IGFmdGVyIGZpbHRlcmluZyBvdXQgcmF0ZSBsaW1pdGVkIGV2ZW50cwogICAgaWYgKGZpbHRlcmVkRW52ZWxvcGVJdGVtcy5sZW5ndGggPT09IDApIHsKICAgICAgcmV0dXJuIHJlc29sdmVkU3luY1Byb21pc2UoKTsKICAgIH0KCiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueQogICAgY29uc3QgZmlsdGVyZWRFbnZlbG9wZSA9IGNyZWF0ZUVudmVsb3BlKGVudmVsb3BlWzBdLCBmaWx0ZXJlZEVudmVsb3BlSXRlbXMgKTsKCiAgICAvLyBDcmVhdGVzIGNsaWVudCByZXBvcnQgZm9yIGVhY2ggaXRlbSBpbiBhbiBlbnZlbG9wZQogICAgY29uc3QgcmVjb3JkRW52ZWxvcGVMb3NzID0gKHJlYXNvbikgPT4gewogICAgICBmb3JFYWNoRW52ZWxvcGVJdGVtKGZpbHRlcmVkRW52ZWxvcGUsIChpdGVtLCB0eXBlKSA9PiB7CiAgICAgICAgY29uc3QgZXZlbnQgPSBnZXRFdmVudEZvckVudmVsb3BlSXRlbShpdGVtLCB0eXBlKTsKICAgICAgICBvcHRpb25zLnJlY29yZERyb3BwZWRFdmVudChyZWFzb24sIGVudmVsb3BlSXRlbVR5cGVUb0RhdGFDYXRlZ29yeSh0eXBlKSwgZXZlbnQpOwogICAgICB9KTsKICAgIH07CgogICAgY29uc3QgcmVxdWVzdFRhc2sgPSAoKSA9PgogICAgICBtYWtlUmVxdWVzdCh7IGJvZHk6IHNlcmlhbGl6ZUVudmVsb3BlKGZpbHRlcmVkRW52ZWxvcGUsIG9wdGlvbnMudGV4dEVuY29kZXIpIH0pLnRoZW4oCiAgICAgICAgcmVzcG9uc2UgPT4gewogICAgICAgICAgLy8gV2UgZG9uJ3Qgd2FudCB0byB0aHJvdyBvbiBOT0sgcmVzcG9uc2VzLCBidXQgd2Ugd2FudCB0byBhdCBsZWFzdCBsb2cgdGhlbQogICAgICAgICAgaWYgKHJlc3BvbnNlLnN0YXR1c0NvZGUgIT09IHVuZGVmaW5lZCAmJiAocmVzcG9uc2Uuc3RhdHVzQ29kZSA8IDIwMCB8fCByZXNwb25zZS5zdGF0dXNDb2RlID49IDMwMCkpIHsKICAgICAgICAgICAgREVCVUdfQlVJTEQgJiYgbG9nZ2VyLndhcm4oYFNlbnRyeSByZXNwb25kZWQgd2l0aCBzdGF0dXMgY29kZSAke3Jlc3BvbnNlLnN0YXR1c0NvZGV9IHRvIHNlbnQgZXZlbnQuYCk7CiAgICAgICAgICB9CgogICAgICAgICAgcmF0ZUxpbWl0cyA9IHVwZGF0ZVJhdGVMaW1pdHMocmF0ZUxpbWl0cywgcmVzcG9uc2UpOwogICAgICAgICAgcmV0dXJuIHJlc3BvbnNlOwogICAgICAgIH0sCiAgICAgICAgZXJyb3IgPT4gewogICAgICAgICAgcmVjb3JkRW52ZWxvcGVMb3NzKCduZXR3b3JrX2Vycm9yJyk7CiAgICAgICAgICB0aHJvdyBlcnJvcjsKICAgICAgICB9LAogICAgICApOwoKICAgIHJldHVybiBidWZmZXIuYWRkKHJlcXVlc3RUYXNrKS50aGVuKAogICAgICByZXN1bHQgPT4gcmVzdWx0LAogICAgICBlcnJvciA9PiB7CiAgICAgICAgaWYgKGVycm9yIGluc3RhbmNlb2YgU2VudHJ5RXJyb3IpIHsKICAgICAgICAgIERFQlVHX0JVSUxEICYmIGxvZ2dlci5lcnJvcignU2tpcHBlZCBzZW5kaW5nIGV2ZW50IGJlY2F1c2UgYnVmZmVyIGlzIGZ1bGwuJyk7CiAgICAgICAgICByZWNvcmRFbnZlbG9wZUxvc3MoJ3F1ZXVlX292ZXJmbG93Jyk7CiAgICAgICAgICByZXR1cm4gcmVzb2x2ZWRTeW5jUHJvbWlzZSgpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICB0aHJvdyBlcnJvcjsKICAgICAgICB9CiAgICAgIH0sCiAgICApOwogIH0KCiAgLy8gV2UgdXNlIHRoaXMgdG8gaWRlbnRpZmlmeSBpZiB0aGUgdHJhbnNwb3J0IGlzIHRoZSBiYXNlIHRyYW5zcG9ydAogIC8vIFRPRE8gKHY4KTogUmVtb3ZlIHRoaXMgYWdhaW4gYXMgd2UnbGwgbm8gbG9uZ2VyIG5lZWQgaXQKICBzZW5kLl9fc2VudHJ5X19iYXNlVHJhbnNwb3J0X18gPSB0cnVlOwoKICByZXR1cm4gewogICAgc2VuZCwKICAgIGZsdXNoLAogIH07Cn0KCmZ1bmN0aW9uIGdldEV2ZW50Rm9yRW52ZWxvcGVJdGVtKGl0ZW0sIHR5cGUpIHsKICBpZiAodHlwZSAhPT0gJ2V2ZW50JyAmJiB0eXBlICE9PSAndHJhbnNhY3Rpb24nKSB7CiAgICByZXR1cm4gdW5kZWZpbmVkOwogIH0KCiAgcmV0dXJuIEFycmF5LmlzQXJyYXkoaXRlbSkgPyAoaXRlbSApWzFdIDogdW5kZWZpbmVkOwp9CgovKiogbm9ybWFsaXplcyBXaW5kb3dzIHBhdGhzICovCmZ1bmN0aW9uIG5vcm1hbGl6ZVdpbmRvd3NQYXRoKHBhdGgpIHsKICByZXR1cm4gcGF0aAogICAgLnJlcGxhY2UoL15bQS1aXTovLCAnJykgLy8gcmVtb3ZlIFdpbmRvd3Mtc3R5bGUgcHJlZml4CiAgICAucmVwbGFjZSgvXFwvZywgJy8nKTsgLy8gcmVwbGFjZSBhbGwgYFxgIGluc3RhbmNlcyB3aXRoIGAvYAp9CgovKiogQ3JlYXRlcyBhIGZ1bmN0aW9uIHRoYXQgZ2V0cyB0aGUgbW9kdWxlIG5hbWUgZnJvbSBhIGZpbGVuYW1lICovCmZ1bmN0aW9uIGNyZWF0ZUdldE1vZHVsZUZyb21GaWxlbmFtZSgKICBiYXNlUGF0aCA9IHByb2Nlc3MuYXJndlsxXSA/IGRpcm5hbWUocHJvY2Vzcy5hcmd2WzFdKSA6IHByb2Nlc3MuY3dkKCksCiAgaXNXaW5kb3dzID0gc2VwID09PSAnXFwnLAopIHsKICBjb25zdCBub3JtYWxpemVkQmFzZSA9IGlzV2luZG93cyA/IG5vcm1hbGl6ZVdpbmRvd3NQYXRoKGJhc2VQYXRoKSA6IGJhc2VQYXRoOwoKICByZXR1cm4gKGZpbGVuYW1lKSA9PiB7CiAgICBpZiAoIWZpbGVuYW1lKSB7CiAgICAgIHJldHVybjsKICAgIH0KCiAgICBjb25zdCBub3JtYWxpemVkRmlsZW5hbWUgPSBpc1dpbmRvd3MgPyBub3JtYWxpemVXaW5kb3dzUGF0aChmaWxlbmFtZSkgOiBmaWxlbmFtZTsKCiAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgcHJlZmVyLWNvbnN0CiAgICBsZXQgeyBkaXIsIGJhc2U6IGZpbGUsIGV4dCB9ID0gcG9zaXgucGFyc2Uobm9ybWFsaXplZEZpbGVuYW1lKTsKCiAgICBpZiAoZXh0ID09PSAnLmpzJyB8fCBleHQgPT09ICcubWpzJyB8fCBleHQgPT09ICcuY2pzJykgewogICAgICBmaWxlID0gZmlsZS5zbGljZSgwLCBleHQubGVuZ3RoICogLTEpOwogICAgfQoKICAgIGlmICghZGlyKSB7CiAgICAgIC8vIE5vIGRpcm5hbWUgd2hhdHNvZXZlcgogICAgICBkaXIgPSAnLic7CiAgICB9CgogICAgY29uc3QgbiA9IGRpci5sYXN0SW5kZXhPZignL25vZGVfbW9kdWxlcycpOwogICAgaWYgKG4gPiAtMSkgewogICAgICByZXR1cm4gYCR7ZGlyLnNsaWNlKG4gKyAxNCkucmVwbGFjZSgvXC8vZywgJy4nKX06JHtmaWxlfWA7CiAgICB9CgogICAgLy8gTGV0J3Mgc2VlIGlmIGl0J3MgYSBwYXJ0IG9mIHRoZSBtYWluIG1vZHVsZQogICAgLy8gVG8gYmUgYSBwYXJ0IG9mIG1haW4gbW9kdWxlLCBpdCBoYXMgdG8gc2hhcmUgdGhlIHNhbWUgYmFzZQogICAgaWYgKGRpci5zdGFydHNXaXRoKG5vcm1hbGl6ZWRCYXNlKSkgewogICAgICBsZXQgbW9kdWxlTmFtZSA9IGRpci5zbGljZShub3JtYWxpemVkQmFzZS5sZW5ndGggKyAxKS5yZXBsYWNlKC9cLy9nLCAnLicpOwoKICAgICAgaWYgKG1vZHVsZU5hbWUpIHsKICAgICAgICBtb2R1bGVOYW1lICs9ICc6JzsKICAgICAgfQogICAgICBtb2R1bGVOYW1lICs9IGZpbGU7CgogICAgICByZXR1cm4gbW9kdWxlTmFtZTsKICAgIH0KCiAgICByZXR1cm4gZmlsZTsKICB9Owp9CgpmdW5jdGlvbiBfbnVsbGlzaENvYWxlc2NlJDIobGhzLCByaHNGbikgeyBpZiAobGhzICE9IG51bGwpIHsgcmV0dXJuIGxoczsgfSBlbHNlIHsgcmV0dXJuIHJoc0ZuKCk7IH0gfS8qKgogKiBUaGlzIGNvZGUgd2FzIG9yaWdpbmFsbHkgZm9ya2VkIGZyb20gaHR0cHM6Ly9naXRodWIuY29tL1Rvb1RhbGxOYXRlL3Byb3h5LWFnZW50cy90cmVlL2IxMzMyOTVmZDE2ZjY0NzU1NzhiNmIxNWJkOWI0ZTMzZWNiMGQwYjcKICogV2l0aCB0aGUgZm9sbG93aW5nIGxpY2VuY2U6CiAqCiAqIChUaGUgTUlUIExpY2Vuc2UpCiAqCiAqIENvcHlyaWdodCAoYykgMjAxMyBOYXRoYW4gUmFqbGljaCA8bmF0aGFuQHRvb3RhbGxuYXRlLm5ldD4qCiAqCiAqIFBlcm1pc3Npb24gaXMgaGVyZWJ5IGdyYW50ZWQsIGZyZWUgb2YgY2hhcmdlLCB0byBhbnkgcGVyc29uIG9idGFpbmluZwogKiBhIGNvcHkgb2YgdGhpcyBzb2Z0d2FyZSBhbmQgYXNzb2NpYXRlZCBkb2N1bWVudGF0aW9uIGZpbGVzICh0aGUKICogJ1NvZnR3YXJlJyksIHRvIGRlYWwgaW4gdGhlIFNvZnR3YXJlIHdpdGhvdXQgcmVzdHJpY3Rpb24sIGluY2x1ZGluZwogKiB3aXRob3V0IGxpbWl0YXRpb24gdGhlIHJpZ2h0cyB0byB1c2UsIGNvcHksIG1vZGlmeSwgbWVyZ2UsIHB1Ymxpc2gsCiAqIGRpc3RyaWJ1dGUsIHN1YmxpY2Vuc2UsIGFuZC9vciBzZWxsIGNvcGllcyBvZiB0aGUgU29mdHdhcmUsIGFuZCB0bwogKiBwZXJtaXQgcGVyc29ucyB0byB3aG9tIHRoZSBTb2Z0d2FyZSBpcyBmdXJuaXNoZWQgdG8gZG8gc28sIHN1YmplY3QgdG8KICogdGhlIGZvbGxvd2luZyBjb25kaXRpb25zOioKICoKICogVGhlIGFib3ZlIGNvcHlyaWdodCBub3RpY2UgYW5kIHRoaXMgcGVybWlzc2lvbiBub3RpY2Ugc2hhbGwgYmUKICogaW5jbHVkZWQgaW4gYWxsIGNvcGllcyBvciBzdWJzdGFudGlhbCBwb3J0aW9ucyBvZiB0aGUgU29mdHdhcmUuKgogKgogKiBUSEUgU09GVFdBUkUgSVMgUFJPVklERUQgJ0FTIElTJywgV0lUSE9VVCBXQVJSQU5UWSBPRiBBTlkgS0lORCwKICogRVhQUkVTUyBPUiBJTVBMSUVELCBJTkNMVURJTkcgQlVUIE5PVCBMSU1JVEVEIFRPIFRIRSBXQVJSQU5USUVTIE9GCiAqIE1FUkNIQU5UQUJJTElUWSwgRklUTkVTUyBGT1IgQSBQQVJUSUNVTEFSIFBVUlBPU0UgQU5EIE5PTklORlJJTkdFTUVOVC4KICogSU4gTk8gRVZFTlQgU0hBTEwgVEhFIEFVVEhPUlMgT1IgQ09QWVJJR0hUIEhPTERFUlMgQkUgTElBQkxFIEZPUiBBTlkKICogQ0xBSU0sIERBTUFHRVMgT1IgT1RIRVIgTElBQklMSVRZLCBXSEVUSEVSIElOIEFOIEFDVElPTiBPRiBDT05UUkFDVCwKICogVE9SVCBPUiBPVEhFUldJU0UsIEFSSVNJTkcgRlJPTSwgT1VUIE9GIE9SIElOIENPTk5FQ1RJT04gV0lUSCBUSEUKICogU09GVFdBUkUgT1IgVEhFIFVTRSBPUiBPVEhFUiBERUFMSU5HUyBJTiBUSEUgU09GVFdBUkUuCiAqLwoKY29uc3QgSU5URVJOQUwgPSBTeW1ib2woJ0FnZW50QmFzZUludGVybmFsU3RhdGUnKTsKCmNsYXNzIEFnZW50IGV4dGVuZHMgaHR0cC5BZ2VudCB7CgogIC8vIFNldCBieSBgaHR0cC5BZ2VudGAgLSBtaXNzaW5nIGZyb20gYEB0eXBlcy9ub2RlYAoKICBjb25zdHJ1Y3RvcihvcHRzKSB7CiAgICBzdXBlcihvcHRzKTsKICAgIHRoaXNbSU5URVJOQUxdID0ge307CiAgfQoKICAvKioKICAgKiBEZXRlcm1pbmUgd2hldGhlciB0aGlzIGlzIGFuIGBodHRwYCBvciBgaHR0cHNgIHJlcXVlc3QuCiAgICovCiAgaXNTZWN1cmVFbmRwb2ludChvcHRpb25zKSB7CiAgICBpZiAob3B0aW9ucykgewogICAgICAvLyBGaXJzdCBjaGVjayB0aGUgYHNlY3VyZUVuZHBvaW50YCBwcm9wZXJ0eSBleHBsaWNpdGx5LCBzaW5jZSB0aGlzCiAgICAgIC8vIG1lYW5zIHRoYXQgYSBwYXJlbnQgYEFnZW50YCBpcyAicGFzc2luZyB0aHJvdWdoIiB0byB0aGlzIGluc3RhbmNlLgogICAgICAvLyBlc2xpbnQtZGlzYWJsZS1uZXh0LWxpbmUgQHR5cGVzY3JpcHQtZXNsaW50L25vLWV4cGxpY2l0LWFueSwgQHR5cGVzY3JpcHQtZXNsaW50L25vLXVuc2FmZS1tZW1iZXItYWNjZXNzCiAgICAgIGlmICh0eXBlb2YgKG9wdGlvbnMgKS5zZWN1cmVFbmRwb2ludCA9PT0gJ2Jvb2xlYW4nKSB7CiAgICAgICAgcmV0dXJuIG9wdGlvbnMuc2VjdXJlRW5kcG9pbnQ7CiAgICAgIH0KCiAgICAgIC8vIElmIG5vIGV4cGxpY2l0IGBzZWN1cmVgIGVuZHBvaW50LCBjaGVjayBpZiBgcHJvdG9jb2xgIHByb3BlcnR5IGlzCiAgICAgIC8vIHNldC4gVGhpcyB3aWxsIHVzdWFsbHkgYmUgdGhlIGNhc2Ugc2luY2UgdXNpbmcgYSBmdWxsIHN0cmluZyBVUkwKICAgICAgLy8gb3IgYFVSTGAgaW5zdGFuY2Ugc2hvdWxkIGJlIHRoZSBtb3N0IGNvbW1vbiB1c2FnZS4KICAgICAgaWYgKHR5cGVvZiBvcHRpb25zLnByb3RvY29sID09PSAnc3RyaW5nJykgewogICAgICAgIHJldHVybiBvcHRpb25zLnByb3RvY29sID09PSAnaHR0cHM6JzsKICAgICAgfQogICAgfQoKICAgIC8vIEZpbmFsbHksIGlmIG5vIGBwcm90b2NvbGAgcHJvcGVydHkgd2FzIHNldCwgdGhlbiBmYWxsIGJhY2sgdG8KICAgIC8vIGNoZWNraW5nIHRoZSBzdGFjayB0cmFjZSBvZiB0aGUgY3VycmVudCBjYWxsIHN0YWNrLCBhbmQgdHJ5IHRvCiAgICAvLyBkZXRlY3QgdGhlICJodHRwcyIgbW9kdWxlLgogICAgY29uc3QgeyBzdGFjayB9ID0gbmV3IEVycm9yKCk7CiAgICBpZiAodHlwZW9mIHN0YWNrICE9PSAnc3RyaW5nJykgcmV0dXJuIGZhbHNlOwogICAgcmV0dXJuIHN0YWNrLnNwbGl0KCdcbicpLnNvbWUobCA9PiBsLmluZGV4T2YoJyhodHRwcy5qczonKSAhPT0gLTEgfHwgbC5pbmRleE9mKCdub2RlOmh0dHBzOicpICE9PSAtMSk7CiAgfQoKICBjcmVhdGVTb2NrZXQocmVxLCBvcHRpb25zLCBjYikgewogICAgY29uc3QgY29ubmVjdE9wdHMgPSB7CiAgICAgIC4uLm9wdGlvbnMsCiAgICAgIHNlY3VyZUVuZHBvaW50OiB0aGlzLmlzU2VjdXJlRW5kcG9pbnQob3B0aW9ucyksCiAgICB9OwogICAgUHJvbWlzZS5yZXNvbHZlKCkKICAgICAgLnRoZW4oKCkgPT4gdGhpcy5jb25uZWN0KHJlcSwgY29ubmVjdE9wdHMpKQogICAgICAudGhlbihzb2NrZXQgPT4gewogICAgICAgIGlmIChzb2NrZXQgaW5zdGFuY2VvZiBodHRwLkFnZW50KSB7CiAgICAgICAgICAvLyBAdHMtZXhwZWN0LWVycm9yIGBhZGRSZXF1ZXN0KClgIGlzbid0IGRlZmluZWQgaW4gYEB0eXBlcy9ub2RlYAogICAgICAgICAgcmV0dXJuIHNvY2tldC5hZGRSZXF1ZXN0KHJlcSwgY29ubmVjdE9wdHMpOwogICAgICAgIH0KICAgICAgICB0aGlzW0lOVEVSTkFMXS5jdXJyZW50U29ja2V0ID0gc29ja2V0OwogICAgICAgIC8vIEB0cy1leHBlY3QtZXJyb3IgYGNyZWF0ZVNvY2tldCgpYCBpc24ndCBkZWZpbmVkIGluIGBAdHlwZXMvbm9kZWAKICAgICAgICBzdXBlci5jcmVhdGVTb2NrZXQocmVxLCBvcHRpb25zLCBjYik7CiAgICAgIH0sIGNiKTsKICB9CgogIGNyZWF0ZUNvbm5lY3Rpb24oKSB7CiAgICBjb25zdCBzb2NrZXQgPSB0aGlzW0lOVEVSTkFMXS5jdXJyZW50U29ja2V0OwogICAgdGhpc1tJTlRFUk5BTF0uY3VycmVudFNvY2tldCA9IHVuZGVmaW5lZDsKICAgIGlmICghc29ja2V0KSB7CiAgICAgIHRocm93IG5ldyBFcnJvcignTm8gc29ja2V0IHdhcyByZXR1cm5lZCBpbiB0aGUgYGNvbm5lY3QoKWAgZnVuY3Rpb24nKTsKICAgIH0KICAgIHJldHVybiBzb2NrZXQ7CiAgfQoKICBnZXQgZGVmYXVsdFBvcnQoKSB7CiAgICByZXR1cm4gX251bGxpc2hDb2FsZXNjZSQyKHRoaXNbSU5URVJOQUxdLmRlZmF1bHRQb3J0LCAoKSA9PiAoICh0aGlzLnByb3RvY29sID09PSAnaHR0cHM6JyA/IDQ0MyA6IDgwKSkpOwogIH0KCiAgc2V0IGRlZmF1bHRQb3J0KHYpIHsKICAgIGlmICh0aGlzW0lOVEVSTkFMXSkgewogICAgICB0aGlzW0lOVEVSTkFMXS5kZWZhdWx0UG9ydCA9IHY7CiAgICB9CiAgfQoKICBnZXQgcHJvdG9jb2woKSB7CiAgICByZXR1cm4gX251bGxpc2hDb2FsZXNjZSQyKHRoaXNbSU5URVJOQUxdLnByb3RvY29sLCAoKSA9PiAoICh0aGlzLmlzU2VjdXJlRW5kcG9pbnQoKSA/ICdodHRwczonIDogJ2h0dHA6JykpKTsKICB9CgogIHNldCBwcm90b2NvbCh2KSB7CiAgICBpZiAodGhpc1tJTlRFUk5BTF0pIHsKICAgICAgdGhpc1tJTlRFUk5BTF0ucHJvdG9jb2wgPSB2OwogICAgfQogIH0KfQoKZnVuY3Rpb24gZGVidWckMSguLi5hcmdzKSB7CiAgbG9nZ2VyLmxvZygnW2h0dHBzLXByb3h5LWFnZW50OnBhcnNlLXByb3h5LXJlc3BvbnNlXScsIC4uLmFyZ3MpOwp9CgpmdW5jdGlvbiBwYXJzZVByb3h5UmVzcG9uc2Uoc29ja2V0KSB7CiAgcmV0dXJuIG5ldyBQcm9taXNlKChyZXNvbHZlLCByZWplY3QpID0+IHsKICAgIC8vIHdlIG5lZWQgdG8gYnVmZmVyIGFueSBIVFRQIHRyYWZmaWMgdGhhdCBoYXBwZW5zIHdpdGggdGhlIHByb3h5IGJlZm9yZSB3ZSBnZXQKICAgIC8vIHRoZSBDT05ORUNUIHJlc3BvbnNlLCBzbyB0aGF0IGlmIHRoZSByZXNwb25zZSBpcyBhbnl0aGluZyBvdGhlciB0aGFuIGFuICIyMDAiCiAgICAvLyByZXNwb25zZSBjb2RlLCB0aGVuIHdlIGNhbiByZS1wbGF5IHRoZSAiZGF0YSIgZXZlbnRzIG9uIHRoZSBzb2NrZXQgb25jZSB0aGUKICAgIC8vIEhUVFAgcGFyc2VyIGlzIGhvb2tlZCB1cC4uLgogICAgbGV0IGJ1ZmZlcnNMZW5ndGggPSAwOwogICAgY29uc3QgYnVmZmVycyA9IFtdOwoKICAgIGZ1bmN0aW9uIHJlYWQoKSB7CiAgICAgIGNvbnN0IGIgPSBzb2NrZXQucmVhZCgpOwogICAgICBpZiAoYikgb25kYXRhKGIpOwogICAgICBlbHNlIHNvY2tldC5vbmNlKCdyZWFkYWJsZScsIHJlYWQpOwogICAgfQoKICAgIGZ1bmN0aW9uIGNsZWFudXAoKSB7CiAgICAgIHNvY2tldC5yZW1vdmVMaXN0ZW5lcignZW5kJywgb25lbmQpOwogICAgICBzb2NrZXQucmVtb3ZlTGlzdGVuZXIoJ2Vycm9yJywgb25lcnJvcik7CiAgICAgIHNvY2tldC5yZW1vdmVMaXN0ZW5lcigncmVhZGFibGUnLCByZWFkKTsKICAgIH0KCiAgICBmdW5jdGlvbiBvbmVuZCgpIHsKICAgICAgY2xlYW51cCgpOwogICAgICBkZWJ1ZyQxKCdvbmVuZCcpOwogICAgICByZWplY3QobmV3IEVycm9yKCdQcm94eSBjb25uZWN0aW9uIGVuZGVkIGJlZm9yZSByZWNlaXZpbmcgQ09OTkVDVCByZXNwb25zZScpKTsKICAgIH0KCiAgICBmdW5jdGlvbiBvbmVycm9yKGVycikgewogICAgICBjbGVhbnVwKCk7CiAgICAgIGRlYnVnJDEoJ29uZXJyb3IgJW8nLCBlcnIpOwogICAgICByZWplY3QoZXJyKTsKICAgIH0KCiAgICBmdW5jdGlvbiBvbmRhdGEoYikgewogICAgICBidWZmZXJzLnB1c2goYik7CiAgICAgIGJ1ZmZlcnNMZW5ndGggKz0gYi5sZW5ndGg7CgogICAgICBjb25zdCBidWZmZXJlZCA9IEJ1ZmZlci5jb25jYXQoYnVmZmVycywgYnVmZmVyc0xlbmd0aCk7CiAgICAgIGNvbnN0IGVuZE9mSGVhZGVycyA9IGJ1ZmZlcmVkLmluZGV4T2YoJ1xyXG5cclxuJyk7CgogICAgICBpZiAoZW5kT2ZIZWFkZXJzID09PSAtMSkgewogICAgICAgIC8vIGtlZXAgYnVmZmVyaW5nCiAgICAgICAgZGVidWckMSgnaGF2ZSBub3QgcmVjZWl2ZWQgZW5kIG9mIEhUVFAgaGVhZGVycyB5ZXQuLi4nKTsKICAgICAgICByZWFkKCk7CiAgICAgICAgcmV0dXJuOwogICAgICB9CgogICAgICBjb25zdCBoZWFkZXJQYXJ0cyA9IGJ1ZmZlcmVkLnNsaWNlKDAsIGVuZE9mSGVhZGVycykudG9TdHJpbmcoJ2FzY2lpJykuc3BsaXQoJ1xyXG4nKTsKICAgICAgY29uc3QgZmlyc3RMaW5lID0gaGVhZGVyUGFydHMuc2hpZnQoKTsKICAgICAgaWYgKCFmaXJzdExpbmUpIHsKICAgICAgICBzb2NrZXQuZGVzdHJveSgpOwogICAgICAgIHJldHVybiByZWplY3QobmV3IEVycm9yKCdObyBoZWFkZXIgcmVjZWl2ZWQgZnJvbSBwcm94eSBDT05ORUNUIHJlc3BvbnNlJykpOwogICAgICB9CiAgICAgIGNvbnN0IGZpcnN0TGluZVBhcnRzID0gZmlyc3RMaW5lLnNwbGl0KCcgJyk7CiAgICAgIGNvbnN0IHN0YXR1c0NvZGUgPSArZmlyc3RMaW5lUGFydHNbMV07CiAgICAgIGNvbnN0IHN0YXR1c1RleHQgPSBmaXJzdExpbmVQYXJ0cy5zbGljZSgyKS5qb2luKCcgJyk7CiAgICAgIGNvbnN0IGhlYWRlcnMgPSB7fTsKICAgICAgZm9yIChjb25zdCBoZWFkZXIgb2YgaGVhZGVyUGFydHMpIHsKICAgICAgICBpZiAoIWhlYWRlcikgY29udGludWU7CiAgICAgICAgY29uc3QgZmlyc3RDb2xvbiA9IGhlYWRlci5pbmRleE9mKCc6Jyk7CiAgICAgICAgaWYgKGZpcnN0Q29sb24gPT09IC0xKSB7CiAgICAgICAgICBzb2NrZXQuZGVzdHJveSgpOwogICAgICAgICAgcmV0dXJuIHJlamVjdChuZXcgRXJyb3IoYEludmFsaWQgaGVhZGVyIGZyb20gcHJveHkgQ09OTkVDVCByZXNwb25zZTogIiR7aGVhZGVyfSJgKSk7CiAgICAgICAgfQogICAgICAgIGNvbnN0IGtleSA9IGhlYWRlci5zbGljZSgwLCBmaXJzdENvbG9uKS50b0xvd2VyQ2FzZSgpOwogICAgICAgIGNvbnN0IHZhbHVlID0gaGVhZGVyLnNsaWNlKGZpcnN0Q29sb24gKyAxKS50cmltU3RhcnQoKTsKICAgICAgICBjb25zdCBjdXJyZW50ID0gaGVhZGVyc1trZXldOwogICAgICAgIGlmICh0eXBlb2YgY3VycmVudCA9PT0gJ3N0cmluZycpIHsKICAgICAgICAgIGhlYWRlcnNba2V5XSA9IFtjdXJyZW50LCB2YWx1ZV07CiAgICAgICAgfSBlbHNlIGlmIChBcnJheS5pc0FycmF5KGN1cnJlbnQpKSB7CiAgICAgICAgICBjdXJyZW50LnB1c2godmFsdWUpOwogICAgICAgIH0gZWxzZSB7CiAgICAgICAgICBoZWFkZXJzW2tleV0gPSB2YWx1ZTsKICAgICAgICB9CiAgICAgIH0KICAgICAgZGVidWckMSgnZ290IHByb3h5IHNlcnZlciByZXNwb25zZTogJW8gJW8nLCBmaXJzdExpbmUsIGhlYWRlcnMpOwogICAgICBjbGVhbnVwKCk7CiAgICAgIHJlc29sdmUoewogICAgICAgIGNvbm5lY3Q6IHsKICAgICAgICAgIHN0YXR1c0NvZGUsCiAgICAgICAgICBzdGF0dXNUZXh0LAogICAgICAgICAgaGVhZGVycywKICAgICAgICB9LAogICAgICAgIGJ1ZmZlcmVkLAogICAgICB9KTsKICAgIH0KCiAgICBzb2NrZXQub24oJ2Vycm9yJywgb25lcnJvcik7CiAgICBzb2NrZXQub24oJ2VuZCcsIG9uZW5kKTsKCiAgICByZWFkKCk7CiAgfSk7Cn0KCmZ1bmN0aW9uIF9udWxsaXNoQ29hbGVzY2UkMShsaHMsIHJoc0ZuKSB7IGlmIChsaHMgIT0gbnVsbCkgeyByZXR1cm4gbGhzOyB9IGVsc2UgeyByZXR1cm4gcmhzRm4oKTsgfSB9IGZ1bmN0aW9uIF9vcHRpb25hbENoYWluJDEob3BzKSB7IGxldCBsYXN0QWNjZXNzTEhTID0gdW5kZWZpbmVkOyBsZXQgdmFsdWUgPSBvcHNbMF07IGxldCBpID0gMTsgd2hpbGUgKGkgPCBvcHMubGVuZ3RoKSB7IGNvbnN0IG9wID0gb3BzW2ldOyBjb25zdCBmbiA9IG9wc1tpICsgMV07IGkgKz0gMjsgaWYgKChvcCA9PT0gJ29wdGlvbmFsQWNjZXNzJyB8fCBvcCA9PT0gJ29wdGlvbmFsQ2FsbCcpICYmIHZhbHVlID09IG51bGwpIHsgcmV0dXJuIHVuZGVmaW5lZDsgfSBpZiAob3AgPT09ICdhY2Nlc3MnIHx8IG9wID09PSAnb3B0aW9uYWxBY2Nlc3MnKSB7IGxhc3RBY2Nlc3NMSFMgPSB2YWx1ZTsgdmFsdWUgPSBmbih2YWx1ZSk7IH0gZWxzZSBpZiAob3AgPT09ICdjYWxsJyB8fCBvcCA9PT0gJ29wdGlvbmFsQ2FsbCcpIHsgdmFsdWUgPSBmbigoLi4uYXJncykgPT4gdmFsdWUuY2FsbChsYXN0QWNjZXNzTEhTLCAuLi5hcmdzKSk7IGxhc3RBY2Nlc3NMSFMgPSB1bmRlZmluZWQ7IH0gfSByZXR1cm4gdmFsdWU7IH0vKioKICogVGhpcyBjb2RlIHdhcyBvcmlnaW5hbGx5IGZvcmtlZCBmcm9tIGh0dHBzOi8vZ2l0aHViLmNvbS9Ub29UYWxsTmF0ZS9wcm94eS1hZ2VudHMvdHJlZS9iMTMzMjk1ZmQxNmY2NDc1NTc4YjZiMTViZDliNGUzM2VjYjBkMGI3CiAqIFdpdGggdGhlIGZvbGxvd2luZyBsaWNlbmNlOgogKgogKiAoVGhlIE1JVCBMaWNlbnNlKQogKgogKiBDb3B5cmlnaHQgKGMpIDIwMTMgTmF0aGFuIFJhamxpY2ggPG5hdGhhbkB0b290YWxsbmF0ZS5uZXQ+KgogKgogKiBQZXJtaXNzaW9uIGlzIGhlcmVieSBncmFudGVkLCBmcmVlIG9mIGNoYXJnZSwgdG8gYW55IHBlcnNvbiBvYnRhaW5pbmcKICogYSBjb3B5IG9mIHRoaXMgc29mdHdhcmUgYW5kIGFzc29jaWF0ZWQgZG9jdW1lbnRhdGlvbiBmaWxlcyAodGhlCiAqICdTb2Z0d2FyZScpLCB0byBkZWFsIGluIHRoZSBTb2Z0d2FyZSB3aXRob3V0IHJlc3RyaWN0aW9uLCBpbmNsdWRpbmcKICogd2l0aG91dCBsaW1pdGF0aW9uIHRoZSByaWdodHMgdG8gdXNlLCBjb3B5LCBtb2RpZnksIG1lcmdlLCBwdWJsaXNoLAogKiBkaXN0cmlidXRlLCBzdWJsaWNlbnNlLCBhbmQvb3Igc2VsbCBjb3BpZXMgb2YgdGhlIFNvZnR3YXJlLCBhbmQgdG8KICogcGVybWl0IHBlcnNvbnMgdG8gd2hvbSB0aGUgU29mdHdhcmUgaXMgZnVybmlzaGVkIHRvIGRvIHNvLCBzdWJqZWN0IHRvCiAqIHRoZSBmb2xsb3dpbmcgY29uZGl0aW9uczoqCiAqCiAqIFRoZSBhYm92ZSBjb3B5cmlnaHQgbm90aWNlIGFuZCB0aGlzIHBlcm1pc3Npb24gbm90aWNlIHNoYWxsIGJlCiAqIGluY2x1ZGVkIGluIGFsbCBjb3BpZXMgb3Igc3Vic3RhbnRpYWwgcG9ydGlvbnMgb2YgdGhlIFNvZnR3YXJlLioKICoKICogVEhFIFNPRlRXQVJFIElTIFBST1ZJREVEICdBUyBJUycsIFdJVEhPVVQgV0FSUkFOVFkgT0YgQU5ZIEtJTkQsCiAqIEVYUFJFU1MgT1IgSU1QTElFRCwgSU5DTFVESU5HIEJVVCBOT1QgTElNSVRFRCBUTyBUSEUgV0FSUkFOVElFUyBPRgogKiBNRVJDSEFOVEFCSUxJVFksIEZJVE5FU1MgRk9SIEEgUEFSVElDVUxBUiBQVVJQT1NFIEFORCBOT05JTkZSSU5HRU1FTlQuCiAqIElOIE5PIEVWRU5UIFNIQUxMIFRIRSBBVVRIT1JTIE9SIENPUFlSSUdIVCBIT0xERVJTIEJFIExJQUJMRSBGT1IgQU5ZCiAqIENMQUlNLCBEQU1BR0VTIE9SIE9USEVSIExJQUJJTElUWSwgV0hFVEhFUiBJTiBBTiBBQ1RJT04gT0YgQ09OVFJBQ1QsCiAqIFRPUlQgT1IgT1RIRVJXSVNFLCBBUklTSU5HIEZST00sIE9VVCBPRiBPUiBJTiBDT05ORUNUSU9OIFdJVEggVEhFCiAqIFNPRlRXQVJFIE9SIFRIRSBVU0UgT1IgT1RIRVIgREVBTElOR1MgSU4gVEhFIFNPRlRXQVJFLgogKi8KCmZ1bmN0aW9uIGRlYnVnKC4uLmFyZ3MpIHsKICBsb2dnZXIubG9nKCdbaHR0cHMtcHJveHktYWdlbnRdJywgLi4uYXJncyk7Cn0KCi8qKgogKiBUaGUgYEh0dHBzUHJveHlBZ2VudGAgaW1wbGVtZW50cyBhbiBIVFRQIEFnZW50IHN1YmNsYXNzIHRoYXQgY29ubmVjdHMgdG8KICogdGhlIHNwZWNpZmllZCAiSFRUUChzKSBwcm94eSBzZXJ2ZXIiIGluIG9yZGVyIHRvIHByb3h5IEhUVFBTIHJlcXVlc3RzLgogKgogKiBPdXRnb2luZyBIVFRQIHJlcXVlc3RzIGFyZSBmaXJzdCB0dW5uZWxlZCB0aHJvdWdoIHRoZSBwcm94eSBzZXJ2ZXIgdXNpbmcgdGhlCiAqIGBDT05ORUNUYCBIVFRQIHJlcXVlc3QgbWV0aG9kIHRvIGVzdGFibGlzaCBhIGNvbm5lY3Rpb24gdG8gdGhlIHByb3h5IHNlcnZlciwKICogYW5kIHRoZW4gdGhlIHByb3h5IHNlcnZlciBjb25uZWN0cyB0byB0aGUgZGVzdGluYXRpb24gdGFyZ2V0IGFuZCBpc3N1ZXMgdGhlCiAqIEhUVFAgcmVxdWVzdCBmcm9tIHRoZSBwcm94eSBzZXJ2ZXIuCiAqCiAqIGBodHRwczpgIHJlcXVlc3RzIGhhdmUgdGhlaXIgc29ja2V0IGNvbm5lY3Rpb24gdXBncmFkZWQgdG8gVExTIG9uY2UKICogdGhlIGNvbm5lY3Rpb24gdG8gdGhlIHByb3h5IHNlcnZlciBoYXMgYmVlbiBlc3RhYmxpc2hlZC4KICovCmNsYXNzIEh0dHBzUHJveHlBZ2VudCBleHRlbmRzIEFnZW50IHsKICBzdGF0aWMgX19pbml0U3RhdGljKCkge3RoaXMucHJvdG9jb2xzID0gWydodHRwJywgJ2h0dHBzJ107IH0KCiAgY29uc3RydWN0b3IocHJveHksIG9wdHMpIHsKICAgIHN1cGVyKG9wdHMpOwogICAgdGhpcy5vcHRpb25zID0ge307CiAgICB0aGlzLnByb3h5ID0gdHlwZW9mIHByb3h5ID09PSAnc3RyaW5nJyA/IG5ldyBVUkwocHJveHkpIDogcHJveHk7CiAgICB0aGlzLnByb3h5SGVhZGVycyA9IF9udWxsaXNoQ29hbGVzY2UkMShfb3B0aW9uYWxDaGFpbiQxKFtvcHRzLCAnb3B0aW9uYWxBY2Nlc3MnLCBfMiA9PiBfMi5oZWFkZXJzXSksICgpID0+ICgge30pKTsKICAgIGRlYnVnKCdDcmVhdGluZyBuZXcgSHR0cHNQcm94eUFnZW50IGluc3RhbmNlOiAlbycsIHRoaXMucHJveHkuaHJlZik7CgogICAgLy8gVHJpbSBvZmYgdGhlIGJyYWNrZXRzIGZyb20gSVB2NiBhZGRyZXNzZXMKICAgIGNvbnN0IGhvc3QgPSAodGhpcy5wcm94eS5ob3N0bmFtZSB8fCB0aGlzLnByb3h5Lmhvc3QpLnJlcGxhY2UoL15cW3xcXSQvZywgJycpOwogICAgY29uc3QgcG9ydCA9IHRoaXMucHJveHkucG9ydCA/IHBhcnNlSW50KHRoaXMucHJveHkucG9ydCwgMTApIDogdGhpcy5wcm94eS5wcm90b2NvbCA9PT0gJ2h0dHBzOicgPyA0NDMgOiA4MDsKICAgIHRoaXMuY29ubmVjdE9wdHMgPSB7CiAgICAgIC8vIEF0dGVtcHQgdG8gbmVnb3RpYXRlIGh0dHAvMS4xIGZvciBwcm94eSBzZXJ2ZXJzIHRoYXQgc3VwcG9ydCBodHRwLzIKICAgICAgQUxQTlByb3RvY29sczogWydodHRwLzEuMSddLAogICAgICAuLi4ob3B0cyA/IG9taXQob3B0cywgJ2hlYWRlcnMnKSA6IG51bGwpLAogICAgICBob3N0LAogICAgICBwb3J0LAogICAgfTsKICB9CgogIC8qKgogICAqIENhbGxlZCB3aGVuIHRoZSBub2RlLWNvcmUgSFRUUCBjbGllbnQgbGlicmFyeSBpcyBjcmVhdGluZyBhCiAgICogbmV3IEhUVFAgcmVxdWVzdC4KICAgKi8KICBhc3luYyBjb25uZWN0KHJlcSwgb3B0cykgewogICAgY29uc3QgeyBwcm94eSB9ID0gdGhpczsKCiAgICBpZiAoIW9wdHMuaG9zdCkgewogICAgICB0aHJvdyBuZXcgVHlwZUVycm9yKCdObyAiaG9zdCIgcHJvdmlkZWQnKTsKICAgIH0KCiAgICAvLyBDcmVhdGUgYSBzb2NrZXQgY29ubmVjdGlvbiB0byB0aGUgcHJveHkgc2VydmVyLgogICAgbGV0IHNvY2tldDsKICAgIGlmIChwcm94eS5wcm90b2NvbCA9PT0gJ2h0dHBzOicpIHsKICAgICAgZGVidWcoJ0NyZWF0aW5nIGB0bHMuU29ja2V0YDogJW8nLCB0aGlzLmNvbm5lY3RPcHRzKTsKICAgICAgY29uc3Qgc2VydmVybmFtZSA9IHRoaXMuY29ubmVjdE9wdHMuc2VydmVybmFtZSB8fCB0aGlzLmNvbm5lY3RPcHRzLmhvc3Q7CiAgICAgIHNvY2tldCA9IHRscy5jb25uZWN0KHsKICAgICAgICAuLi50aGlzLmNvbm5lY3RPcHRzLAogICAgICAgIHNlcnZlcm5hbWU6IHNlcnZlcm5hbWUgJiYgbmV0LmlzSVAoc2VydmVybmFtZSkgPyB1bmRlZmluZWQgOiBzZXJ2ZXJuYW1lLAogICAgICB9KTsKICAgIH0gZWxzZSB7CiAgICAgIGRlYnVnKCdDcmVhdGluZyBgbmV0LlNvY2tldGA6ICVvJywgdGhpcy5jb25uZWN0T3B0cyk7CiAgICAgIHNvY2tldCA9IG5ldC5jb25uZWN0KHRoaXMuY29ubmVjdE9wdHMpOwogICAgfQoKICAgIGNvbnN0IGhlYWRlcnMgPQogICAgICB0eXBlb2YgdGhpcy5wcm94eUhlYWRlcnMgPT09ICdmdW5jdGlvbicgPyB0aGlzLnByb3h5SGVhZGVycygpIDogeyAuLi50aGlzLnByb3h5SGVhZGVycyB9OwogICAgY29uc3QgaG9zdCA9IG5ldC5pc0lQdjYob3B0cy5ob3N0KSA/IGBbJHtvcHRzLmhvc3R9XWAgOiBvcHRzLmhvc3Q7CiAgICBsZXQgcGF5bG9hZCA9IGBDT05ORUNUICR7aG9zdH06JHtvcHRzLnBvcnR9IEhUVFAvMS4xXHJcbmA7CgogICAgLy8gSW5qZWN0IHRoZSBgUHJveHktQXV0aG9yaXphdGlvbmAgaGVhZGVyIGlmIG5lY2Vzc2FyeS4KICAgIGlmIChwcm94eS51c2VybmFtZSB8fCBwcm94eS5wYXNzd29yZCkgewogICAgICBjb25zdCBhdXRoID0gYCR7ZGVjb2RlVVJJQ29tcG9uZW50KHByb3h5LnVzZXJuYW1lKX06JHtkZWNvZGVVUklDb21wb25lbnQocHJveHkucGFzc3dvcmQpfWA7CiAgICAgIGhlYWRlcnNbJ1Byb3h5LUF1dGhvcml6YXRpb24nXSA9IGBCYXNpYyAke0J1ZmZlci5mcm9tKGF1dGgpLnRvU3RyaW5nKCdiYXNlNjQnKX1gOwogICAgfQoKICAgIGhlYWRlcnMuSG9zdCA9IGAke2hvc3R9OiR7b3B0cy5wb3J0fWA7CgogICAgaWYgKCFoZWFkZXJzWydQcm94eS1Db25uZWN0aW9uJ10pIHsKICAgICAgaGVhZGVyc1snUHJveHktQ29ubmVjdGlvbiddID0gdGhpcy5rZWVwQWxpdmUgPyAnS2VlcC1BbGl2ZScgOiAnY2xvc2UnOwogICAgfQogICAgZm9yIChjb25zdCBuYW1lIG9mIE9iamVjdC5rZXlzKGhlYWRlcnMpKSB7CiAgICAgIHBheWxvYWQgKz0gYCR7bmFtZX06ICR7aGVhZGVyc1tuYW1lXX1cclxuYDsKICAgIH0KCiAgICBjb25zdCBwcm94eVJlc3BvbnNlUHJvbWlzZSA9IHBhcnNlUHJveHlSZXNwb25zZShzb2NrZXQpOwoKICAgIHNvY2tldC53cml0ZShgJHtwYXlsb2FkfVxyXG5gKTsKCiAgICBjb25zdCB7IGNvbm5lY3QsIGJ1ZmZlcmVkIH0gPSBhd2FpdCBwcm94eVJlc3BvbnNlUHJvbWlzZTsKICAgIHJlcS5lbWl0KCdwcm94eUNvbm5lY3QnLCBjb25uZWN0KTsKICAgIC8vIGVzbGludC1kaXNhYmxlLW5leHQtbGluZSBAdHlwZXNjcmlwdC1lc2xpbnQvYmFuLXRzLWNvbW1lbnQKICAgIC8vIEB0cy1pZ25vcmUgTm90IEV2ZW50RW1pdHRlciBpbiBOb2RlIHR5cGVzCiAgICB0aGlzLmVtaXQoJ3Byb3h5Q29ubmVjdCcsIGNvbm5lY3QsIHJlcSk7CgogICAgaWYgKGNvbm5lY3Quc3RhdHVzQ29kZSA9PT0gMjAwKSB7CiAgICAgIHJlcS5vbmNlKCdzb2NrZXQnLCByZXN1bWUpOwoKICAgICAgaWYgKG9wdHMuc2VjdXJlRW5kcG9pbnQpIHsKICAgICAgICAvLyBUaGUgcHJveHkgaXMgY29ubmVjdGluZyB0byBhIFRMUyBzZXJ2ZXIsIHNvIHVwZ3JhZGUKICAgICAgICAvLyB0aGlzIHNvY2tldCBjb25uZWN0aW9uIHRvIGEgVExTIGNvbm5lY3Rpb24uCiAgICAgICAgZGVidWcoJ1VwZ3JhZGluZyBzb2NrZXQgY29ubmVjdGlvbiB0byBUTFMnKTsKICAgICAgICBjb25zdCBzZXJ2ZXJuYW1lID0gb3B0cy5zZXJ2ZXJuYW1lIHx8IG9wdHMuaG9zdDsKICAgICAgICByZXR1cm4gdGxzLmNvbm5lY3QoewogICAgICAgICAgLi4ub21pdChvcHRzLCAnaG9zdCcsICdwYXRoJywgJ3BvcnQnKSwKICAgICAgICAgIHNvY2tldCwKICAgICAgICAgIHNlcnZlcm5hbWU6IG5ldC5pc0lQKHNlcnZlcm5hbWUpID8gdW5kZWZpbmVkIDogc2VydmVybmFtZSwKICAgICAgICB9KTsKICAgICAgfQoKICAgICAgcmV0dXJuIHNvY2tldDsKICAgIH0KCiAgICAvLyBTb21lIG90aGVyIHN0YXR1cyBjb2RlIHRoYXQncyBub3QgMjAwLi4uIG5lZWQgdG8gcmUtcGxheSB0aGUgSFRUUAogICAgLy8gaGVhZGVyICJkYXRhIiBldmVudHMgb250byB0aGUgc29ja2V0IG9uY2UgdGhlIEhUVFAgbWFjaGluZXJ5IGlzCiAgICAvLyBhdHRhY2hlZCBzbyB0aGF0IHRoZSBub2RlIGNvcmUgYGh0dHBgIGNhbiBwYXJzZSBhbmQgaGFuZGxlIHRoZQogICAgLy8gZXJyb3Igc3RhdHVzIGNvZGUuCgogICAgLy8gQ2xvc2UgdGhlIG9yaWdpbmFsIHNvY2tldCwgYW5kIGEgbmV3ICJmYWtlIiBzb2NrZXQgaXMgcmV0dXJuZWQKICAgIC8vIGluc3RlYWQsIHNvIHRoYXQgdGhlIHByb3h5IGRvZXNuJ3QgZ2V0IHRoZSBIVFRQIHJlcXVlc3QKICAgIC8vIHdyaXR0ZW4gdG8gaXQgKHdoaWNoIG1heSBjb250YWluIGBBdXRob3JpemF0aW9uYCBoZWFkZXJzIG9yIG90aGVyCiAgICAvLyBzZW5zaXRpdmUgZGF0YSkuCiAgICAvLwogICAgLy8gU2VlOiBodHRwczovL2hhY2tlcm9uZS5jb20vcmVwb3J0cy81NDE1MDIKICAgIHNvY2tldC5kZXN0cm95KCk7CgogICAgY29uc3QgZmFrZVNvY2tldCA9IG5ldyBuZXQuU29ja2V0KHsgd3JpdGFibGU6IGZhbHNlIH0pOwogICAgZmFrZVNvY2tldC5yZWFkYWJsZSA9IHRydWU7CgogICAgLy8gTmVlZCB0byB3YWl0IGZvciB0aGUgInNvY2tldCIgZXZlbnQgdG8gcmUtcGxheSB0aGUgImRhdGEiIGV2ZW50cy4KICAgIHJlcS5vbmNlKCdzb2NrZXQnLCAocykgPT4gewogICAgICBkZWJ1ZygnUmVwbGF5aW5nIHByb3h5IGJ1ZmZlciBmb3IgZmFpbGVkIHJlcXVlc3QnKTsKICAgICAgYXNzZXJ0KHMubGlzdGVuZXJDb3VudCgnZGF0YScpID4gMCk7CgogICAgICAvLyBSZXBsYXkgdGhlICJidWZmZXJlZCIgQnVmZmVyIG9udG8gdGhlIGZha2UgYHNvY2tldGAsIHNpbmNlIGF0CiAgICAgIC8vIHRoaXMgcG9pbnQgdGhlIEhUVFAgbW9kdWxlIG1hY2hpbmVyeSBoYXMgYmVlbiBob29rZWQgdXAgZm9yCiAgICAgIC8vIHRoZSB1c2VyLgogICAgICBzLnB1c2goYnVmZmVyZWQpOwogICAgICBzLnB1c2gobnVsbCk7CiAgICB9KTsKCiAgICByZXR1cm4gZmFrZVNvY2tldDsKICB9Cn0gSHR0cHNQcm94eUFnZW50Ll9faW5pdFN0YXRpYygpOwoKZnVuY3Rpb24gcmVzdW1lKHNvY2tldCkgewogIHNvY2tldC5yZXN1bWUoKTsKfQoKZnVuY3Rpb24gb21pdCgKICBvYmosCiAgLi4ua2V5cwopCgogewogIGNvbnN0IHJldCA9IHt9Cgo7CiAgbGV0IGtleTsKICBmb3IgKGtleSBpbiBvYmopIHsKICAgIGlmICgha2V5cy5pbmNsdWRlcyhrZXkpKSB7CiAgICAgIHJldFtrZXldID0gb2JqW2tleV07CiAgICB9CiAgfQogIHJldHVybiByZXQ7Cn0KCmZ1bmN0aW9uIF9udWxsaXNoQ29hbGVzY2UobGhzLCByaHNGbikgeyBpZiAobGhzICE9IG51bGwpIHsgcmV0dXJuIGxoczsgfSBlbHNlIHsgcmV0dXJuIHJoc0ZuKCk7IH0gfQovLyBFc3RpbWF0ZWQgbWF4aW11bSBzaXplIGZvciByZWFzb25hYmxlIHN0YW5kYWxvbmUgZXZlbnQKY29uc3QgR1pJUF9USFJFU0hPTEQgPSAxMDI0ICogMzI7CgovKioKICogR2V0cyBhIHN0cmVhbSBmcm9tIGEgVWludDhBcnJheSBvciBzdHJpbmcKICogUmVhZGFibGUuZnJvbSBpcyBpZGVhbCBidXQgd2FzIGFkZGVkIGluIG5vZGUuanMgdjEyLjMuMCBhbmQgdjEwLjE3LjAKICovCmZ1bmN0aW9uIHN0cmVhbUZyb21Cb2R5KGJvZHkpIHsKICByZXR1cm4gbmV3IFJlYWRhYmxlKHsKICAgIHJlYWQoKSB7CiAgICAgIHRoaXMucHVzaChib2R5KTsKICAgICAgdGhpcy5wdXNoKG51bGwpOwogICAgfSwKICB9KTsKfQoKLyoqCiAqIENyZWF0ZXMgYSBUcmFuc3BvcnQgdGhhdCB1c2VzIG5hdGl2ZSB0aGUgbmF0aXZlICdodHRwJyBhbmQgJ2h0dHBzJyBtb2R1bGVzIHRvIHNlbmQgZXZlbnRzIHRvIFNlbnRyeS4KICovCmZ1bmN0aW9uIG1ha2VOb2RlVHJhbnNwb3J0KG9wdGlvbnMpIHsKICBsZXQgdXJsU2VnbWVudHM7CgogIHRyeSB7CiAgICB1cmxTZWdtZW50cyA9IG5ldyBVUkwob3B0aW9ucy51cmwpOwogIH0gY2F0Y2ggKGUpIHsKICAgIGNvbnNvbGVTYW5kYm94KCgpID0+IHsKICAgICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLWNvbnNvbGUKICAgICAgY29uc29sZS53YXJuKAogICAgICAgICdbQHNlbnRyeS9ub2RlXTogSW52YWxpZCBkc24gb3IgdHVubmVsIG9wdGlvbiwgd2lsbCBub3Qgc2VuZCBhbnkgZXZlbnRzLiBUaGUgdHVubmVsIG9wdGlvbiBtdXN0IGJlIGEgZnVsbCBVUkwgd2hlbiB1c2VkLicsCiAgICAgICk7CiAgICB9KTsKICAgIHJldHVybiBjcmVhdGVUcmFuc3BvcnQob3B0aW9ucywgKCkgPT4gUHJvbWlzZS5yZXNvbHZlKHt9KSk7CiAgfQoKICBjb25zdCBpc0h0dHBzID0gdXJsU2VnbWVudHMucHJvdG9jb2wgPT09ICdodHRwczonOwoKICAvLyBQcm94eSBwcmlvcml0aXphdGlvbjogaHR0cCA9PiBgb3B0aW9ucy5wcm94eWAgfCBgcHJvY2Vzcy5lbnYuaHR0cF9wcm94eWAKICAvLyBQcm94eSBwcmlvcml0aXphdGlvbjogaHR0cHMgPT4gYG9wdGlvbnMucHJveHlgIHwgYHByb2Nlc3MuZW52Lmh0dHBzX3Byb3h5YCB8IGBwcm9jZXNzLmVudi5odHRwX3Byb3h5YAogIGNvbnN0IHByb3h5ID0gYXBwbHlOb1Byb3h5T3B0aW9uKAogICAgdXJsU2VnbWVudHMsCiAgICBvcHRpb25zLnByb3h5IHx8IChpc0h0dHBzID8gcHJvY2Vzcy5lbnYuaHR0cHNfcHJveHkgOiB1bmRlZmluZWQpIHx8IHByb2Nlc3MuZW52Lmh0dHBfcHJveHksCiAgKTsKCiAgY29uc3QgbmF0aXZlSHR0cE1vZHVsZSA9IGlzSHR0cHMgPyBodHRwcyA6IGh0dHA7CiAgY29uc3Qga2VlcEFsaXZlID0gb3B0aW9ucy5rZWVwQWxpdmUgPT09IHVuZGVmaW5lZCA/IGZhbHNlIDogb3B0aW9ucy5rZWVwQWxpdmU7CgogIC8vIFRPRE8odjcpOiBFdmFsdWF0ZSBpZiB3ZSBjYW4gc2V0IGtlZXBBbGl2ZSB0byB0cnVlLiBUaGlzIHdvdWxkIGludm9sdmUgdGVzdGluZyBmb3IgbWVtb3J5IGxlYWtzIGluIG9sZGVyIG5vZGUKICAvLyB2ZXJzaW9ucyg+PSA4KSBhcyB0aGV5IGhhZCBtZW1vcnkgbGVha3Mgd2hlbiB1c2luZyBpdDogIzI1NTUKICBjb25zdCBhZ2VudCA9IHByb3h5CiAgICA/IChuZXcgSHR0cHNQcm94eUFnZW50KHByb3h5KSApCiAgICA6IG5ldyBuYXRpdmVIdHRwTW9kdWxlLkFnZW50KHsga2VlcEFsaXZlLCBtYXhTb2NrZXRzOiAzMCwgdGltZW91dDogMjAwMCB9KTsKCiAgY29uc3QgcmVxdWVzdEV4ZWN1dG9yID0gY3JlYXRlUmVxdWVzdEV4ZWN1dG9yKG9wdGlvbnMsIF9udWxsaXNoQ29hbGVzY2Uob3B0aW9ucy5odHRwTW9kdWxlLCAoKSA9PiAoIG5hdGl2ZUh0dHBNb2R1bGUpKSwgYWdlbnQpOwogIHJldHVybiBjcmVhdGVUcmFuc3BvcnQob3B0aW9ucywgcmVxdWVzdEV4ZWN1dG9yKTsKfQoKLyoqCiAqIEhvbm9ycyB0aGUgYG5vX3Byb3h5YCBlbnYgdmFyaWFibGUgd2l0aCB0aGUgaGlnaGVzdCBwcmlvcml0eSB0byBhbGxvdyBmb3IgaG9zdHMgZXhjbHVzaW9uLgogKgogKiBAcGFyYW0gdHJhbnNwb3J0VXJsIFRoZSBVUkwgdGhlIHRyYW5zcG9ydCBpbnRlbmRzIHRvIHNlbmQgZXZlbnRzIHRvLgogKiBAcGFyYW0gcHJveHkgVGhlIGNsaWVudCBjb25maWd1cmVkIHByb3h5LgogKiBAcmV0dXJucyBBIHByb3h5IHRoZSB0cmFuc3BvcnQgc2hvdWxkIHVzZS4KICovCmZ1bmN0aW9uIGFwcGx5Tm9Qcm94eU9wdGlvbih0cmFuc3BvcnRVcmxTZWdtZW50cywgcHJveHkpIHsKICBjb25zdCB7IG5vX3Byb3h5IH0gPSBwcm9jZXNzLmVudjsKCiAgY29uc3QgdXJsSXNFeGVtcHRGcm9tUHJveHkgPQogICAgbm9fcHJveHkgJiYKICAgIG5vX3Byb3h5CiAgICAgIC5zcGxpdCgnLCcpCiAgICAgIC5zb21lKAogICAgICAgIGV4ZW1wdGlvbiA9PiB0cmFuc3BvcnRVcmxTZWdtZW50cy5ob3N0LmVuZHNXaXRoKGV4ZW1wdGlvbikgfHwgdHJhbnNwb3J0VXJsU2VnbWVudHMuaG9zdG5hbWUuZW5kc1dpdGgoZXhlbXB0aW9uKSwKICAgICAgKTsKCiAgaWYgKHVybElzRXhlbXB0RnJvbVByb3h5KSB7CiAgICByZXR1cm4gdW5kZWZpbmVkOwogIH0gZWxzZSB7CiAgICByZXR1cm4gcHJveHk7CiAgfQp9CgovKioKICogQ3JlYXRlcyBhIFJlcXVlc3RFeGVjdXRvciB0byBiZSB1c2VkIHdpdGggYGNyZWF0ZVRyYW5zcG9ydGAuCiAqLwpmdW5jdGlvbiBjcmVhdGVSZXF1ZXN0RXhlY3V0b3IoCiAgb3B0aW9ucywKICBodHRwTW9kdWxlLAogIGFnZW50LAopIHsKICBjb25zdCB7IGhvc3RuYW1lLCBwYXRobmFtZSwgcG9ydCwgcHJvdG9jb2wsIHNlYXJjaCB9ID0gbmV3IFVSTChvcHRpb25zLnVybCk7CiAgcmV0dXJuIGZ1bmN0aW9uIG1ha2VSZXF1ZXN0KHJlcXVlc3QpIHsKICAgIHJldHVybiBuZXcgUHJvbWlzZSgocmVzb2x2ZSwgcmVqZWN0KSA9PiB7CiAgICAgIGxldCBib2R5ID0gc3RyZWFtRnJvbUJvZHkocmVxdWVzdC5ib2R5KTsKCiAgICAgIGNvbnN0IGhlYWRlcnMgPSB7IC4uLm9wdGlvbnMuaGVhZGVycyB9OwoKICAgICAgaWYgKHJlcXVlc3QuYm9keS5sZW5ndGggPiBHWklQX1RIUkVTSE9MRCkgewogICAgICAgIGhlYWRlcnNbJ2NvbnRlbnQtZW5jb2RpbmcnXSA9ICdnemlwJzsKICAgICAgICBib2R5ID0gYm9keS5waXBlKGNyZWF0ZUd6aXAoKSk7CiAgICAgIH0KCiAgICAgIGNvbnN0IHJlcSA9IGh0dHBNb2R1bGUucmVxdWVzdCgKICAgICAgICB7CiAgICAgICAgICBtZXRob2Q6ICdQT1NUJywKICAgICAgICAgIGFnZW50LAogICAgICAgICAgaGVhZGVycywKICAgICAgICAgIGhvc3RuYW1lLAogICAgICAgICAgcGF0aDogYCR7cGF0aG5hbWV9JHtzZWFyY2h9YCwKICAgICAgICAgIHBvcnQsCiAgICAgICAgICBwcm90b2NvbCwKICAgICAgICAgIGNhOiBvcHRpb25zLmNhQ2VydHMsCiAgICAgICAgfSwKICAgICAgICByZXMgPT4gewogICAgICAgICAgcmVzLm9uKCdkYXRhJywgKCkgPT4gewogICAgICAgICAgICAvLyBEcmFpbiBzb2NrZXQKICAgICAgICAgIH0pOwoKICAgICAgICAgIHJlcy5vbignZW5kJywgKCkgPT4gewogICAgICAgICAgICAvLyBEcmFpbiBzb2NrZXQKICAgICAgICAgIH0pOwoKICAgICAgICAgIHJlcy5zZXRFbmNvZGluZygndXRmOCcpOwoKICAgICAgICAgIC8vICJLZXktdmFsdWUgcGFpcnMgb2YgaGVhZGVyIG5hbWVzIGFuZCB2YWx1ZXMuIEhlYWRlciBuYW1lcyBhcmUgbG93ZXItY2FzZWQuIgogICAgICAgICAgLy8gaHR0cHM6Ly9ub2RlanMub3JnL2FwaS9odHRwLmh0bWwjaHR0cF9tZXNzYWdlX2hlYWRlcnMKICAgICAgICAgIGNvbnN0IHJldHJ5QWZ0ZXJIZWFkZXIgPSBfbnVsbGlzaENvYWxlc2NlKHJlcy5oZWFkZXJzWydyZXRyeS1hZnRlciddLCAoKSA9PiAoIG51bGwpKTsKICAgICAgICAgIGNvbnN0IHJhdGVMaW1pdHNIZWFkZXIgPSBfbnVsbGlzaENvYWxlc2NlKHJlcy5oZWFkZXJzWyd4LXNlbnRyeS1yYXRlLWxpbWl0cyddLCAoKSA9PiAoIG51bGwpKTsKCiAgICAgICAgICByZXNvbHZlKHsKICAgICAgICAgICAgc3RhdHVzQ29kZTogcmVzLnN0YXR1c0NvZGUsCiAgICAgICAgICAgIGhlYWRlcnM6IHsKICAgICAgICAgICAgICAncmV0cnktYWZ0ZXInOiByZXRyeUFmdGVySGVhZGVyLAogICAgICAgICAgICAgICd4LXNlbnRyeS1yYXRlLWxpbWl0cyc6IEFycmF5LmlzQXJyYXkocmF0ZUxpbWl0c0hlYWRlcikgPyByYXRlTGltaXRzSGVhZGVyWzBdIDogcmF0ZUxpbWl0c0hlYWRlciwKICAgICAgICAgICAgfSwKICAgICAgICAgIH0pOwogICAgICAgIH0sCiAgICAgICk7CgogICAgICByZXEub24oJ2Vycm9yJywgcmVqZWN0KTsKICAgICAgYm9keS5waXBlKHJlcSk7CiAgICB9KTsKICB9Owp9CgpmdW5jdGlvbiBfb3B0aW9uYWxDaGFpbihvcHMpIHsgbGV0IGxhc3RBY2Nlc3NMSFMgPSB1bmRlZmluZWQ7IGxldCB2YWx1ZSA9IG9wc1swXTsgbGV0IGkgPSAxOyB3aGlsZSAoaSA8IG9wcy5sZW5ndGgpIHsgY29uc3Qgb3AgPSBvcHNbaV07IGNvbnN0IGZuID0gb3BzW2kgKyAxXTsgaSArPSAyOyBpZiAoKG9wID09PSAnb3B0aW9uYWxBY2Nlc3MnIHx8IG9wID09PSAnb3B0aW9uYWxDYWxsJykgJiYgdmFsdWUgPT0gbnVsbCkgeyByZXR1cm4gdW5kZWZpbmVkOyB9IGlmIChvcCA9PT0gJ2FjY2VzcycgfHwgb3AgPT09ICdvcHRpb25hbEFjY2VzcycpIHsgbGFzdEFjY2Vzc0xIUyA9IHZhbHVlOyB2YWx1ZSA9IGZuKHZhbHVlKTsgfSBlbHNlIGlmIChvcCA9PT0gJ2NhbGwnIHx8IG9wID09PSAnb3B0aW9uYWxDYWxsJykgeyB2YWx1ZSA9IGZuKCguLi5hcmdzKSA9PiB2YWx1ZS5jYWxsKGxhc3RBY2Nlc3NMSFMsIC4uLmFyZ3MpKTsgbGFzdEFjY2Vzc0xIUyA9IHVuZGVmaW5lZDsgfSB9IHJldHVybiB2YWx1ZTsgfQpjb25zdCBvcHRpb25zID0gd29ya2VyRGF0YTsKbGV0IHNlc3Npb247CmxldCBoYXNTZW50QW5yRXZlbnQgPSBmYWxzZTsKCmZ1bmN0aW9uIGxvZyhtc2cpIHsKICBpZiAob3B0aW9ucy5kZWJ1ZykgewogICAgLy8gZXNsaW50LWRpc2FibGUtbmV4dC1saW5lIG5vLWNvbnNvbGUKICAgIGNvbnNvbGUubG9nKGBbQU5SIFdvcmtlcl0gJHttc2d9YCk7CiAgfQp9Cgpjb25zdCB1cmwgPSBnZXRFbnZlbG9wZUVuZHBvaW50V2l0aFVybEVuY29kZWRBdXRoKG9wdGlvbnMuZHNuKTsKY29uc3QgdHJhbnNwb3J0ID0gbWFrZU5vZGVUcmFuc3BvcnQoewogIHVybCwKICByZWNvcmREcm9wcGVkRXZlbnQ6ICgpID0+IHsKICAgIC8vCiAgfSwKfSk7Cgphc3luYyBmdW5jdGlvbiBzZW5kQWJub3JtYWxTZXNzaW9uKCkgewogIC8vIG9mIHdlIGhhdmUgYW4gZXhpc3Rpbmcgc2Vzc2lvbiBwYXNzZWQgZnJvbSB0aGUgbWFpbiB0aHJlYWQsIHNlbmQgaXQgYXMgYWJub3JtYWwKICBpZiAoc2Vzc2lvbikgewogICAgbG9nKCdTZW5kaW5nIGFibm9ybWFsIHNlc3Npb24nKTsKICAgIHVwZGF0ZVNlc3Npb24oc2Vzc2lvbiwgeyBzdGF0dXM6ICdhYm5vcm1hbCcsIGFibm9ybWFsX21lY2hhbmlzbTogJ2Fucl9mb3JlZ3JvdW5kJyB9KTsKCiAgICBjb25zdCBlbnZlbG9wZSA9IGNyZWF0ZVNlc3Npb25FbnZlbG9wZShzZXNzaW9uLCBvcHRpb25zLmRzbiwgb3B0aW9ucy5zZGtNZXRhZGF0YSk7CiAgICAvLyBMb2cgdGhlIGVudmVsb3BlIHNvIHRvIGFpZCBpbiB0ZXN0aW5nCiAgICBsb2coSlNPTi5zdHJpbmdpZnkoZW52ZWxvcGUpKTsKCiAgICBhd2FpdCB0cmFuc3BvcnQuc2VuZChlbnZlbG9wZSk7CgogICAgdHJ5IHsKICAgICAgLy8gTm90aWZ5IHRoZSBtYWluIHByb2Nlc3MgdGhhdCB0aGUgc2Vzc2lvbiBoYXMgZW5kZWQgc28gdGhlIHNlc3Npb24gY2FuIGJlIGNsZWFyZWQgZnJvbSB0aGUgc2NvcGUKICAgICAgX29wdGlvbmFsQ2hhaW4oW3BhcmVudFBvcnQsICdvcHRpb25hbEFjY2VzcycsIF8yID0+IF8yLnBvc3RNZXNzYWdlLCAnY2FsbCcsIF8zID0+IF8zKCdzZXNzaW9uLWVuZGVkJyldKTsKICAgIH0gY2F0Y2ggKF8pIHsKICAgICAgLy8gaWdub3JlCiAgICB9CiAgfQp9Cgpsb2coJ1N0YXJ0ZWQnKTsKCmZ1bmN0aW9uIHByZXBhcmVTdGFja0ZyYW1lcyhzdGFja0ZyYW1lcykgewogIGlmICghc3RhY2tGcmFtZXMpIHsKICAgIHJldHVybiB1bmRlZmluZWQ7CiAgfQoKICAvLyBTdHJpcCBTZW50cnkgZnJhbWVzIGFuZCByZXZlcnNlIHRoZSBzdGFjayBmcmFtZXMgc28gdGhleSBhcmUgaW4gdGhlIGNvcnJlY3Qgb3JkZXIKICBjb25zdCBzdHJpcHBlZEZyYW1lcyA9IHN0cmlwU2VudHJ5RnJhbWVzQW5kUmV2ZXJzZShzdGFja0ZyYW1lcyk7CgogIC8vIElmIHdlIGhhdmUgYW4gYXBwIHJvb3QgcGF0aCwgcmV3cml0ZSB0aGUgZmlsZW5hbWVzIHRvIGJlIHJlbGF0aXZlIHRvIHRoZSBhcHAgcm9vdAogIGlmIChvcHRpb25zLmFwcFJvb3RQYXRoKSB7CiAgICBmb3IgKGNvbnN0IGZyYW1lIG9mIHN0cmlwcGVkRnJhbWVzKSB7CiAgICAgIGlmICghZnJhbWUuZmlsZW5hbWUpIHsKICAgICAgICBjb250aW51ZTsKICAgICAgfQoKICAgICAgZnJhbWUuZmlsZW5hbWUgPSBub3JtYWxpemVVcmxUb0Jhc2UoZnJhbWUuZmlsZW5hbWUsIG9wdGlvbnMuYXBwUm9vdFBhdGgpOwogICAgfQogIH0KCiAgcmV0dXJuIHN0cmlwcGVkRnJhbWVzOwp9Cgphc3luYyBmdW5jdGlvbiBzZW5kQW5yRXZlbnQoZnJhbWVzLCB0cmFjZUNvbnRleHQpIHsKICBpZiAoaGFzU2VudEFuckV2ZW50KSB7CiAgICByZXR1cm47CiAgfQoKICBoYXNTZW50QW5yRXZlbnQgPSB0cnVlOwoKICBhd2FpdCBzZW5kQWJub3JtYWxTZXNzaW9uKCk7CgogIGxvZygnU2VuZGluZyBldmVudCcpOwoKICBjb25zdCBldmVudCA9IHsKICAgIGV2ZW50X2lkOiB1dWlkNCgpLAogICAgY29udGV4dHM6IHsgLi4ub3B0aW9ucy5jb250ZXh0cywgdHJhY2U6IHRyYWNlQ29udGV4dCB9LAogICAgcmVsZWFzZTogb3B0aW9ucy5yZWxlYXNlLAogICAgZW52aXJvbm1lbnQ6IG9wdGlvbnMuZW52aXJvbm1lbnQsCiAgICBkaXN0OiBvcHRpb25zLmRpc3QsCiAgICBwbGF0Zm9ybTogJ25vZGUnLAogICAgbGV2ZWw6ICdlcnJvcicsCiAgICBleGNlcHRpb246IHsKICAgICAgdmFsdWVzOiBbCiAgICAgICAgewogICAgICAgICAgdHlwZTogJ0FwcGxpY2F0aW9uTm90UmVzcG9uZGluZycsCiAgICAgICAgICB2YWx1ZTogYEFwcGxpY2F0aW9uIE5vdCBSZXNwb25kaW5nIGZvciBhdCBsZWFzdCAke29wdGlvbnMuYW5yVGhyZXNob2xkfSBtc2AsCiAgICAgICAgICBzdGFja3RyYWNlOiB7IGZyYW1lczogcHJlcGFyZVN0YWNrRnJhbWVzKGZyYW1lcykgfSwKICAgICAgICAgIC8vIFRoaXMgZW5zdXJlcyB0aGUgVUkgZG9lc24ndCBzYXkgJ0NyYXNoZWQgaW4nIGZvciB0aGUgc3RhY2sgdHJhY2UKICAgICAgICAgIG1lY2hhbmlzbTogeyB0eXBlOiAnQU5SJyB9LAogICAgICAgIH0sCiAgICAgIF0sCiAgICB9LAogICAgdGFnczogb3B0aW9ucy5zdGF0aWNUYWdzLAogIH07CgogIGNvbnN0IGVudmVsb3BlID0gY3JlYXRlRXZlbnRFbnZlbG9wZShldmVudCwgb3B0aW9ucy5kc24sIG9wdGlvbnMuc2RrTWV0YWRhdGEpOwogIC8vIExvZyB0aGUgZW52ZWxvcGUgc28gdG8gYWlkIGluIHRlc3RpbmcKICBsb2coSlNPTi5zdHJpbmdpZnkoZW52ZWxvcGUpKTsKCiAgYXdhaXQgdHJhbnNwb3J0LnNlbmQoZW52ZWxvcGUpOwogIGF3YWl0IHRyYW5zcG9ydC5mbHVzaCgyMDAwKTsKCiAgLy8gRGVsYXkgZm9yIDUgc2Vjb25kcyBzbyB0aGF0IHN0ZGlvIGNhbiBmbHVzaCBpbiB0aGUgbWFpbiBldmVudCBsb29wIGV2ZXIgcmVzdGFydHMuCiAgLy8gVGhpcyBpcyBtYWlubHkgZm9yIHRoZSBiZW5lZml0IG9mIGxvZ2dpbmcvZGVidWdnaW5nIGlzc3Vlcy4KICBzZXRUaW1lb3V0KCgpID0+IHsKICAgIHByb2Nlc3MuZXhpdCgwKTsKICB9LCA1MDAwKTsKfQoKbGV0IGRlYnVnZ2VyUGF1c2U7CgppZiAob3B0aW9ucy5jYXB0dXJlU3RhY2tUcmFjZSkgewogIGxvZygnQ29ubmVjdGluZyB0byBkZWJ1Z2dlcicpOwoKICBjb25zdCBzZXNzaW9uID0gbmV3IFNlc3Npb24oKSA7CiAgc2Vzc2lvbi5jb25uZWN0VG9NYWluVGhyZWFkKCk7CgogIGxvZygnQ29ubmVjdGVkIHRvIGRlYnVnZ2VyJyk7CgogIC8vIENvbGxlY3Qgc2NyaXB0SWQgLT4gdXJsIG1hcCBzbyB3ZSBjYW4gbG9vayB1cCB0aGUgZmlsZW5hbWVzIGxhdGVyCiAgY29uc3Qgc2NyaXB0cyA9IG5ldyBNYXAoKTsKCiAgc2Vzc2lvbi5vbignRGVidWdnZXIuc2NyaXB0UGFyc2VkJywgZXZlbnQgPT4gewogICAgc2NyaXB0cy5zZXQoZXZlbnQucGFyYW1zLnNjcmlwdElkLCBldmVudC5wYXJhbXMudXJsKTsKICB9KTsKCiAgc2Vzc2lvbi5vbignRGVidWdnZXIucGF1c2VkJywgZXZlbnQgPT4gewogICAgaWYgKGV2ZW50LnBhcmFtcy5yZWFzb24gIT09ICdvdGhlcicpIHsKICAgICAgcmV0dXJuOwogICAgfQoKICAgIHRyeSB7CiAgICAgIGxvZygnRGVidWdnZXIgcGF1c2VkJyk7CgogICAgICAvLyBjb3B5IHRoZSBmcmFtZXMKICAgICAgY29uc3QgY2FsbEZyYW1lcyA9IFsuLi5ldmVudC5wYXJhbXMuY2FsbEZyYW1lc107CgogICAgICBjb25zdCBnZXRNb2R1bGVOYW1lID0gb3B0aW9ucy5hcHBSb290UGF0aCA/IGNyZWF0ZUdldE1vZHVsZUZyb21GaWxlbmFtZShvcHRpb25zLmFwcFJvb3RQYXRoKSA6ICgpID0+IHVuZGVmaW5lZDsKICAgICAgY29uc3Qgc3RhY2tGcmFtZXMgPSBjYWxsRnJhbWVzLm1hcChmcmFtZSA9PgogICAgICAgIGNhbGxGcmFtZVRvU3RhY2tGcmFtZShmcmFtZSwgc2NyaXB0cy5nZXQoZnJhbWUubG9jYXRpb24uc2NyaXB0SWQpLCBnZXRNb2R1bGVOYW1lKSwKICAgICAgKTsKCiAgICAgIC8vIEV2YWx1YXRlIGEgc2NyaXB0IGluIHRoZSBjdXJyZW50bHkgcGF1c2VkIGNvbnRleHQKICAgICAgc2Vzc2lvbi5wb3N0KAogICAgICAgICdSdW50aW1lLmV2YWx1YXRlJywKICAgICAgICB7CiAgICAgICAgICAvLyBHcmFiIHRoZSB0cmFjZSBjb250ZXh0IGZyb20gdGhlIGN1cnJlbnQgc2NvcGUKICAgICAgICAgIGV4cHJlc3Npb246CiAgICAgICAgICAgICdjb25zdCBjdHggPSBfX1NFTlRSWV9fLmh1Yi5nZXRTY29wZSgpLmdldFByb3BhZ2F0aW9uQ29udGV4dCgpOyBjdHgudHJhY2VJZCArICItIiArIGN0eC5zcGFuSWQgKyAiLSIgKyBjdHgucGFyZW50U3BhbklkJywKICAgICAgICAgIC8vIERvbid0IHJlLXRyaWdnZXIgdGhlIGRlYnVnZ2VyIGlmIHRoaXMgY2F1c2VzIGFuIGVycm9yCiAgICAgICAgICBzaWxlbnQ6IHRydWUsCiAgICAgICAgfSwKICAgICAgICAoXywgcGFyYW0pID0+IHsKICAgICAgICAgIGNvbnN0IHRyYWNlSWQgPSBwYXJhbSAmJiBwYXJhbS5yZXN1bHQgPyAocGFyYW0ucmVzdWx0LnZhbHVlICkgOiAnLS0nOwogICAgICAgICAgY29uc3QgW3RyYWNlX2lkLCBzcGFuX2lkLCBwYXJlbnRfc3Bhbl9pZF0gPSB0cmFjZUlkLnNwbGl0KCctJykgOwoKICAgICAgICAgIHNlc3Npb24ucG9zdCgnRGVidWdnZXIucmVzdW1lJyk7CiAgICAgICAgICBzZXNzaW9uLnBvc3QoJ0RlYnVnZ2VyLmRpc2FibGUnKTsKCiAgICAgICAgICBjb25zdCBjb250ZXh0ID0gX29wdGlvbmFsQ2hhaW4oW3RyYWNlX2lkLCAnb3B0aW9uYWxBY2Nlc3MnLCBfNCA9PiBfNC5sZW5ndGhdKSAmJiBfb3B0aW9uYWxDaGFpbihbc3Bhbl9pZCwgJ29wdGlvbmFsQWNjZXNzJywgXzUgPT4gXzUubGVuZ3RoXSkgPyB7IHRyYWNlX2lkLCBzcGFuX2lkLCBwYXJlbnRfc3Bhbl9pZCB9IDogdW5kZWZpbmVkOwogICAgICAgICAgc2VuZEFuckV2ZW50KHN0YWNrRnJhbWVzLCBjb250ZXh0KS50aGVuKG51bGwsICgpID0+IHsKICAgICAgICAgICAgbG9nKCdTZW5kaW5nIEFOUiBldmVudCBmYWlsZWQuJyk7CiAgICAgICAgICB9KTsKICAgICAgICB9LAogICAgICApOwogICAgfSBjYXRjaCAoZSkgewogICAgICBzZXNzaW9uLnBvc3QoJ0RlYnVnZ2VyLnJlc3VtZScpOwogICAgICBzZXNzaW9uLnBvc3QoJ0RlYnVnZ2VyLmRpc2FibGUnKTsKICAgICAgdGhyb3cgZTsKICAgIH0KICB9KTsKCiAgZGVidWdnZXJQYXVzZSA9ICgpID0+IHsKICAgIHRyeSB7CiAgICAgIHNlc3Npb24ucG9zdCgnRGVidWdnZXIuZW5hYmxlJywgKCkgPT4gewogICAgICAgIHNlc3Npb24ucG9zdCgnRGVidWdnZXIucGF1c2UnKTsKICAgICAgfSk7CiAgICB9IGNhdGNoIChfKSB7CiAgICAgIC8vCiAgICB9CiAgfTsKfQoKZnVuY3Rpb24gY3JlYXRlSHJUaW1lcigpIHsKICAvLyBUT0RPICh2OCk6IFdlIGNhbiB1c2UgcHJvY2Vzcy5ocnRpbWUuYmlnaW50KCkgYWZ0ZXIgd2UgZHJvcCBub2RlIHY4CiAgbGV0IGxhc3RQb2xsID0gcHJvY2Vzcy5ocnRpbWUoKTsKCiAgcmV0dXJuIHsKICAgIGdldFRpbWVNczogKCkgPT4gewogICAgICBjb25zdCBbc2Vjb25kcywgbmFub1NlY29uZHNdID0gcHJvY2Vzcy5ocnRpbWUobGFzdFBvbGwpOwogICAgICByZXR1cm4gTWF0aC5mbG9vcihzZWNvbmRzICogMWUzICsgbmFub1NlY29uZHMgLyAxZTYpOwogICAgfSwKICAgIHJlc2V0OiAoKSA9PiB7CiAgICAgIGxhc3RQb2xsID0gcHJvY2Vzcy5ocnRpbWUoKTsKICAgIH0sCiAgfTsKfQoKZnVuY3Rpb24gd2F0Y2hkb2dUaW1lb3V0KCkgewogIGxvZygnV2F0Y2hkb2cgdGltZW91dCcpOwoKICBpZiAoZGVidWdnZXJQYXVzZSkgewogICAgbG9nKCdQYXVzaW5nIGRlYnVnZ2VyIHRvIGNhcHR1cmUgc3RhY2sgdHJhY2UnKTsKICAgIGRlYnVnZ2VyUGF1c2UoKTsKICB9IGVsc2UgewogICAgbG9nKCdDYXB0dXJpbmcgZXZlbnQgd2l0aG91dCBhIHN0YWNrIHRyYWNlJyk7CiAgICBzZW5kQW5yRXZlbnQoKS50aGVuKG51bGwsICgpID0+IHsKICAgICAgbG9nKCdTZW5kaW5nIEFOUiBldmVudCBmYWlsZWQgb24gd2F0Y2hkb2cgdGltZW91dC4nKTsKICAgIH0pOwogIH0KfQoKY29uc3QgeyBwb2xsIH0gPSB3YXRjaGRvZ1RpbWVyKGNyZWF0ZUhyVGltZXIsIG9wdGlvbnMucG9sbEludGVydmFsLCBvcHRpb25zLmFuclRocmVzaG9sZCwgd2F0Y2hkb2dUaW1lb3V0KTsKCl9vcHRpb25hbENoYWluKFtwYXJlbnRQb3J0LCAnb3B0aW9uYWxBY2Nlc3MnLCBfNiA9PiBfNi5vbiwgJ2NhbGwnLCBfNyA9PiBfNygnbWVzc2FnZScsIChtc2cpID0+IHsKICBpZiAobXNnLnNlc3Npb24pIHsKICAgIHNlc3Npb24gPSBtYWtlU2Vzc2lvbihtc2cuc2Vzc2lvbik7CiAgfQoKICBwb2xsKCk7Cn0pXSk7"),{workerData:b});process.on("exit",()=>{m.terminate()});let Z=setInterval(()=>{try{let e=(0,l.nZ)().getSession(),t=e?{...e,toJSON:void 0}:void 0;m.postMessage({session:t})}catch(e){}},b.pollInterval);Z.unref(),m.on("message",e=>{"session-ended"===e&&(I("ANR event sent from ANR worker. Clearing session in this thread."),(0,l.nZ)().setSession(void 0))}),m.once("error",e=>{clearInterval(Z),I("ANR worker error",e)}),m.once("exit",e=>{clearInterval(Z),I("ANR worker exit",e)}),m.unref()}},3383:(e,t,n)=>{"use strict";n.d(t,{V:()=>i});let i=(0,n(7894).J4)(process.versions.node)},9981:(e,t,n)=>{"use strict";n.d(t,{EN:()=>s,IQ:()=>a});var i=n(1165),g=n(6797),o=n(8488);let r="sentry-",l=/^sentry-/;function s(e){if(!(0,g.HD)(e)&&!Array.isArray(e))return;let t={};if(Array.isArray(e))t=e.reduce((e,t)=>{let n=c(t);for(let t of Object.keys(n))e[t]=n[t];return e},{});else{if(!e)return;t=c(e)}let n=Object.entries(t).reduce((e,[t,n])=>(t.match(l)&&(e[t.slice(r.length)]=n),e),{});return Object.keys(n).length>0?n:void 0}function a(e){if(e)return function(e){if(0!==Object.keys(e).length)return Object.entries(e).reduce((e,[t,n],g)=>{let r=`${encodeURIComponent(t)}=${encodeURIComponent(n)}`,l=0===g?r:`${e},${r}`;return l.length>8192?(i.X&&o.kg.warn(`Not adding key: ${t} with val: ${n} to baggage header due to exceeding baggage size limits.`),e):l},"")}(Object.entries(e).reduce((e,[t,n])=>(n&&(e[`${r}${t}`]=n),e),{}))}function c(e){return e.split(",").map(e=>e.split("=").map(e=>decodeURIComponent(e.trim()))).reduce((e,[t,n])=>(e[t]=n,e),{})}},6915:(e,t,n)=>{"use strict";function i(e,t){return null!=e?e:t()}n.d(t,{h:()=>i})},1907:(e,t,n)=>{"use strict";function i(e){let t;let n=e[0],i=1;for(;i<e.length;){let g=e[i],o=e[i+1];if(i+=2,("optionalAccess"===g||"optionalCall"===g)&&null==n)return;"access"===g||"optionalAccess"===g?(t=n,n=o(n)):("call"===g||"optionalCall"===g)&&(n=o((...e)=>n.call(t,...e)),t=void 0)}return n}n.d(t,{x:()=>i})},1165:(e,t,n)=>{"use strict";n.d(t,{X:()=>i});let i=!1},2649:(e,t,n)=>{"use strict";n.d(t,{D2:()=>a,Hj:()=>s,rK:()=>c});var i=n(1165),g=n(8488),o=n(1183);let r={},l={};function s(e,t){r[e]=r[e]||[],r[e].push(t)}function a(e,t){l[e]||(t(),l[e]=!0)}function c(e,t){let n=e&&r[e];if(n)for(let r of n)try{r(t)}catch(t){i.X&&g.kg.error(`Error while triggering instrumentation handler.
Type: ${e}
Name: ${(0,o.$P)(r)}
Error:`,t)}}},6797:(e,t,n)=>{"use strict";n.d(t,{Cy:()=>C,HD:()=>r,J8:()=>u,Kj:()=>d,Le:()=>l,PO:()=>a,V9:()=>p,VZ:()=>g,cO:()=>c,i2:()=>b,kK:()=>I,pt:()=>s,y1:()=>m});let i=Object.prototype.toString;function g(e){switch(i.call(e)){case"[object Error]":case"[object Exception]":case"[object DOMException]":return!0;default:return p(e,Error)}}function o(e,t){return i.call(e)===`[object ${t}]`}function r(e){return o(e,"String")}function l(e){return"object"==typeof e&&null!==e&&"__sentry_template_string__"in e&&"__sentry_template_values__"in e}function s(e){return null===e||l(e)||"object"!=typeof e&&"function"!=typeof e}function a(e){return o(e,"Object")}function c(e){return"undefined"!=typeof Event&&p(e,Event)}function I(e){return"undefined"!=typeof Element&&p(e,Element)}function d(e){return o(e,"RegExp")}function u(e){return!!(e&&e.then&&"function"==typeof e.then)}function C(e){return a(e)&&"nativeEvent"in e&&"preventDefault"in e&&"stopPropagation"in e}function b(e){return"number"==typeof e&&e!=e}function p(e,t){try{return e instanceof t}catch(e){return!1}}function m(e){return!!("object"==typeof e&&null!==e&&(e.__isVue||e._isVue))}},8488:(e,t,n)=>{"use strict";n.d(t,{Cf:()=>l,LD:()=>r,RU:()=>o,kg:()=>s});var i=n(1165),g=n(2936);let o=["debug","info","warn","error","log","assert","trace"],r={};function l(e){if(!("console"in g.GLOBAL_OBJ))return e();let t=g.GLOBAL_OBJ.console,n={},i=Object.keys(r);i.forEach(e=>{let i=r[e];n[e]=t[e],t[e]=i});try{return e()}finally{i.forEach(e=>{t[e]=n[e]})}}let s=function(){let e=!1,t={enable:()=>{e=!0},disable:()=>{e=!1},isEnabled:()=>e};return i.X?o.forEach(n=>{t[n]=(...t)=>{e&&l(()=>{g.GLOBAL_OBJ.console[n](`Sentry Logger [${n}]:`,...t)})}}):o.forEach(e=>{t[e]=()=>void 0}),t}()},7894:(e,t,n)=>{"use strict";n.d(t,{DM:()=>r,Db:()=>a,EG:()=>c,J4:()=>d,YO:()=>C,go:()=>u,jH:()=>s,lE:()=>b});var i=n(4254),g=n(9482),o=n(2936);function r(){let e=o.GLOBAL_OBJ,t=e.crypto||e.msCrypto,n=()=>16*Math.random();try{if(t&&t.randomUUID)return t.randomUUID().replace(/-/g,"");t&&t.getRandomValues&&(n=()=>{let e=new Uint8Array(1);return t.getRandomValues(e),e[0]})}catch(e){}return"10000000100040008000100000000000".replace(/[018]/g,e=>(e^(15&n())>>e/4).toString(16))}function l(e){return e.exception&&e.exception.values?e.exception.values[0]:void 0}function s(e){let{message:t,event_id:n}=e;if(t)return t;let i=l(e);return i?i.type&&i.value?`${i.type}: ${i.value}`:i.type||i.value||n||"<unknown>":n||"<unknown>"}function a(e,t,n){let i=e.exception=e.exception||{},g=i.values=i.values||[],o=g[0]=g[0]||{};o.value||(o.value=t||""),o.type||(o.type=n||"Error")}function c(e,t){let n=l(e);if(!n)return;let i=n.mechanism;if(n.mechanism={type:"generic",handled:!0,...i,...t},t&&"data"in t){let e={...i&&i.data,...t.data};n.mechanism.data=e}}let I=/^(0|[1-9]\d*)\.(0|[1-9]\d*)\.(0|[1-9]\d*)(?:-((?:0|[1-9]\d*|\d*[a-zA-Z-][0-9a-zA-Z-]*)(?:\.(?:0|[1-9]\d*|\d*[a-zA-Z-][0-9a-zA-Z-]*))*))?(?:\+([0-9a-zA-Z-]+(?:\.[0-9a-zA-Z-]+)*))?$/;function d(e){let t=e.match(I)||[],n=parseInt(t[1],10),i=parseInt(t[2],10),g=parseInt(t[3],10);return{buildmetadata:t[5],major:isNaN(n)?void 0:n,minor:isNaN(i)?void 0:i,patch:isNaN(g)?void 0:g,prerelease:t[4]}}function u(e,t,n=5){if(void 0===t.lineno)return;let i=e.length,o=Math.max(Math.min(i-1,t.lineno-1),0);t.pre_context=e.slice(Math.max(0,o-n),o).map(e=>(0,g.JM)(e,0)),t.context_line=(0,g.JM)(e[Math.min(i-1,o)],t.colno||0),t.post_context=e.slice(Math.min(o+1,i),o+1+n).map(e=>(0,g.JM)(e,0))}function C(e){if(e&&e.__sentry_captured__)return!0;try{(0,i.xp)(e,"__sentry_captured__",!0)}catch(e){}return!1}function b(e){return Array.isArray(e)?e:[e]}},6614:(e,t,n)=>{"use strict";function i(e,t){return e.require(t)}function g(t){let n;try{n=i(e,t)}catch(e){}try{let{cwd:g}=i(e,"process");n=i(e,`${g()}/node_modules/${t}`)}catch(e){}return n}n.d(t,{$y:()=>g,l$:()=>i}),e=n.hmd(e)},4908:(e,t,n)=>{"use strict";n.d(t,{Fv:()=>r,Qy:()=>function e(t,n=3,i=102400){let g=r(t,n);return~-encodeURI(JSON.stringify(g)).split(/%..|./).length>i?e(t,n-1,i):g}});var i=n(6797),g=n(4254),o=n(1183);function r(e,t=100,n=Infinity){try{return function e(t,n,r=Infinity,l=Infinity,s=function(){let e="function"==typeof WeakSet,t=e?new WeakSet:[];return[function(n){if(e)return!!t.has(n)||(t.add(n),!1);for(let e=0;e<t.length;e++)if(t[e]===n)return!0;return t.push(n),!1},function(n){if(e)t.delete(n);else for(let e=0;e<t.length;e++)if(t[e]===n){t.splice(e,1);break}}]}()){let[a,c]=s;if(null==n||["number","boolean","string"].includes(typeof n)&&!(0,i.i2)(n))return n;let I=function(e,t){try{if("domain"===e&&t&&"object"==typeof t&&t._events)return"[Domain]";if("domainEmitter"===e)return"[DomainEmitter]";if("undefined"!=typeof global&&t===global)return"[Global]";if("undefined"!=typeof window&&t===window)return"[Window]";if("undefined"!=typeof document&&t===document)return"[Document]";if((0,i.y1)(t))return"[VueViewModel]";if((0,i.Cy)(t))return"[SyntheticEvent]";if("number"==typeof t&&t!=t)return"[NaN]";if("function"==typeof t)return`[Function: ${(0,o.$P)(t)}]`;if("symbol"==typeof t)return`[${String(t)}]`;if("bigint"==typeof t)return`[BigInt: ${String(t)}]`;let n=function(e){let t=Object.getPrototypeOf(e);return t?t.constructor.name:"null prototype"}(t);if(/^HTML(\w*)Element$/.test(n))return`[HTMLElement: ${n}]`;return`[object ${n}]`}catch(e){return`**non-serializable** (${e})`}}(t,n);if(!I.startsWith("[object "))return I;if(n.__sentry_skip_normalization__)return n;let d="number"==typeof n.__sentry_override_normalization_depth__?n.__sentry_override_normalization_depth__:r;if(0===d)return I.replace("object ","");if(a(n))return"[Circular ~]";if(n&&"function"==typeof n.toJSON)try{let t=n.toJSON();return e("",t,d-1,l,s)}catch(e){}let u=Array.isArray(n)?[]:{},C=0,b=(0,g.Sh)(n);for(let t in b){if(!Object.prototype.hasOwnProperty.call(b,t))continue;if(C>=l){u[t]="[MaxProperties ~]";break}let n=b[t];u[t]=e(t,n,d-1,l,s),C++}return c(n),u}("",e,t,n)}catch(e){return{ERROR:`**non-serializable** (${e})`}}}},4254:(e,t,n)=>{"use strict";n.d(t,{xp:()=>a,Sh:()=>d,Jr:()=>p,zf:()=>b,hl:()=>s,HK:()=>c,_j:()=>I});var i=n(6797);let g=(0,n(2936).R)();var o=n(1165),r=n(8488),l=n(9482);function s(e,t,n){if(!(t in e))return;let i=e[t],g=n(i);"function"==typeof g&&function(e,t){try{let n=t.prototype||{};e.prototype=t.prototype=n,a(e,"__sentry_original__",t)}catch(e){}}(g,i),e[t]=g}function a(e,t,n){try{Object.defineProperty(e,t,{value:n,writable:!0,configurable:!0})}catch(n){o.X&&r.kg.log(`Failed to add non-enumerable property "${t}" to object`,e)}}function c(e){return e.__sentry_original__}function I(e){return Object.keys(e).map(t=>`${encodeURIComponent(t)}=${encodeURIComponent(e[t])}`).join("&")}function d(e){if((0,i.VZ)(e))return{message:e.message,name:e.name,stack:e.stack,...C(e)};if(!(0,i.cO)(e))return e;{let t={type:e.type,target:u(e.target),currentTarget:u(e.currentTarget),...C(e)};return"undefined"!=typeof CustomEvent&&(0,i.V9)(e,CustomEvent)&&(t.detail=e.detail),t}}function u(e){try{return(0,i.kK)(e)?function(e,t={}){if(!e)return"<unknown>";try{let n,o=e,r=[],l=0,s=0,a=Array.isArray(t)?t:t.keyAttrs,c=!Array.isArray(t)&&t.maxStringLength||80;for(;o&&l++<5&&(n=function(e,t){let n,o,r,l,s;let a=[];if(!e||!e.tagName)return"";if(g.HTMLElement&&e instanceof HTMLElement&&e.dataset&&e.dataset.sentryComponent)return e.dataset.sentryComponent;a.push(e.tagName.toLowerCase());let c=t&&t.length?t.filter(t=>e.getAttribute(t)).map(t=>[t,e.getAttribute(t)]):null;if(c&&c.length)c.forEach(e=>{a.push(`[${e[0]}="${e[1]}"]`)});else if(e.id&&a.push(`#${e.id}`),(n=e.className)&&(0,i.HD)(n))for(s=0,o=n.split(/\s+/);s<o.length;s++)a.push(`.${o[s]}`);let I=["aria-label","type","name","title","alt"];for(s=0;s<I.length;s++)r=I[s],(l=e.getAttribute(r))&&a.push(`[${r}="${l}"]`);return a.join("")}(o,a),"html"!==n&&(!(l>1)||!(s+3*r.length+n.length>=c)));)r.push(n),s+=n.length,o=o.parentNode;return r.reverse().join(" > ")}catch(e){return"<unknown>"}}(e):Object.prototype.toString.call(e)}catch(e){return"<unknown>"}}function C(e){if("object"!=typeof e||null===e)return{};{let t={};for(let n in e)Object.prototype.hasOwnProperty.call(e,n)&&(t[n]=e[n]);return t}}function b(e,t=40){let n=Object.keys(d(e));if(n.sort(),!n.length)return"[object has no keys]";if(n[0].length>=t)return(0,l.$G)(n[0],t);for(let e=n.length;e>0;e--){let i=n.slice(0,e).join(", ");if(!(i.length>t)){if(e===n.length)return i;return(0,l.$G)(i,t)}}return""}function p(e){return function e(t,n){if(function(e){if(!(0,i.PO)(e))return!1;try{let t=Object.getPrototypeOf(e).constructor.name;return!t||"Object"===t}catch(e){return!0}}(t)){let i=n.get(t);if(void 0!==i)return i;let g={};for(let i of(n.set(t,g),Object.keys(t)))void 0!==t[i]&&(g[i]=e(t[i],n));return g}if(Array.isArray(t)){let i=n.get(t);if(void 0!==i)return i;let g=[];return n.set(t,g),t.forEach(t=>{g.push(e(t,n))}),g}return t}(e,new Map)}},282:(e,t,n)=>{"use strict";n.d(t,{S6:()=>u,oA:()=>I,Zm:()=>C});var i=n(1165),g=n(6797),o=n(8488),r=n(4908),l=n(4228);let s={ip:!1,request:!0,transaction:!0,user:!0},a=["cookies","data","headers","method","query_string","url"],c=["id","username","email"];function I(e,t={}){let n=e.method&&e.method.toUpperCase(),i="",g="url";t.customRoute||e.route?(i=t.customRoute||`${e.baseUrl||""}${e.route&&e.route.path}`,g="route"):(e.originalUrl||e.url)&&(i=(0,l.rt)(e.originalUrl||e.url||""));let o="";return t.method&&n&&(o+=n),t.method&&t.path&&(o+=" "),t.path&&i&&(o+=i),[o,g]}function d(e,t){let{include:n=a,deps:i}=t||{},o={},l=e.headers||{},s=e.method,c=l.host||e.hostname||e.host||"<no host>",I="https"===e.protocol||e.socket&&e.socket.encrypted?"https":"http",d=e.originalUrl||e.url||"",u=d.startsWith(I)?d:`${I}://${c}${d}`;return n.forEach(t=>{switch(t){case"headers":o.headers=l,n.includes("cookies")||delete o.headers.cookie;break;case"method":o.method=s;break;case"url":o.url=u;break;case"cookies":o.cookies=e.cookies||l.cookie&&function(e){let t={},n=0;for(;n<e.length;){let i=e.indexOf("=",n);if(-1===i)break;let g=e.indexOf(";",n);if(-1===g)g=e.length;else if(g<i){n=e.lastIndexOf(";",i-1)+1;continue}let o=e.slice(n,i).trim();if(void 0===t[o]){let n=e.slice(i+1,g).trim();34===n.charCodeAt(0)&&(n=n.slice(1,-1));try{t[o]=-1!==n.indexOf("%")?decodeURIComponent(n):n}catch(e){t[o]=n}}n=g+1}return t}(l.cookie)||{};break;case"query_string":o.query_string=function(e,t){let n=e.originalUrl||e.url||"";if(n){n.startsWith("/")&&(n=`http://dogs.are.great${n}`);try{return e.query||"undefined"!=typeof URL&&new URL(n).search.slice(1)||t&&t.url&&t.url.parse(n).query||void 0}catch(e){return}}}(e,i);break;case"data":if("GET"===s||"HEAD"===s)break;void 0!==e.body&&(o.data=(0,g.HD)(e.body)?e.body:JSON.stringify((0,r.Fv)(e.body)));break;default:({}).hasOwnProperty.call(e,t)&&(o[t]=e[t])}}),o}function u(e,t,n){let i={...s,...n&&n.include};if(i.request){let g=Array.isArray(i.request)?d(t,{include:i.request,deps:n&&n.deps}):d(t,{deps:n&&n.deps});e.request={...e.request,...g}}if(i.user){let n=t.user&&(0,g.PO)(t.user)?function(e,t){let n={};return(Array.isArray(t)?t:c).forEach(t=>{e&&t in e&&(n[t]=e[t])}),n}(t.user,i.user):{};Object.keys(n).length&&(e.user={...e.user,...n})}if(i.ip){let n=t.ip||t.socket&&t.socket.remoteAddress;n&&(e.user={...e.user,ip_address:n})}return i.transaction&&!e.transaction&&(e.transaction=function(e,t){switch(t){case"path":return I(e,{path:!0})[0];case"handler":return e.route&&e.route.stack&&e.route.stack[0]&&e.route.stack[0].name||"<anonymous>";default:{let t=e._reconstructedRoute?e._reconstructedRoute:void 0;return I(e,{path:!0,method:!0,customRoute:t})[0]}}}(t,i.transaction)),e}function C(e){let t={};try{e.forEach((e,n)=>{"string"==typeof e&&(t[n]=e)})}catch(e){i.X&&o.kg.warn("Sentry failed extracting headers from a request object. If you see this, please file an issue.")}return t}},1183:(e,t,n)=>{"use strict";n.d(t,{pE:()=>o,$P:()=>s,Ep:()=>a,Sq:()=>r});let i=/\(error: (.*)\)/,g=/captureMessage|captureException/;function o(...e){let t=e.sort((e,t)=>e[0]-t[0]).map(e=>e[1]);return(e,n=0)=>{let o=[],r=e.split("\n");for(let e=n;e<r.length;e++){let n=r[e];if(n.length>1024)continue;let g=i.test(n)?n.replace(i,"$1"):n;if(!g.match(/\S*Error: /)){for(let e of t){let t=e(g);if(t){o.push(t);break}}if(o.length>=50)break}}return function(e){if(!e.length)return[];let t=Array.from(e);return/sentryWrapped/.test(t[t.length-1].function||"")&&t.pop(),t.reverse(),g.test(t[t.length-1].function||"")&&(t.pop(),g.test(t[t.length-1].function||"")&&t.pop()),t.slice(0,50).map(e=>({...e,filename:e.filename||t[t.length-1].filename,function:e.function||"?"}))}(o)}}function r(e){return Array.isArray(e)?o(...e):e}let l="<anonymous>";function s(e){try{if(!e||"function"!=typeof e)return l;return e.name||l}catch(e){return l}}function a(e){return[90,function(e){let t=/^\s*[-]{4,}$/,n=/at (?:async )?(?:(.+?)\s+\()?(?:(.+):(\d+):(\d+)?|([^)]+))\)?/;return i=>{let g=i.match(n);if(g){let t,n,i,o,r;if(g[1]){let e=(i=g[1]).lastIndexOf(".");if("."===i[e-1]&&e--,e>0){t=i.slice(0,e),n=i.slice(e+1);let g=t.indexOf(".Module");g>0&&(i=i.slice(g+1),t=t.slice(0,g))}o=void 0}n&&(o=t,r=n),"<anonymous>"===n&&(r=void 0,i=void 0),void 0===i&&(r=r||"<anonymous>",i=o?`${o}.${r}`:r);let l=g[2]&&g[2].startsWith("file://")?g[2].slice(7):g[2],s="native"===g[5];return l&&l.match(/\/[A-Z]:/)&&(l=l.slice(1)),l||!g[5]||s||(l=g[5]),{filename:l,module:e?e(l):void 0,function:i,lineno:parseInt(g[3],10)||void 0,colno:parseInt(g[4],10)||void 0,in_app:function(e,t=!1){return!(t||e&&!e.startsWith("/")&&!e.match(/^[A-Z]:/)&&!e.startsWith(".")&&!e.match(/^[a-zA-Z]([a-zA-Z0-9.\-+])*:\/\//))&&void 0!==e&&!e.includes("node_modules/")}(l,s)}}if(i.match(t))return{filename:i}}}(e)]}},9482:(e,t,n)=>{"use strict";n.d(t,{$G:()=>g,JM:()=>o,U0:()=>r});var i=n(6797);function g(e,t=0){return"string"!=typeof e||0===t?e:e.length<=t?e:`${e.slice(0,t)}...`}function o(e,t){let n=e,i=n.length;if(i<=150)return n;t>i&&(t=i);let g=Math.max(t-60,0);g<5&&(g=0);let o=Math.min(g+140,i);return o>i-5&&(o=i),o===i&&(g=Math.max(o-140,0)),n=n.slice(g,o),g>0&&(n=`'{snip} ${n}`),o<i&&(n+=" {snip}"),n}function r(e,t=[],n=!1){return t.some(t=>(function(e,t,n=!1){return!!(0,i.HD)(e)&&((0,i.Kj)(t)?t.test(e):!!(0,i.HD)(t)&&(n?e===t:e.includes(t)))})(e,t,n))}},6199:(e,t,n)=>{"use strict";n.d(t,{$2:()=>r,WD:()=>o,cW:()=>l});var i,g=n(6797);function o(e){return new l(t=>{t(e)})}function r(e){return new l((t,n)=>{n(e)})}!function(e){e[e.PENDING=0]="PENDING",e[e.RESOLVED=1]="RESOLVED",e[e.REJECTED=2]="REJECTED"}(i||(i={}));class l{constructor(e){l.prototype.__init.call(this),l.prototype.__init2.call(this),l.prototype.__init3.call(this),l.prototype.__init4.call(this),this._state=i.PENDING,this._handlers=[];try{e(this._resolve,this._reject)}catch(e){this._reject(e)}}then(e,t){return new l((n,i)=>{this._handlers.push([!1,t=>{if(e)try{n(e(t))}catch(e){i(e)}else n(t)},e=>{if(t)try{n(t(e))}catch(e){i(e)}else i(e)}]),this._executeHandlers()})}catch(e){return this.then(e=>e,e)}finally(e){return new l((t,n)=>{let i,g;return this.then(t=>{g=!1,i=t,e&&e()},t=>{g=!0,i=t,e&&e()}).then(()=>{if(g){n(i);return}t(i)})})}__init(){this._resolve=e=>{this._setResult(i.RESOLVED,e)}}__init2(){this._reject=e=>{this._setResult(i.REJECTED,e)}}__init3(){this._setResult=(e,t)=>{if(this._state===i.PENDING){if((0,g.J8)(t)){t.then(this._resolve,this._reject);return}this._state=e,this._value=t,this._executeHandlers()}}}__init4(){this._executeHandlers=()=>{if(this._state===i.PENDING)return;let e=this._handlers.slice();this._handlers=[],e.forEach(e=>{e[0]||(this._state===i.RESOLVED&&e[1](this._value),this._state===i.REJECTED&&e[2](this._value),e[0]=!0)})}}}},9463:(e,t,n)=>{"use strict";n.d(t,{ph:()=>o,yW:()=>g});var i=n(2936);function g(){return Date.now()/1e3}let o=function(){let{performance:e}=i.GLOBAL_OBJ;if(!e||!e.now)return g;let t=Date.now()-e.now(),n=void 0==e.timeOrigin?t:e.timeOrigin;return()=>(n+e.now())/1e3}();(()=>{let{performance:e}=i.GLOBAL_OBJ;if(!e||!e.now)return;let t=e.now(),n=Date.now(),g=e.timeOrigin?Math.abs(e.timeOrigin+t-n):36e5,o=e.timing&&e.timing.navigationStart,r="number"==typeof o?Math.abs(o+t-n):36e5;if(g<36e5||r<36e5)return g<=r?e.timeOrigin:void 0})()},7210:(e,t,n)=>{"use strict";n.d(t,{$p:()=>a,KA:()=>l,pT:()=>s});var i=n(9981),g=n(7894);let o=RegExp("^[ \\t]*([0-9a-f]{32})?-?([0-9a-f]{16})?-?([01])?[ \\t]*$");function r(e){let t;if(!e)return;let n=e.match(o);if(n)return"1"===n[3]?t=!0:"0"===n[3]&&(t=!1),{traceId:n[1],parentSampled:t,parentSpanId:n[2]}}function l(e,t){let n=r(e),o=(0,i.EN)(t),{traceId:l,parentSpanId:s,parentSampled:a}=n||{};return n?{traceparentData:n,dynamicSamplingContext:o||{},propagationContext:{traceId:l||(0,g.DM)(),parentSpanId:s||(0,g.DM)().substring(16),spanId:(0,g.DM)().substring(16),sampled:a,dsc:o||{}}}:{traceparentData:n,dynamicSamplingContext:void 0,propagationContext:{traceId:l||(0,g.DM)(),spanId:(0,g.DM)().substring(16)}}}function s(e,t){let n=r(e),o=(0,i.EN)(t),{traceId:l,parentSpanId:s,parentSampled:a}=n||{};return n?{traceId:l||(0,g.DM)(),parentSpanId:s||(0,g.DM)().substring(16),spanId:(0,g.DM)().substring(16),sampled:a,dsc:o||{}}:{traceId:l||(0,g.DM)(),spanId:(0,g.DM)().substring(16)}}function a(e=(0,g.DM)(),t=(0,g.DM)().substring(16),n){let i="";return void 0!==n&&(i=n?"-1":"-0"),`${e}-${t}${i}`}},4228:(e,t,n)=>{"use strict";function i(e){if(!e)return{};let t=e.match(/^(([^:/?#]+):)?(\/\/([^/?#]*))?([^?#]*)(\?([^#]*))?(#(.*))?$/);if(!t)return{};let n=t[6]||"",i=t[8]||"";return{host:t[4],path:t[5],protocol:t[2],search:n,hash:i,relative:t[5]+n+i}}function g(e){return e.split(/[\?#]/,1)[0]}function o(e){return e.split(/\\?\//).filter(e=>e.length>0&&","!==e).length}function r(e){let{protocol:t,host:n,path:i}=e,g=n&&n.replace(/^.*@/,"[filtered]:[filtered]@").replace(/(:80)$/,"").replace(/(:443)$/,"")||"";return`${t?`${t}://`:""}${g}${i}`}n.d(t,{$A:()=>o,en:()=>i,rt:()=>g,tF:()=>r})},2936:(e,t,n)=>{"use strict";function i(e){return e&&e.Math==Math?e:void 0}n.d(t,{GLOBAL_OBJ:()=>g,R:()=>o,Y:()=>r});let g="object"==typeof globalThis&&i(globalThis)||"object"==typeof window&&i(window)||"object"==typeof self&&i(self)||"object"==typeof global&&i(global)||function(){return this}()||{};function o(){return g}function r(e,t,n){let i=n||g,o=i.__SENTRY__=i.__SENTRY__||{};return o[e]||(o[e]=t())}},9380:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var n in t)Object.defineProperty(e,n,{enumerable:!0,get:t[n]})}(t,{prefixes:function(){return g},bootstrap:function(){return l},wait:function(){return s},error:function(){return a},warn:function(){return c},ready:function(){return I},info:function(){return d},event:function(){return u},trace:function(){return C},warnOnce:function(){return p}});let i=n(3392),g={wait:(0,i.white)((0,i.bold)("")),error:(0,i.red)((0,i.bold)("")),warn:(0,i.yellow)((0,i.bold)("")),ready:"",info:(0,i.white)((0,i.bold)(" ")),event:(0,i.green)((0,i.bold)("")),trace:(0,i.magenta)((0,i.bold)("\xbb"))},o={log:"log",warn:"warn",error:"error"};function r(e,...t){(""===t[0]||void 0===t[0])&&1===t.length&&t.shift();let n=e in o?o[e]:"log",i=g[e];0===t.length?console[n](""):console[n](" "+i,...t)}function l(...e){console.log(" ",...e)}function s(...e){r("wait",...e)}function a(...e){r("error",...e)}function c(...e){r("warn",...e)}function I(...e){r("ready",...e)}function d(...e){r("info",...e)}function u(...e){r("event",...e)}function C(...e){r("trace",...e)}let b=new Set;function p(...e){b.has(e[0])||(b.add(e.join(" ")),c(...e))}},6581:e=>{(()=>{"use strict";var t={491:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ContextAPI=void 0;let i=n(223),g=n(172),o=n(930),r="context",l=new i.NoopContextManager;class s{constructor(){}static getInstance(){return this._instance||(this._instance=new s),this._instance}setGlobalContextManager(e){return(0,g.registerGlobal)(r,e,o.DiagAPI.instance())}active(){return this._getContextManager().active()}with(e,t,n,...i){return this._getContextManager().with(e,t,n,...i)}bind(e,t){return this._getContextManager().bind(e,t)}_getContextManager(){return(0,g.getGlobal)(r)||l}disable(){this._getContextManager().disable(),(0,g.unregisterGlobal)(r,o.DiagAPI.instance())}}t.ContextAPI=s},930:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DiagAPI=void 0;let i=n(56),g=n(912),o=n(957),r=n(172);class l{constructor(){function e(e){return function(...t){let n=(0,r.getGlobal)("diag");if(n)return n[e](...t)}}let t=this;t.setLogger=(e,n={logLevel:o.DiagLogLevel.INFO})=>{var i,l,s;if(e===t){let e=Error("Cannot use diag as the logger for itself. Please use a DiagLogger implementation like ConsoleDiagLogger or a custom implementation");return t.error(null!==(i=e.stack)&&void 0!==i?i:e.message),!1}"number"==typeof n&&(n={logLevel:n});let a=(0,r.getGlobal)("diag"),c=(0,g.createLogLevelDiagLogger)(null!==(l=n.logLevel)&&void 0!==l?l:o.DiagLogLevel.INFO,e);if(a&&!n.suppressOverrideMessage){let e=null!==(s=Error().stack)&&void 0!==s?s:"<failed to generate stacktrace>";a.warn(`Current logger will be overwritten from ${e}`),c.warn(`Current logger will overwrite one already registered from ${e}`)}return(0,r.registerGlobal)("diag",c,t,!0)},t.disable=()=>{(0,r.unregisterGlobal)("diag",t)},t.createComponentLogger=e=>new i.DiagComponentLogger(e),t.verbose=e("verbose"),t.debug=e("debug"),t.info=e("info"),t.warn=e("warn"),t.error=e("error")}static instance(){return this._instance||(this._instance=new l),this._instance}}t.DiagAPI=l},653:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.MetricsAPI=void 0;let i=n(660),g=n(172),o=n(930),r="metrics";class l{constructor(){}static getInstance(){return this._instance||(this._instance=new l),this._instance}setGlobalMeterProvider(e){return(0,g.registerGlobal)(r,e,o.DiagAPI.instance())}getMeterProvider(){return(0,g.getGlobal)(r)||i.NOOP_METER_PROVIDER}getMeter(e,t,n){return this.getMeterProvider().getMeter(e,t,n)}disable(){(0,g.unregisterGlobal)(r,o.DiagAPI.instance())}}t.MetricsAPI=l},181:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.PropagationAPI=void 0;let i=n(172),g=n(874),o=n(194),r=n(277),l=n(369),s=n(930),a="propagation",c=new g.NoopTextMapPropagator;class I{constructor(){this.createBaggage=l.createBaggage,this.getBaggage=r.getBaggage,this.getActiveBaggage=r.getActiveBaggage,this.setBaggage=r.setBaggage,this.deleteBaggage=r.deleteBaggage}static getInstance(){return this._instance||(this._instance=new I),this._instance}setGlobalPropagator(e){return(0,i.registerGlobal)(a,e,s.DiagAPI.instance())}inject(e,t,n=o.defaultTextMapSetter){return this._getGlobalPropagator().inject(e,t,n)}extract(e,t,n=o.defaultTextMapGetter){return this._getGlobalPropagator().extract(e,t,n)}fields(){return this._getGlobalPropagator().fields()}disable(){(0,i.unregisterGlobal)(a,s.DiagAPI.instance())}_getGlobalPropagator(){return(0,i.getGlobal)(a)||c}}t.PropagationAPI=I},997:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TraceAPI=void 0;let i=n(172),g=n(846),o=n(139),r=n(607),l=n(930),s="trace";class a{constructor(){this._proxyTracerProvider=new g.ProxyTracerProvider,this.wrapSpanContext=o.wrapSpanContext,this.isSpanContextValid=o.isSpanContextValid,this.deleteSpan=r.deleteSpan,this.getSpan=r.getSpan,this.getActiveSpan=r.getActiveSpan,this.getSpanContext=r.getSpanContext,this.setSpan=r.setSpan,this.setSpanContext=r.setSpanContext}static getInstance(){return this._instance||(this._instance=new a),this._instance}setGlobalTracerProvider(e){let t=(0,i.registerGlobal)(s,this._proxyTracerProvider,l.DiagAPI.instance());return t&&this._proxyTracerProvider.setDelegate(e),t}getTracerProvider(){return(0,i.getGlobal)(s)||this._proxyTracerProvider}getTracer(e,t){return this.getTracerProvider().getTracer(e,t)}disable(){(0,i.unregisterGlobal)(s,l.DiagAPI.instance()),this._proxyTracerProvider=new g.ProxyTracerProvider}}t.TraceAPI=a},277:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.deleteBaggage=t.setBaggage=t.getActiveBaggage=t.getBaggage=void 0;let i=n(491),g=(0,n(780).createContextKey)("OpenTelemetry Baggage Key");function o(e){return e.getValue(g)||void 0}t.getBaggage=o,t.getActiveBaggage=function(){return o(i.ContextAPI.getInstance().active())},t.setBaggage=function(e,t){return e.setValue(g,t)},t.deleteBaggage=function(e){return e.deleteValue(g)}},993:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.BaggageImpl=void 0;class n{constructor(e){this._entries=e?new Map(e):new Map}getEntry(e){let t=this._entries.get(e);if(t)return Object.assign({},t)}getAllEntries(){return Array.from(this._entries.entries()).map(([e,t])=>[e,t])}setEntry(e,t){let i=new n(this._entries);return i._entries.set(e,t),i}removeEntry(e){let t=new n(this._entries);return t._entries.delete(e),t}removeEntries(...e){let t=new n(this._entries);for(let n of e)t._entries.delete(n);return t}clear(){return new n}}t.BaggageImpl=n},830:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.baggageEntryMetadataSymbol=void 0,t.baggageEntryMetadataSymbol=Symbol("BaggageEntryMetadata")},369:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.baggageEntryMetadataFromString=t.createBaggage=void 0;let i=n(930),g=n(993),o=n(830),r=i.DiagAPI.instance();t.createBaggage=function(e={}){return new g.BaggageImpl(new Map(Object.entries(e)))},t.baggageEntryMetadataFromString=function(e){return"string"!=typeof e&&(r.error(`Cannot create baggage metadata from unknown type: ${typeof e}`),e=""),{__TYPE__:o.baggageEntryMetadataSymbol,toString:()=>e}}},67:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.context=void 0;let i=n(491);t.context=i.ContextAPI.getInstance()},223:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.NoopContextManager=void 0;let i=n(780);class g{active(){return i.ROOT_CONTEXT}with(e,t,n,...i){return t.call(n,...i)}bind(e,t){return t}enable(){return this}disable(){return this}}t.NoopContextManager=g},780:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ROOT_CONTEXT=t.createContextKey=void 0,t.createContextKey=function(e){return Symbol.for(e)};class n{constructor(e){let t=this;t._currentContext=e?new Map(e):new Map,t.getValue=e=>t._currentContext.get(e),t.setValue=(e,i)=>{let g=new n(t._currentContext);return g._currentContext.set(e,i),g},t.deleteValue=e=>{let i=new n(t._currentContext);return i._currentContext.delete(e),i}}}t.ROOT_CONTEXT=new n},506:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.diag=void 0;let i=n(930);t.diag=i.DiagAPI.instance()},56:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DiagComponentLogger=void 0;let i=n(172);class g{constructor(e){this._namespace=e.namespace||"DiagComponentLogger"}debug(...e){return o("debug",this._namespace,e)}error(...e){return o("error",this._namespace,e)}info(...e){return o("info",this._namespace,e)}warn(...e){return o("warn",this._namespace,e)}verbose(...e){return o("verbose",this._namespace,e)}}function o(e,t,n){let g=(0,i.getGlobal)("diag");if(g)return n.unshift(t),g[e](...n)}t.DiagComponentLogger=g},972:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DiagConsoleLogger=void 0;let n=[{n:"error",c:"error"},{n:"warn",c:"warn"},{n:"info",c:"info"},{n:"debug",c:"debug"},{n:"verbose",c:"trace"}];class i{constructor(){for(let e=0;e<n.length;e++)this[n[e].n]=function(e){return function(...t){if(console){let n=console[e];if("function"!=typeof n&&(n=console.log),"function"==typeof n)return n.apply(console,t)}}}(n[e].c)}}t.DiagConsoleLogger=i},912:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createLogLevelDiagLogger=void 0;let i=n(957);t.createLogLevelDiagLogger=function(e,t){function n(n,i){let g=t[n];return"function"==typeof g&&e>=i?g.bind(t):function(){}}return e<i.DiagLogLevel.NONE?e=i.DiagLogLevel.NONE:e>i.DiagLogLevel.ALL&&(e=i.DiagLogLevel.ALL),t=t||{},{error:n("error",i.DiagLogLevel.ERROR),warn:n("warn",i.DiagLogLevel.WARN),info:n("info",i.DiagLogLevel.INFO),debug:n("debug",i.DiagLogLevel.DEBUG),verbose:n("verbose",i.DiagLogLevel.VERBOSE)}}},957:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.DiagLogLevel=void 0,function(e){e[e.NONE=0]="NONE",e[e.ERROR=30]="ERROR",e[e.WARN=50]="WARN",e[e.INFO=60]="INFO",e[e.DEBUG=70]="DEBUG",e[e.VERBOSE=80]="VERBOSE",e[e.ALL=9999]="ALL"}(t.DiagLogLevel||(t.DiagLogLevel={}))},172:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.unregisterGlobal=t.getGlobal=t.registerGlobal=void 0;let i=n(200),g=n(521),o=n(130),r=g.VERSION.split(".")[0],l=Symbol.for(`opentelemetry.js.api.${r}`),s=i._globalThis;t.registerGlobal=function(e,t,n,i=!1){var o;let r=s[l]=null!==(o=s[l])&&void 0!==o?o:{version:g.VERSION};if(!i&&r[e]){let t=Error(`@opentelemetry/api: Attempted duplicate registration of API: ${e}`);return n.error(t.stack||t.message),!1}if(r.version!==g.VERSION){let t=Error(`@opentelemetry/api: Registration of version v${r.version} for ${e} does not match previously registered API v${g.VERSION}`);return n.error(t.stack||t.message),!1}return r[e]=t,n.debug(`@opentelemetry/api: Registered a global for ${e} v${g.VERSION}.`),!0},t.getGlobal=function(e){var t,n;let i=null===(t=s[l])||void 0===t?void 0:t.version;if(i&&(0,o.isCompatible)(i))return null===(n=s[l])||void 0===n?void 0:n[e]},t.unregisterGlobal=function(e,t){t.debug(`@opentelemetry/api: Unregistering a global for ${e} v${g.VERSION}.`);let n=s[l];n&&delete n[e]}},130:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.isCompatible=t._makeCompatibilityCheck=void 0;let i=n(521),g=/^(\d+)\.(\d+)\.(\d+)(-(.+))?$/;function o(e){let t=new Set([e]),n=new Set,i=e.match(g);if(!i)return()=>!1;let o={major:+i[1],minor:+i[2],patch:+i[3],prerelease:i[4]};if(null!=o.prerelease)return function(t){return t===e};function r(e){return n.add(e),!1}return function(e){if(t.has(e))return!0;if(n.has(e))return!1;let i=e.match(g);if(!i)return r(e);let l={major:+i[1],minor:+i[2],patch:+i[3],prerelease:i[4]};return null!=l.prerelease||o.major!==l.major?r(e):0===o.major?o.minor===l.minor&&o.patch<=l.patch?(t.add(e),!0):r(e):o.minor<=l.minor?(t.add(e),!0):r(e)}}t._makeCompatibilityCheck=o,t.isCompatible=o(i.VERSION)},886:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.metrics=void 0;let i=n(653);t.metrics=i.MetricsAPI.getInstance()},901:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ValueType=void 0,function(e){e[e.INT=0]="INT",e[e.DOUBLE=1]="DOUBLE"}(t.ValueType||(t.ValueType={}))},102:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createNoopMeter=t.NOOP_OBSERVABLE_UP_DOWN_COUNTER_METRIC=t.NOOP_OBSERVABLE_GAUGE_METRIC=t.NOOP_OBSERVABLE_COUNTER_METRIC=t.NOOP_UP_DOWN_COUNTER_METRIC=t.NOOP_HISTOGRAM_METRIC=t.NOOP_COUNTER_METRIC=t.NOOP_METER=t.NoopObservableUpDownCounterMetric=t.NoopObservableGaugeMetric=t.NoopObservableCounterMetric=t.NoopObservableMetric=t.NoopHistogramMetric=t.NoopUpDownCounterMetric=t.NoopCounterMetric=t.NoopMetric=t.NoopMeter=void 0;class n{constructor(){}createHistogram(e,n){return t.NOOP_HISTOGRAM_METRIC}createCounter(e,n){return t.NOOP_COUNTER_METRIC}createUpDownCounter(e,n){return t.NOOP_UP_DOWN_COUNTER_METRIC}createObservableGauge(e,n){return t.NOOP_OBSERVABLE_GAUGE_METRIC}createObservableCounter(e,n){return t.NOOP_OBSERVABLE_COUNTER_METRIC}createObservableUpDownCounter(e,n){return t.NOOP_OBSERVABLE_UP_DOWN_COUNTER_METRIC}addBatchObservableCallback(e,t){}removeBatchObservableCallback(e){}}t.NoopMeter=n;class i{}t.NoopMetric=i;class g extends i{add(e,t){}}t.NoopCounterMetric=g;class o extends i{add(e,t){}}t.NoopUpDownCounterMetric=o;class r extends i{record(e,t){}}t.NoopHistogramMetric=r;class l{addCallback(e){}removeCallback(e){}}t.NoopObservableMetric=l;class s extends l{}t.NoopObservableCounterMetric=s;class a extends l{}t.NoopObservableGaugeMetric=a;class c extends l{}t.NoopObservableUpDownCounterMetric=c,t.NOOP_METER=new n,t.NOOP_COUNTER_METRIC=new g,t.NOOP_HISTOGRAM_METRIC=new r,t.NOOP_UP_DOWN_COUNTER_METRIC=new o,t.NOOP_OBSERVABLE_COUNTER_METRIC=new s,t.NOOP_OBSERVABLE_GAUGE_METRIC=new a,t.NOOP_OBSERVABLE_UP_DOWN_COUNTER_METRIC=new c,t.createNoopMeter=function(){return t.NOOP_METER}},660:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.NOOP_METER_PROVIDER=t.NoopMeterProvider=void 0;let i=n(102);class g{getMeter(e,t,n){return i.NOOP_METER}}t.NoopMeterProvider=g,t.NOOP_METER_PROVIDER=new g},200:function(e,t,n){var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),g=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||i(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),g(n(46),t)},651:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t._globalThis=void 0,t._globalThis="object"==typeof globalThis?globalThis:global},46:function(e,t,n){var i=this&&this.__createBinding||(Object.create?function(e,t,n,i){void 0===i&&(i=n),Object.defineProperty(e,i,{enumerable:!0,get:function(){return t[n]}})}:function(e,t,n,i){void 0===i&&(i=n),e[i]=t[n]}),g=this&&this.__exportStar||function(e,t){for(var n in e)"default"===n||Object.prototype.hasOwnProperty.call(t,n)||i(t,e,n)};Object.defineProperty(t,"__esModule",{value:!0}),g(n(651),t)},939:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.propagation=void 0;let i=n(181);t.propagation=i.PropagationAPI.getInstance()},874:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.NoopTextMapPropagator=void 0;class n{inject(e,t){}extract(e,t){return e}fields(){return[]}}t.NoopTextMapPropagator=n},194:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.defaultTextMapSetter=t.defaultTextMapGetter=void 0,t.defaultTextMapGetter={get(e,t){if(null!=e)return e[t]},keys:e=>null==e?[]:Object.keys(e)},t.defaultTextMapSetter={set(e,t,n){null!=e&&(e[t]=n)}}},845:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.trace=void 0;let i=n(997);t.trace=i.TraceAPI.getInstance()},403:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.NonRecordingSpan=void 0;let i=n(476);class g{constructor(e=i.INVALID_SPAN_CONTEXT){this._spanContext=e}spanContext(){return this._spanContext}setAttribute(e,t){return this}setAttributes(e){return this}addEvent(e,t){return this}setStatus(e){return this}updateName(e){return this}end(e){}isRecording(){return!1}recordException(e,t){}}t.NonRecordingSpan=g},614:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.NoopTracer=void 0;let i=n(491),g=n(607),o=n(403),r=n(139),l=i.ContextAPI.getInstance();class s{startSpan(e,t,n=l.active()){if(null==t?void 0:t.root)return new o.NonRecordingSpan;let i=n&&(0,g.getSpanContext)(n);return"object"==typeof i&&"string"==typeof i.spanId&&"string"==typeof i.traceId&&"number"==typeof i.traceFlags&&(0,r.isSpanContextValid)(i)?new o.NonRecordingSpan(i):new o.NonRecordingSpan}startActiveSpan(e,t,n,i){let o,r,s;if(arguments.length<2)return;2==arguments.length?s=t:3==arguments.length?(o=t,s=n):(o=t,r=n,s=i);let a=null!=r?r:l.active(),c=this.startSpan(e,o,a),I=(0,g.setSpan)(a,c);return l.with(I,s,void 0,c)}}t.NoopTracer=s},124:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.NoopTracerProvider=void 0;let i=n(614);class g{getTracer(e,t,n){return new i.NoopTracer}}t.NoopTracerProvider=g},125:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ProxyTracer=void 0;let i=new(n(614)).NoopTracer;class g{constructor(e,t,n,i){this._provider=e,this.name=t,this.version=n,this.options=i}startSpan(e,t,n){return this._getTracer().startSpan(e,t,n)}startActiveSpan(e,t,n,i){let g=this._getTracer();return Reflect.apply(g.startActiveSpan,g,arguments)}_getTracer(){if(this._delegate)return this._delegate;let e=this._provider.getDelegateTracer(this.name,this.version,this.options);return e?(this._delegate=e,this._delegate):i}}t.ProxyTracer=g},846:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.ProxyTracerProvider=void 0;let i=n(125),g=new(n(124)).NoopTracerProvider;class o{getTracer(e,t,n){var g;return null!==(g=this.getDelegateTracer(e,t,n))&&void 0!==g?g:new i.ProxyTracer(this,e,t,n)}getDelegate(){var e;return null!==(e=this._delegate)&&void 0!==e?e:g}setDelegate(e){this._delegate=e}getDelegateTracer(e,t,n){var i;return null===(i=this._delegate)||void 0===i?void 0:i.getTracer(e,t,n)}}t.ProxyTracerProvider=o},996:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SamplingDecision=void 0,function(e){e[e.NOT_RECORD=0]="NOT_RECORD",e[e.RECORD=1]="RECORD",e[e.RECORD_AND_SAMPLED=2]="RECORD_AND_SAMPLED"}(t.SamplingDecision||(t.SamplingDecision={}))},607:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.getSpanContext=t.setSpanContext=t.deleteSpan=t.setSpan=t.getActiveSpan=t.getSpan=void 0;let i=n(780),g=n(403),o=n(491),r=(0,i.createContextKey)("OpenTelemetry Context Key SPAN");function l(e){return e.getValue(r)||void 0}function s(e,t){return e.setValue(r,t)}t.getSpan=l,t.getActiveSpan=function(){return l(o.ContextAPI.getInstance().active())},t.setSpan=s,t.deleteSpan=function(e){return e.deleteValue(r)},t.setSpanContext=function(e,t){return s(e,new g.NonRecordingSpan(t))},t.getSpanContext=function(e){var t;return null===(t=l(e))||void 0===t?void 0:t.spanContext()}},325:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TraceStateImpl=void 0;let i=n(564);class g{constructor(e){this._internalState=new Map,e&&this._parse(e)}set(e,t){let n=this._clone();return n._internalState.has(e)&&n._internalState.delete(e),n._internalState.set(e,t),n}unset(e){let t=this._clone();return t._internalState.delete(e),t}get(e){return this._internalState.get(e)}serialize(){return this._keys().reduce((e,t)=>(e.push(t+"="+this.get(t)),e),[]).join(",")}_parse(e){!(e.length>512)&&(this._internalState=e.split(",").reverse().reduce((e,t)=>{let n=t.trim(),g=n.indexOf("=");if(-1!==g){let o=n.slice(0,g),r=n.slice(g+1,t.length);(0,i.validateKey)(o)&&(0,i.validateValue)(r)&&e.set(o,r)}return e},new Map),this._internalState.size>32&&(this._internalState=new Map(Array.from(this._internalState.entries()).reverse().slice(0,32))))}_keys(){return Array.from(this._internalState.keys()).reverse()}_clone(){let e=new g;return e._internalState=new Map(this._internalState),e}}t.TraceStateImpl=g},564:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.validateValue=t.validateKey=void 0;let n="[_0-9a-z-*/]",i=`[a-z]${n}{0,255}`,g=`[a-z0-9]${n}{0,240}@[a-z]${n}{0,13}`,o=RegExp(`^(?:${i}|${g})$`),r=/^[ -~]{0,255}[!-~]$/,l=/,|=/;t.validateKey=function(e){return o.test(e)},t.validateValue=function(e){return r.test(e)&&!l.test(e)}},98:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.createTraceState=void 0;let i=n(325);t.createTraceState=function(e){return new i.TraceStateImpl(e)}},476:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.INVALID_SPAN_CONTEXT=t.INVALID_TRACEID=t.INVALID_SPANID=void 0;let i=n(475);t.INVALID_SPANID="0000000000000000",t.INVALID_TRACEID="00000000000000000000000000000000",t.INVALID_SPAN_CONTEXT={traceId:t.INVALID_TRACEID,spanId:t.INVALID_SPANID,traceFlags:i.TraceFlags.NONE}},357:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SpanKind=void 0,function(e){e[e.INTERNAL=0]="INTERNAL",e[e.SERVER=1]="SERVER",e[e.CLIENT=2]="CLIENT",e[e.PRODUCER=3]="PRODUCER",e[e.CONSUMER=4]="CONSUMER"}(t.SpanKind||(t.SpanKind={}))},139:(e,t,n)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.wrapSpanContext=t.isSpanContextValid=t.isValidSpanId=t.isValidTraceId=void 0;let i=n(476),g=n(403),o=/^([0-9a-f]{32})$/i,r=/^[0-9a-f]{16}$/i;function l(e){return o.test(e)&&e!==i.INVALID_TRACEID}function s(e){return r.test(e)&&e!==i.INVALID_SPANID}t.isValidTraceId=l,t.isValidSpanId=s,t.isSpanContextValid=function(e){return l(e.traceId)&&s(e.spanId)},t.wrapSpanContext=function(e){return new g.NonRecordingSpan(e)}},847:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.SpanStatusCode=void 0,function(e){e[e.UNSET=0]="UNSET",e[e.OK=1]="OK",e[e.ERROR=2]="ERROR"}(t.SpanStatusCode||(t.SpanStatusCode={}))},475:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.TraceFlags=void 0,function(e){e[e.NONE=0]="NONE",e[e.SAMPLED=1]="SAMPLED"}(t.TraceFlags||(t.TraceFlags={}))},521:(e,t)=>{Object.defineProperty(t,"__esModule",{value:!0}),t.VERSION=void 0,t.VERSION="1.6.0"}},n={};function i(e){var g=n[e];if(void 0!==g)return g.exports;var o=n[e]={exports:{}},r=!0;try{t[e].call(o.exports,o,o.exports,i),r=!1}finally{r&&delete n[e]}return o.exports}i.ab=__dirname+"/";var g={};(()=>{Object.defineProperty(g,"__esModule",{value:!0}),g.trace=g.propagation=g.metrics=g.diag=g.context=g.INVALID_SPAN_CONTEXT=g.INVALID_TRACEID=g.INVALID_SPANID=g.isValidSpanId=g.isValidTraceId=g.isSpanContextValid=g.createTraceState=g.TraceFlags=g.SpanStatusCode=g.SpanKind=g.SamplingDecision=g.ProxyTracerProvider=g.ProxyTracer=g.defaultTextMapSetter=g.defaultTextMapGetter=g.ValueType=g.createNoopMeter=g.DiagLogLevel=g.DiagConsoleLogger=g.ROOT_CONTEXT=g.createContextKey=g.baggageEntryMetadataFromString=void 0;var e=i(369);Object.defineProperty(g,"baggageEntryMetadataFromString",{enumerable:!0,get:function(){return e.baggageEntryMetadataFromString}});var t=i(780);Object.defineProperty(g,"createContextKey",{enumerable:!0,get:function(){return t.createContextKey}}),Object.defineProperty(g,"ROOT_CONTEXT",{enumerable:!0,get:function(){return t.ROOT_CONTEXT}});var n=i(972);Object.defineProperty(g,"DiagConsoleLogger",{enumerable:!0,get:function(){return n.DiagConsoleLogger}});var o=i(957);Object.defineProperty(g,"DiagLogLevel",{enumerable:!0,get:function(){return o.DiagLogLevel}});var r=i(102);Object.defineProperty(g,"createNoopMeter",{enumerable:!0,get:function(){return r.createNoopMeter}});var l=i(901);Object.defineProperty(g,"ValueType",{enumerable:!0,get:function(){return l.ValueType}});var s=i(194);Object.defineProperty(g,"defaultTextMapGetter",{enumerable:!0,get:function(){return s.defaultTextMapGetter}}),Object.defineProperty(g,"defaultTextMapSetter",{enumerable:!0,get:function(){return s.defaultTextMapSetter}});var a=i(125);Object.defineProperty(g,"ProxyTracer",{enumerable:!0,get:function(){return a.ProxyTracer}});var c=i(846);Object.defineProperty(g,"ProxyTracerProvider",{enumerable:!0,get:function(){return c.ProxyTracerProvider}});var I=i(996);Object.defineProperty(g,"SamplingDecision",{enumerable:!0,get:function(){return I.SamplingDecision}});var d=i(357);Object.defineProperty(g,"SpanKind",{enumerable:!0,get:function(){return d.SpanKind}});var u=i(847);Object.defineProperty(g,"SpanStatusCode",{enumerable:!0,get:function(){return u.SpanStatusCode}});var C=i(475);Object.defineProperty(g,"TraceFlags",{enumerable:!0,get:function(){return C.TraceFlags}});var b=i(98);Object.defineProperty(g,"createTraceState",{enumerable:!0,get:function(){return b.createTraceState}});var p=i(139);Object.defineProperty(g,"isSpanContextValid",{enumerable:!0,get:function(){return p.isSpanContextValid}}),Object.defineProperty(g,"isValidTraceId",{enumerable:!0,get:function(){return p.isValidTraceId}}),Object.defineProperty(g,"isValidSpanId",{enumerable:!0,get:function(){return p.isValidSpanId}});var m=i(476);Object.defineProperty(g,"INVALID_SPANID",{enumerable:!0,get:function(){return m.INVALID_SPANID}}),Object.defineProperty(g,"INVALID_TRACEID",{enumerable:!0,get:function(){return m.INVALID_TRACEID}}),Object.defineProperty(g,"INVALID_SPAN_CONTEXT",{enumerable:!0,get:function(){return m.INVALID_SPAN_CONTEXT}});let Z=i(67);Object.defineProperty(g,"context",{enumerable:!0,get:function(){return Z.context}});let h=i(506);Object.defineProperty(g,"diag",{enumerable:!0,get:function(){return h.diag}});let G=i(886);Object.defineProperty(g,"metrics",{enumerable:!0,get:function(){return G.metrics}});let B=i(939);Object.defineProperty(g,"propagation",{enumerable:!0,get:function(){return B.propagation}});let A=i(845);Object.defineProperty(g,"trace",{enumerable:!0,get:function(){return A.trace}}),g.default={context:Z.context,diag:h.diag,metrics:G.metrics,propagation:B.propagation,trace:A.trace}})(),e.exports=g})()},1809:(e,t)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var n in t)Object.defineProperty(e,n,{enumerable:!0,get:t[n]})}(t,{NEXT_QUERY_PARAM_PREFIX:function(){return n},PRERENDER_REVALIDATE_HEADER:function(){return i},PRERENDER_REVALIDATE_ONLY_GENERATED_HEADER:function(){return g},RSC_PREFETCH_SUFFIX:function(){return o},RSC_SUFFIX:function(){return r},NEXT_DATA_SUFFIX:function(){return l},NEXT_META_SUFFIX:function(){return s},NEXT_BODY_SUFFIX:function(){return a},NEXT_CACHE_TAGS_HEADER:function(){return c},NEXT_CACHE_SOFT_TAGS_HEADER:function(){return I},NEXT_CACHE_REVALIDATED_TAGS_HEADER:function(){return d},NEXT_CACHE_REVALIDATE_TAG_TOKEN_HEADER:function(){return u},NEXT_CACHE_TAG_MAX_LENGTH:function(){return C},NEXT_CACHE_SOFT_TAG_MAX_LENGTH:function(){return b},NEXT_CACHE_IMPLICIT_TAG_ID:function(){return p},CACHE_ONE_YEAR:function(){return m},MIDDLEWARE_FILENAME:function(){return Z},MIDDLEWARE_LOCATION_REGEXP:function(){return h},INSTRUMENTATION_HOOK_FILENAME:function(){return G},PAGES_DIR_ALIAS:function(){return B},DOT_NEXT_ALIAS:function(){return A},ROOT_DIR_ALIAS:function(){return y},APP_DIR_ALIAS:function(){return W},RSC_MOD_REF_PROXY_ALIAS:function(){return V},RSC_ACTION_VALIDATE_ALIAS:function(){return v},RSC_ACTION_PROXY_ALIAS:function(){return R},RSC_ACTION_ENCRYPTION_ALIAS:function(){return S},RSC_ACTION_CLIENT_WRAPPER_ALIAS:function(){return H},PUBLIC_DIR_MIDDLEWARE_CONFLICT:function(){return X},SSG_GET_INITIAL_PROPS_CONFLICT:function(){return Y},SERVER_PROPS_GET_INIT_PROPS_CONFLICT:function(){return f},SERVER_PROPS_SSG_CONFLICT:function(){return N},STATIC_STATUS_PAGE_GET_INITIAL_PROPS_ERROR:function(){return F},SERVER_PROPS_EXPORT_ERROR:function(){return K},GSP_NO_RETURNED_VALUE:function(){return _},GSSP_NO_RETURNED_VALUE:function(){return J},UNSTABLE_REVALIDATE_RENAME_ERROR:function(){return w},GSSP_COMPONENT_MEMBER_ERROR:function(){return x},NON_STANDARD_NODE_ENV:function(){return E},SSG_FALLBACK_EXPORT_ERROR:function(){return k},ESLINT_DEFAULT_DIRS:function(){return U},ESLINT_PROMPT_VALUES:function(){return T},SERVER_RUNTIME:function(){return z},WEBPACK_LAYERS:function(){return Q},WEBPACK_RESOURCE_QUERIES:function(){return O}});let n="nxtP",i="x-prerender-revalidate",g="x-prerender-revalidate-if-generated",o=".prefetch.rsc",r=".rsc",l=".json",s=".meta",a=".body",c="x-next-cache-tags",I="x-next-cache-soft-tags",d="x-next-revalidated-tags",u="x-next-revalidate-tag-token",C=256,b=1024,p="_N_T_",m=31536e3,Z="middleware",h=`(?:src/)?${Z}`,G="instrumentation",B="private-next-pages",A="private-dot-next",y="private-next-root-dir",W="private-next-app-dir",V="next/dist/build/webpack/loaders/next-flight-loader/module-proxy",v="private-next-rsc-action-validate",R="private-next-rsc-server-reference",S="private-next-rsc-action-encryption",H="private-next-rsc-action-client-wrapper",X="You can not have a '_next' folder inside of your public folder. This conflicts with the internal '/_next' route. https://nextjs.org/docs/messages/public-next-folder-conflict",Y="You can not use getInitialProps with getStaticProps. To use SSG, please remove your getInitialProps",f="You can not use getInitialProps with getServerSideProps. Please remove getInitialProps.",N="You can not use getStaticProps or getStaticPaths with getServerSideProps. To use SSG, please remove getServerSideProps",F="can not have getInitialProps/getServerSideProps, https://nextjs.org/docs/messages/404-get-initial-props",K="pages with `getServerSideProps` can not be exported. See more info here: https://nextjs.org/docs/messages/gssp-export",_="Your `getStaticProps` function did not return an object. Did you forget to add a `return`?",J="Your `getServerSideProps` function did not return an object. Did you forget to add a `return`?",w="The `unstable_revalidate` property is available for general use.\nPlease use `revalidate` instead.",x="can not be attached to a page's component and must be exported from the page. See more info here: https://nextjs.org/docs/messages/gssp-component-member",E='You are using a non-standard "NODE_ENV" value in your environment. This creates inconsistencies in the project and is strongly advised against. Read more: https://nextjs.org/docs/messages/non-standard-node-env',k="Pages with `fallback` enabled in `getStaticPaths` can not be exported. See more info here: https://nextjs.org/docs/messages/ssg-fallback-true-export",U=["app","pages","components","lib","src"],T=[{title:"Strict",recommended:!0,config:{extends:"next/core-web-vitals"}},{title:"Base",config:{extends:"next"}},{title:"Cancel",config:null}],z={edge:"edge",experimentalEdge:"experimental-edge",nodejs:"nodejs"},L={shared:"shared",reactServerComponents:"rsc",serverSideRendering:"ssr",actionBrowser:"action-browser",api:"api",middleware:"middleware",edgeAsset:"edge-asset",appPagesBrowser:"app-pages-browser",appMetadataRoute:"app-metadata-route",appRouteHandler:"app-route-handler"},Q={...L,GROUP:{server:[L.reactServerComponents,L.actionBrowser,L.appMetadataRoute,L.appRouteHandler],nonClientServerTarget:[L.middleware,L.api],app:[L.reactServerComponents,L.actionBrowser,L.appMetadataRoute,L.appRouteHandler,L.serverSideRendering,L.appPagesBrowser,L.shared]}},O={edgeSSREntry:"__next_edge_ssr_entry__",metadata:"__next_metadata__",metadataRoute:"__next_metadata_route__",metadataImageMeta:"__next_metadata_image_meta__"}},3392:(e,t)=>{"use strict";var n;Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var n in t)Object.defineProperty(e,n,{enumerable:!0,get:t[n]})}(t,{reset:function(){return s},bold:function(){return a},dim:function(){return c},italic:function(){return I},underline:function(){return d},inverse:function(){return u},hidden:function(){return C},strikethrough:function(){return b},black:function(){return p},red:function(){return m},green:function(){return Z},yellow:function(){return h},blue:function(){return G},magenta:function(){return B},purple:function(){return A},cyan:function(){return y},white:function(){return W},gray:function(){return V},bgBlack:function(){return v},bgRed:function(){return R},bgGreen:function(){return S},bgYellow:function(){return H},bgBlue:function(){return X},bgMagenta:function(){return Y},bgCyan:function(){return f},bgWhite:function(){return N}});let{env:i,stdout:g}=(null==(n=globalThis)?void 0:n.process)??{},o=i&&!i.NO_COLOR&&(i.FORCE_COLOR||(null==g?void 0:g.isTTY)&&!i.CI&&"dumb"!==i.TERM),r=(e,t,n,i)=>{let g=e.substring(0,i)+n,o=e.substring(i+t.length),l=o.indexOf(t);return~l?g+r(o,t,n,l):g+o},l=(e,t,n=e)=>o?i=>{let g=""+i,o=g.indexOf(t,e.length);return~o?e+r(g,t,n,o)+t:e+g+t}:String,s=o?e=>`\x1b[0m${e}\x1b[0m`:String,a=l("\x1b[1m","\x1b[22m","\x1b[22m\x1b[1m"),c=l("\x1b[2m","\x1b[22m","\x1b[22m\x1b[2m"),I=l("\x1b[3m","\x1b[23m"),d=l("\x1b[4m","\x1b[24m"),u=l("\x1b[7m","\x1b[27m"),C=l("\x1b[8m","\x1b[28m"),b=l("\x1b[9m","\x1b[29m"),p=l("\x1b[30m","\x1b[39m"),m=l("\x1b[31m","\x1b[39m"),Z=l("\x1b[32m","\x1b[39m"),h=l("\x1b[33m","\x1b[39m"),G=l("\x1b[34m","\x1b[39m"),B=l("\x1b[35m","\x1b[39m"),A=l("\x1b[38;2;173;127;168m","\x1b[39m"),y=l("\x1b[36m","\x1b[39m"),W=l("\x1b[37m","\x1b[39m"),V=l("\x1b[90m","\x1b[39m"),v=l("\x1b[40m","\x1b[49m"),R=l("\x1b[41m","\x1b[49m"),S=l("\x1b[42m","\x1b[49m"),H=l("\x1b[43m","\x1b[49m"),X=l("\x1b[44m","\x1b[49m"),Y=l("\x1b[45m","\x1b[49m"),f=l("\x1b[46m","\x1b[49m"),N=l("\x1b[47m","\x1b[49m")},6566:(e,t)=>{"use strict";var n;Object.defineProperty(t,"x",{enumerable:!0,get:function(){return n}}),function(e){e.PAGES="PAGES",e.PAGES_API="PAGES_API",e.APP_PAGE="APP_PAGE",e.APP_ROUTE="APP_ROUTE"}(n||(n={}))},7419:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var n in t)Object.defineProperty(e,n,{enumerable:!0,get:t[n]})}(t,{validateRevalidate:function(){return s},validateTags:function(){return a},addImplicitTags:function(){return I},patchFetch:function(){return u}});let i=n(5240),g=n(3372),o=n(1809),r=function(e,t){if(!t&&e&&e.__esModule)return e;if(null===e||"object"!=typeof e&&"function"!=typeof e)return{default:e};var n=l(t);if(n&&n.has(e))return n.get(e);var i={},g=Object.defineProperty&&Object.getOwnPropertyDescriptor;for(var o in e)if("default"!==o&&Object.prototype.hasOwnProperty.call(e,o)){var r=g?Object.getOwnPropertyDescriptor(e,o):null;r&&(r.get||r.set)?Object.defineProperty(i,o,r):i[o]=e[o]}return i.default=e,n&&n.set(e,i),i}(n(9380));function l(e){if("function"!=typeof WeakMap)return null;var t=new WeakMap,n=new WeakMap;return(l=function(e){return e?n:t})(e)}function s(e,t){try{let n;if(!1===e)n=e;else if("number"==typeof e&&!isNaN(e)&&e>-1)n=e;else if(void 0!==e)throw Error(`Invalid revalidate value "${e}" on "${t}", must be a non-negative number or "false"`);return n}catch(e){if(e instanceof Error&&e.message.includes("Invalid revalidate"))throw e;return}}function a(e,t){let n=[],i=[];for(let t of e)"string"!=typeof t?i.push({tag:t,reason:"invalid type, must be a string"}):t.length>o.NEXT_CACHE_TAG_MAX_LENGTH?i.push({tag:t,reason:`exceeded max length of ${o.NEXT_CACHE_TAG_MAX_LENGTH}`}):n.push(t);if(i.length>0)for(let{tag:e,reason:n}of(console.warn(`Warning: invalid tags passed to ${t}: `),i))console.log(`tag: "${e}" ${n}`);return n}let c=e=>{let t=["/layout"];if(e.startsWith("/")){let n=e.split("/");for(let e=1;e<n.length+1;e++){let i=n.slice(0,e).join("/");i&&(i.endsWith("/page")||i.endsWith("/route")||(i=`${i}${i.endsWith("/")?"":"/"}layout`),t.push(i))}}return t};function I(e){var t,n;let i=[],{pagePath:g,urlPathname:r}=e;if(Array.isArray(e.tags)||(e.tags=[]),g)for(let n of c(g))n=`${o.NEXT_CACHE_IMPLICIT_TAG_ID}${n}`,(null==(t=e.tags)?void 0:t.includes(n))||e.tags.push(n),i.push(n);if(r){let t=new URL(r,"http://n").pathname,g=`${o.NEXT_CACHE_IMPLICIT_TAG_ID}${t}`;(null==(n=e.tags)?void 0:n.includes(g))||e.tags.push(g),i.push(g)}return i}function d(e,t){if(!e)return;e.fetchMetrics||(e.fetchMetrics=[]);let n=["url","status","method"];e.fetchMetrics.some(e=>n.every(n=>e[n]===t[n]))||e.fetchMetrics.push({url:t.url,cacheStatus:t.cacheStatus,cacheReason:t.cacheReason,status:t.status,method:t.method,start:t.start,end:Date.now(),idx:e.nextFetchId||0})}function u({serverHooks:e,staticGenerationAsyncStorage:t}){if(globalThis._nextOriginalFetch||(globalThis._nextOriginalFetch=globalThis.fetch),globalThis.fetch.__nextPatched)return;let{DynamicServerError:n}=e,l=globalThis._nextOriginalFetch;globalThis.fetch=async(e,c)=>{var u,C;let b;try{(b=new URL(e instanceof Request?e.url:e)).username="",b.password=""}catch{b=void 0}let p=(null==b?void 0:b.href)??"",m=Date.now(),Z=(null==c?void 0:null==(u=c.method)?void 0:u.toUpperCase())||"GET",h=(null==(C=null==c?void 0:c.next)?void 0:C.internal)===!0,G="1"===process.env.NEXT_OTEL_FETCH_DISABLED;return await (0,g.getTracer)().trace(h?i.NextNodeServerSpan.internalFetch:i.AppRenderSpan.fetch,{hideSpan:G,kind:g.SpanKind.CLIENT,spanName:["fetch",Z,p].filter(Boolean).join(" "),attributes:{"http.url":p,"http.method":Z,"net.peer.name":null==b?void 0:b.hostname,"net.peer.port":(null==b?void 0:b.port)||void 0}},async()=>{var i;let g,u,C;let b=t.getStore()||(null==fetch.__nextGetStaticStore?void 0:fetch.__nextGetStaticStore.call(fetch)),Z=e&&"object"==typeof e&&"string"==typeof e.method,G=t=>(null==c?void 0:c[t])||(Z?e[t]:null);if(!b||h||b.isDraftMode)return l(e,c);let B=t=>{var n,i,g;return void 0!==(null==c?void 0:null==(n=c.next)?void 0:n[t])?null==c?void 0:null==(i=c.next)?void 0:i[t]:Z?null==(g=e.next)?void 0:g[t]:void 0},A=B("revalidate"),y=a(B("tags")||[],`fetch ${e.toString()}`);if(Array.isArray(y))for(let e of(b.tags||(b.tags=[]),y))b.tags.includes(e)||b.tags.push(e);let W=I(b),V="only-cache"===b.fetchCache,v="force-cache"===b.fetchCache,R="default-cache"===b.fetchCache,S="default-no-store"===b.fetchCache,H="only-no-store"===b.fetchCache,X="force-no-store"===b.fetchCache,Y=!!b.isUnstableNoStore,f=G("cache"),N="";"string"==typeof f&&void 0!==A&&(Z&&"default"===f||r.warn(`fetch for ${p} on ${b.urlPathname} specified "cache: ${f}" and "revalidate: ${A}", only one should be specified.`),f=void 0),"force-cache"===f?A=!1:("no-cache"===f||"no-store"===f||X||H)&&(A=0),("no-cache"===f||"no-store"===f)&&(N=`cache: ${f}`),C=s(A,b.urlPathname);let F=G("headers"),K="function"==typeof(null==F?void 0:F.get)?F:new Headers(F||{}),_=K.get("authorization")||K.get("cookie"),J=!["get","head"].includes((null==(i=G("method"))?void 0:i.toLowerCase())||"get"),w=(_||J)&&0===b.revalidate;if(X&&(N="fetchCache = force-no-store"),H){if("force-cache"===f||void 0!==C&&(!1===C||C>0))throw Error(`cache: 'force-cache' used on fetch for ${p} with 'export const fetchCache = 'only-no-store'`);N="fetchCache = only-no-store"}if(V&&"no-store"===f)throw Error(`cache: 'no-store' used on fetch for ${p} with 'export const fetchCache = 'only-cache'`);v&&(void 0===A||0===A)&&(N="fetchCache = force-cache",C=!1),void 0===C?R?(C=!1,N="fetchCache = default-cache"):w?(C=0,N="auto no cache"):S?(C=0,N="fetchCache = default-no-store"):Y?(C=0,N="noStore call"):(N="auto cache",C="boolean"!=typeof b.revalidate&&void 0!==b.revalidate&&b.revalidate):N||(N=`revalidate: ${C}`),b.forceStatic&&0===C||w||void 0!==b.revalidate&&("number"!=typeof C||!1!==b.revalidate&&("number"!=typeof b.revalidate||!(C<b.revalidate)))||(0===C&&(null==b.postpone||b.postpone.call(b,"revalidate: 0")),b.revalidate=C);let x="number"==typeof C&&C>0||!1===C;if(b.incrementalCache&&x)try{g=await b.incrementalCache.fetchCacheKey(p,Z?e:c)}catch(t){console.error("Failed to generate cache key for",e)}let E=b.nextFetchId??1;b.nextFetchId=E+1;let k="number"!=typeof C?o.CACHE_ONE_YEAR:C,U=async(t,n)=>{let i=["cache","credentials","headers","integrity","keepalive","method","mode","redirect","referrer","referrerPolicy","window","duplex",...t?[]:["signal"]];if(Z){let t=e,n={body:t._ogBody||t.body};for(let e of i)n[e]=t[e];e=new Request(t.url,n)}else if(c){let e=c;for(let t of(c={body:c._ogBody||c.body},i))c[t]=e[t]}let o={...c,next:{...null==c?void 0:c.next,fetchType:"origin",fetchIdx:E}};return l(e,o).then(async i=>{if(t||d(b,{start:m,url:p,cacheReason:n||N,cacheStatus:0===C||n?"skip":"miss",status:i.status,method:o.method||"GET"}),200===i.status&&b.incrementalCache&&g&&x){let t=Buffer.from(await i.arrayBuffer());try{await b.incrementalCache.set(g,{kind:"FETCH",data:{headers:Object.fromEntries(i.headers.entries()),body:t.toString("base64"),status:i.status,url:i.url},revalidate:k},{fetchCache:!0,revalidate:C,fetchUrl:p,fetchIdx:E,tags:y})}catch(t){console.warn("Failed to set fetch cache",e,t)}let n=new Response(t,{headers:new Headers(i.headers),status:i.status});return Object.defineProperty(n,"url",{value:i.url}),n}return i})},T=()=>Promise.resolve();if(g&&b.incrementalCache){T=await b.incrementalCache.lock(g);let e=b.isOnDemandRevalidate?null:await b.incrementalCache.get(g,{kindHint:"fetch",revalidate:C,fetchUrl:p,fetchIdx:E,tags:y,softTags:W});if(e?await T():u="cache-control: no-cache (hard refresh)",(null==e?void 0:e.value)&&"FETCH"===e.value.kind&&!(b.isRevalidate&&e.isStale)){e.isStale&&(b.pendingRevalidates??={},b.pendingRevalidates[g]||(b.pendingRevalidates[g]=U(!0).catch(console.error)));let t=e.value.data;d(b,{start:m,url:p,cacheReason:N,cacheStatus:"hit",status:t.status||200,method:(null==c?void 0:c.method)||"GET"});let n=new Response(Buffer.from(t.body,"base64"),{headers:t.headers,status:t.status});return Object.defineProperty(n,"url",{value:e.value.data.url}),n}}if(b.isStaticGeneration&&c&&"object"==typeof c){let{cache:t}=c;if(!b.forceStatic&&"no-store"===t){let t=`no-store fetch ${e}${b.urlPathname?` ${b.urlPathname}`:""}`;null==b.postpone||b.postpone.call(b,t),b.revalidate=0;let i=new n(t);b.dynamicUsageErr=i,b.dynamicUsageDescription=t}let i="next"in c,{next:g={}}=c;if("number"==typeof g.revalidate&&(void 0===b.revalidate||"number"==typeof b.revalidate&&g.revalidate<b.revalidate)){if(!b.forceDynamic&&!b.forceStatic&&0===g.revalidate){let t=`revalidate: 0 fetch ${e}${b.urlPathname?` ${b.urlPathname}`:""}`;null==b.postpone||b.postpone.call(b,t);let i=new n(t);b.dynamicUsageErr=i,b.dynamicUsageDescription=t}b.forceStatic&&0===g.revalidate||(b.revalidate=g.revalidate)}i&&delete c.next}return U(!1,u).finally(T)})},globalThis.fetch.__nextGetStaticStore=()=>t,globalThis.fetch.__nextPatched=!0}},5240:(e,t)=>{"use strict";var n,i,g,o,r,l,s,a,c,I,d;Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var n in t)Object.defineProperty(e,n,{enumerable:!0,get:t[n]})}(t,{NextVanillaSpanAllowlist:function(){return u},BaseServerSpan:function(){return n},LoadComponentsSpan:function(){return i},NextServerSpan:function(){return g},NextNodeServerSpan:function(){return o},StartServerSpan:function(){return r},RenderSpan:function(){return l},RouterSpan:function(){return a},AppRenderSpan:function(){return s},NodeSpan:function(){return c},AppRouteRouteHandlersSpan:function(){return I},ResolveMetadataSpan:function(){return d}}),function(e){e.handleRequest="BaseServer.handleRequest",e.run="BaseServer.run",e.pipe="BaseServer.pipe",e.getStaticHTML="BaseServer.getStaticHTML",e.render="BaseServer.render",e.renderToResponseWithComponents="BaseServer.renderToResponseWithComponents",e.renderToResponse="BaseServer.renderToResponse",e.renderToHTML="BaseServer.renderToHTML",e.renderError="BaseServer.renderError",e.renderErrorToResponse="BaseServer.renderErrorToResponse",e.renderErrorToHTML="BaseServer.renderErrorToHTML",e.render404="BaseServer.render404"}(n||(n={})),function(e){e.loadDefaultErrorComponents="LoadComponents.loadDefaultErrorComponents",e.loadComponents="LoadComponents.loadComponents"}(i||(i={})),function(e){e.getRequestHandler="NextServer.getRequestHandler",e.getServer="NextServer.getServer",e.getServerRequestHandler="NextServer.getServerRequestHandler",e.createServer="createServer.createServer"}(g||(g={})),function(e){e.compression="NextNodeServer.compression",e.getBuildId="NextNodeServer.getBuildId",e.getLayoutOrPageModule="NextNodeServer.getLayoutOrPageModule",e.generateStaticRoutes="NextNodeServer.generateStaticRoutes",e.generateFsStaticRoutes="NextNodeServer.generateFsStaticRoutes",e.generatePublicRoutes="NextNodeServer.generatePublicRoutes",e.generateImageRoutes="NextNodeServer.generateImageRoutes.route",e.sendRenderResult="NextNodeServer.sendRenderResult",e.proxyRequest="NextNodeServer.proxyRequest",e.runApi="NextNodeServer.runApi",e.render="NextNodeServer.render",e.renderHTML="NextNodeServer.renderHTML",e.imageOptimizer="NextNodeServer.imageOptimizer",e.getPagePath="NextNodeServer.getPagePath",e.getRoutesManifest="NextNodeServer.getRoutesManifest",e.findPageComponents="NextNodeServer.findPageComponents",e.getFontManifest="NextNodeServer.getFontManifest",e.getServerComponentManifest="NextNodeServer.getServerComponentManifest",e.getRequestHandler="NextNodeServer.getRequestHandler",e.renderToHTML="NextNodeServer.renderToHTML",e.renderError="NextNodeServer.renderError",e.renderErrorToHTML="NextNodeServer.renderErrorToHTML",e.render404="NextNodeServer.render404",e.route="route",e.onProxyReq="onProxyReq",e.apiResolver="apiResolver",e.internalFetch="internalFetch"}(o||(o={})),(r||(r={})).startServer="startServer.startServer",function(e){e.getServerSideProps="Render.getServerSideProps",e.getStaticProps="Render.getStaticProps",e.renderToString="Render.renderToString",e.renderDocument="Render.renderDocument",e.createBodyResult="Render.createBodyResult"}(l||(l={})),function(e){e.renderToString="AppRender.renderToString",e.renderToReadableStream="AppRender.renderToReadableStream",e.getBodyResult="AppRender.getBodyResult",e.fetch="AppRender.fetch"}(s||(s={})),(a||(a={})).executeRoute="Router.executeRoute",(c||(c={})).runHandler="Node.runHandler",(I||(I={})).runHandler="AppRouteRouteHandlers.runHandler",function(e){e.generateMetadata="ResolveMetadata.generateMetadata",e.generateViewport="ResolveMetadata.generateViewport"}(d||(d={}));let u=["BaseServer.handleRequest","Render.getServerSideProps","Render.getStaticProps","AppRender.fetch","AppRender.getBodyResult","Render.renderDocument","Node.runHandler","AppRouteRouteHandlers.runHandler","ResolveMetadata.generateMetadata","ResolveMetadata.generateViewport","NextNodeServer.findPageComponents","NextNodeServer.getLayoutOrPageModule"]},3372:(e,t,n)=>{"use strict";let i;Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var n in t)Object.defineProperty(e,n,{enumerable:!0,get:t[n]})}(t,{getTracer:function(){return Z},SpanStatusCode:function(){return s},SpanKind:function(){return a}});let g=n(5240);try{i=n(6581)}catch(e){i=n(6581)}let{context:o,propagation:r,trace:l,SpanStatusCode:s,SpanKind:a,ROOT_CONTEXT:c}=i,I=e=>null!==e&&"object"==typeof e&&"function"==typeof e.then,d=(e,t)=>{(null==t?void 0:t.bubble)===!0?e.setAttribute("next.bubble",!0):(t&&e.recordException(t),e.setStatus({code:s.ERROR,message:null==t?void 0:t.message})),e.end()},u=new Map,C=i.createContextKey("next.rootSpanId"),b=0,p=()=>b++;class m{getTracerInstance(){return l.getTracer("next.js","0.0.1")}getContext(){return o}getActiveScopeSpan(){return l.getSpan(null==o?void 0:o.active())}withPropagatedContext(e,t,n){let i=o.active();if(l.getSpanContext(i))return t();let g=r.extract(i,e,n);return o.with(g,t)}trace(...e){var t;let[n,i,r]=e,{fn:s,options:a}="function"==typeof i?{fn:i,options:{}}:{fn:r,options:{...i}};if(!g.NextVanillaSpanAllowlist.includes(n)&&"1"!==process.env.NEXT_OTEL_VERBOSE||a.hideSpan)return s();let b=a.spanName??n,m=this.getSpanContext((null==a?void 0:a.parentSpan)??this.getActiveScopeSpan()),Z=!1;m?(null==(t=l.getSpanContext(m))?void 0:t.isRemote)&&(Z=!0):(m=c,Z=!0);let h=p();return a.attributes={"next.span_name":b,"next.span_type":n,...a.attributes},o.with(m.setValue(C,h),()=>this.getTracerInstance().startActiveSpan(b,a,e=>{let t=()=>{u.delete(h)};Z&&u.set(h,new Map(Object.entries(a.attributes??{})));try{if(s.length>1)return s(e,t=>d(e,t));let n=s(e);if(I(n))return n.then(t=>(e.end(),t)).catch(t=>{throw d(e,t),t}).finally(t);return e.end(),t(),n}catch(n){throw d(e,n),t(),n}}))}wrap(...e){let t=this,[n,i,r]=3===e.length?e:[e[0],{},e[1]];return g.NextVanillaSpanAllowlist.includes(n)||"1"===process.env.NEXT_OTEL_VERBOSE?function(){let e=i;"function"==typeof e&&"function"==typeof r&&(e=e.apply(this,arguments));let g=arguments.length-1,l=arguments[g];if("function"!=typeof l)return t.trace(n,e,()=>r.apply(this,arguments));{let i=t.getContext().bind(o.active(),l);return t.trace(n,e,(e,t)=>(arguments[g]=function(e){return null==t||t(e),i.apply(this,arguments)},r.apply(this,arguments)))}}:r}startSpan(...e){let[t,n]=e,i=this.getSpanContext((null==n?void 0:n.parentSpan)??this.getActiveScopeSpan());return this.getTracerInstance().startSpan(t,n,i)}getSpanContext(e){return e?l.setSpan(o.active(),e):void 0}getRootSpanAttributes(){let e=o.active().getValue(C);return u.get(e)}}let Z=(()=>{let e=new m;return()=>e})()},7593:(e,t,n)=>{"use strict";Object.defineProperty(t,"__esModule",{value:!0}),function(e,t){for(var n in t)Object.defineProperty(e,n,{enumerable:!0,get:t[n]})}(t,{MODERN_BROWSERSLIST_TARGET:function(){return i.default},COMPILER_NAMES:function(){return g},INTERNAL_HEADERS:function(){return o},COMPILER_INDEXES:function(){return r},PHASE_EXPORT:function(){return l},PHASE_PRODUCTION_BUILD:function(){return s},PHASE_PRODUCTION_SERVER:function(){return a},PHASE_DEVELOPMENT_SERVER:function(){return c},PHASE_TEST:function(){return I},PHASE_INFO:function(){return d},PAGES_MANIFEST:function(){return u},APP_PATHS_MANIFEST:function(){return C},APP_PATH_ROUTES_MANIFEST:function(){return b},BUILD_MANIFEST:function(){return p},APP_BUILD_MANIFEST:function(){return m},FUNCTIONS_CONFIG_MANIFEST:function(){return Z},SUBRESOURCE_INTEGRITY_MANIFEST:function(){return h},NEXT_FONT_MANIFEST:function(){return G},EXPORT_MARKER:function(){return B},EXPORT_DETAIL:function(){return A},PRERENDER_MANIFEST:function(){return y},ROUTES_MANIFEST:function(){return W},IMAGES_MANIFEST:function(){return V},SERVER_FILES_MANIFEST:function(){return v},DEV_CLIENT_PAGES_MANIFEST:function(){return R},MIDDLEWARE_MANIFEST:function(){return S},DEV_MIDDLEWARE_MANIFEST:function(){return H},REACT_LOADABLE_MANIFEST:function(){return X},FONT_MANIFEST:function(){return Y},SERVER_DIRECTORY:function(){return f},CONFIG_FILES:function(){return N},BUILD_ID_FILE:function(){return F},BLOCKED_PAGES:function(){return K},CLIENT_PUBLIC_FILES_PATH:function(){return _},CLIENT_STATIC_FILES_PATH:function(){return J},STRING_LITERAL_DROP_BUNDLE:function(){return w},NEXT_BUILTIN_DOCUMENT:function(){return x},BARREL_OPTIMIZATION_PREFIX:function(){return E},CLIENT_REFERENCE_MANIFEST:function(){return k},SERVER_REFERENCE_MANIFEST:function(){return U},MIDDLEWARE_BUILD_MANIFEST:function(){return T},MIDDLEWARE_REACT_LOADABLE_MANIFEST:function(){return z},CLIENT_STATIC_FILES_RUNTIME_MAIN:function(){return L},CLIENT_STATIC_FILES_RUNTIME_MAIN_APP:function(){return Q},APP_CLIENT_INTERNALS:function(){return O},CLIENT_STATIC_FILES_RUNTIME_REACT_REFRESH:function(){return M},CLIENT_STATIC_FILES_RUNTIME_AMP:function(){return j},CLIENT_STATIC_FILES_RUNTIME_WEBPACK:function(){return P},CLIENT_STATIC_FILES_RUNTIME_POLYFILLS:function(){return D},CLIENT_STATIC_FILES_RUNTIME_POLYFILLS_SYMBOL:function(){return q},EDGE_RUNTIME_WEBPACK:function(){return $},STATIC_PROPS_ID:function(){return ee},SERVER_PROPS_ID:function(){return et},GOOGLE_FONT_PROVIDER:function(){return en},OPTIMIZED_FONT_PROVIDERS:function(){return ei},DEFAULT_SERIF_FONT:function(){return eg},DEFAULT_SANS_SERIF_FONT:function(){return eo},STATIC_STATUS_PAGES:function(){return er},TRACE_OUTPUT_VERSION:function(){return el},TURBO_TRACE_DEFAULT_MEMORY_LIMIT:function(){return es},RSC_MODULE_TYPES:function(){return ea},EDGE_UNSUPPORTED_NODE_APIS:function(){return ec},SYSTEM_ENTRYPOINTS:function(){return eI}});let i=n(8763)._(n(4900)),g={client:"client",server:"server",edgeServer:"edge-server"},o=["x-invoke-error","x-invoke-output","x-invoke-path","x-invoke-query","x-invoke-status","x-middleware-invoke"],r={[g.client]:0,[g.server]:1,[g.edgeServer]:2},l="phase-export",s="phase-production-build",a="phase-production-server",c="phase-development-server",I="phase-test",d="phase-info",u="pages-manifest.json",C="app-paths-manifest.json",b="app-path-routes-manifest.json",p="build-manifest.json",m="app-build-manifest.json",Z="functions-config-manifest.json",h="subresource-integrity-manifest",G="next-font-manifest",B="export-marker.json",A="export-detail.json",y="prerender-manifest.json",W="routes-manifest.json",V="images-manifest.json",v="required-server-files.json",R="_devPagesManifest.json",S="middleware-manifest.json",H="_devMiddlewareManifest.json",X="react-loadable-manifest.json",Y="font-manifest.json",f="server",N=["next.config.js","next.config.mjs"],F="BUILD_ID",K=["/_document","/_app","/_error"],_="public",J="static",w="__NEXT_DROP_CLIENT_FILE__",x="__NEXT_BUILTIN_DOCUMENT__",E="__barrel_optimize__",k="client-reference-manifest",U="server-reference-manifest",T="middleware-build-manifest",z="middleware-react-loadable-manifest",L="main",Q=""+L+"-app",O="app-pages-internals",M="react-refresh",j="amp",P="webpack",D="polyfills",q=Symbol(D),$="edge-runtime-webpack",ee="__N_SSG",et="__N_SSP",en="https://fonts.googleapis.com/",ei=[{url:en,preconnect:"https://fonts.gstatic.com"},{url:"https://use.typekit.net",preconnect:"https://use.typekit.net"}],eg={name:"Times New Roman",xAvgCharWidth:821,azAvgWidth:854.3953488372093,unitsPerEm:2048},eo={name:"Arial",xAvgCharWidth:904,azAvgWidth:934.5116279069767,unitsPerEm:2048},er=["/500"],el=1,es=6e3,ea={client:"client",server:"server"},ec=["clearImmediate","setImmediate","BroadcastChannel","ByteLengthQueuingStrategy","CompressionStream","CountQueuingStrategy","DecompressionStream","DomException","MessageChannel","MessageEvent","MessagePort","ReadableByteStreamController","ReadableStreamBYOBRequest","ReadableStreamDefaultController","TransformStreamDefaultController","WritableStreamDefaultController"],eI=new Set([L,M,j,Q]);("function"==typeof t.default||"object"==typeof t.default&&null!==t.default)&&void 0===t.default.__esModule&&(Object.defineProperty(t.default,"__esModule",{value:!0}),Object.assign(t.default,t),e.exports=t.default)},4900:e=>{"use strict";e.exports=["chrome 64","edge 79","firefox 67","opera 51","safari 12"]},8763:(e,t,n)=>{"use strict";function i(e){return e&&e.__esModule?e:{default:e}}n.r(t),n.d(t,{_:()=>i,_interop_require_default:()=>i})}};
//# sourceMappingURL=673.js.map